<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TUCU-MAN - Superh√©roe Argentino</title>
    <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Nunito:wght@700;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body {
            overflow: hidden;
            position: fixed;
            width: 100%;
            height: 100%;
            touch-action: manipulation;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            font-family: 'Nunito', sans-serif;
        }
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        #gameContainer {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #gameCanvas {
            border: 6px solid #FFD700;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
            touch-action: none;
        }
        .overlay {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,0.9);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            z-index: 100;
        }
        .overlay h1 {
            font-family: 'Bangers', cursive;
            color: #FFD700;
            font-size: 1.8rem;
            text-shadow: 3px 3px 0 #e94560;
            margin-bottom: 8px;
        }
        .overlay h2 {
            font-family: 'Bangers', cursive;
            color: #75AADB;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        .overlay p {
            color: #fff;
            font-size: 0.85rem;
            margin-bottom: 5px;
        }
        .btn {
            padding: 12px 40px;
            font-family: 'Bangers', cursive;
            font-size: 1.3rem;
            background: linear-gradient(180deg, #4CAF50, #2E7D32);
            color: white;
            border: 4px solid #1B5E20;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 12px;
        }
        .btn:active { transform: translateY(3px); }
        #hud {
            position: absolute;
            top: 0; left: 0; right: 0;
            padding: 6px 10px;
            display: flex;
            justify-content: space-between;
            pointer-events: none;
            z-index: 50;
        }
        .hud-left, .hud-right {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        .hud-item {
            font-family: 'Bangers', cursive;
            font-size: 1rem;
            text-shadow: 2px 2px 0 #000;
        }
        #score { color: #FFD700; }
        #ammo { color: #FFA500; }
        #wave { color: #fff; font-size: 0.85rem; }
        #level { color: #75AADB; }
        #allies { color: #00FF00; font-size: 0.8rem; }
        #defenseHP { color: #FF69B4; }
        .level-indicator { display: flex; gap: 8px; margin: 10px 0; }
        .level-dot {
            width: 16px; height: 16px;
            border-radius: 50%;
            background: #333;
            border: 2px solid #666;
        }
        .level-dot.completed { background: #4CAF50; border-color: #2E7D32; }
        .level-dot.current { background: #FFD700; border-color: #FFA500; }
        #finalScore, #victoryScore {
            font-family: 'Bangers', cursive;
            color: #FFD700;
            font-size: 2rem;
        }
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        
        <!-- PANEL DEBUG - escribir "tucuman" para activar -->
        <div id="debugPanel" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.95); padding: 20px; border-radius: 15px; z-index: 9999; border: 3px solid #FFD700; max-height: 80vh; overflow-y: auto;">
            <h2 style="color: #FFD700; text-align: center; margin-bottom: 15px;">üéÆ SELECTOR DE NIVELES</h2>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                <button onclick="startAtLevel(0)" style="padding: 12px; background: linear-gradient(180deg, #4CAF50, #2E7D32); border: none; border-radius: 8px; color: #fff; cursor: pointer; font-size: 0.9rem;">1Ô∏è‚É£ Obelisco</button>
                <button onclick="startAtLevel(1)" style="padding: 12px; background: linear-gradient(180deg, #FF69B4, #C71585); border: none; border-radius: 8px; color: #fff; cursor: pointer; font-size: 0.9rem;">2Ô∏è‚É£ Casa Rosada</button>
                <button onclick="startAtLevel(2)" style="padding: 12px; background: linear-gradient(180deg, #9C27B0, #6A1B9A); border: none; border-radius: 8px; color: #fff; cursor: pointer; font-size: 0.9rem;">3Ô∏è‚É£ Congreso</button>
                <button onclick="startAtLevel(3)" style="padding: 12px; background: linear-gradient(180deg, #2196F3, #1565C0); border: none; border-radius: 8px; color: #fff; cursor: pointer; font-size: 0.9rem;">4Ô∏è‚É£ Plaza Mayo</button>
                <button onclick="startAtLevel(4)" style="padding: 12px; background: linear-gradient(180deg, #FFC107, #F57F17); border: none; border-radius: 8px; color: #000; cursor: pointer; font-size: 0.9rem;">5Ô∏è‚É£ Bombonera</button>
                <button onclick="startAtLevel(5)" style="padding: 12px; background: linear-gradient(180deg, #009688, #00695C); border: none; border-radius: 8px; color: #fff; cursor: pointer; font-size: 0.9rem;">6Ô∏è‚É£ Puente Brasil</button>
                <button onclick="startAtLevel(6)" style="padding: 12px; background: linear-gradient(180deg, #8BC34A, #558B2F); border: none; border-radius: 8px; color: #fff; cursor: pointer; font-size: 0.9rem;">7Ô∏è‚É£ Cancha D10S</button>
                <button onclick="startAtLevel(7)" style="padding: 12px; background: linear-gradient(180deg, #E0E0E0, #9E9E9E); border: none; border-radius: 8px; color: #000; cursor: pointer; font-size: 0.9rem;">8Ô∏è‚É£ Vaticano</button>
                <button onclick="startAtLevel(8)" style="padding: 12px; background: linear-gradient(180deg, #FF5722, #D84315); border: none; border-radius: 8px; color: #fff; cursor: pointer; font-size: 0.9rem;">9Ô∏è‚É£ CGT</button>
                <button onclick="startAtLevel(9)" style="padding: 12px; background: linear-gradient(180deg, #673AB7, #4527A0); border: none; border-radius: 8px; color: #fff; cursor: pointer; font-size: 0.9rem;">üîü ¬°FINAL!</button>
            </div>
            <p style="color: #aaa; text-align: center; margin-top: 15px; font-size: 0.8rem;">Escrib√≠ "tucuman" para cerrar</p>
        </div>
        
        <!-- INTRO CINEM√ÅTICA - DESACTIVADA -->
        <div id="introScreen" class="overlay hidden" style="background: #000; display: none;">
            <canvas id="introCanvas" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 12px;"></canvas>
            <button id="skipBtn" onclick="skipIntro()" style="position: absolute; bottom: 20px; right: 20px; padding: 8px 15px; background: rgba(255,255,255,0.2); border: 1px solid #fff; border-radius: 5px; color: #fff; font-size: 0.8rem; cursor: pointer; z-index: 200;">SALTAR ‚ñ∂</button>
        </div>
        
        <div id="hud" class="hidden">
            <div class="hud-left">
                <div id="score" class="hud-item">üèÜ 0</div>
                <div id="libertariosAbatidos" class="hud-item" style="color: #FF4444;">ü•ü Libervirgos empanadados: 0</div>
                <div id="ammo" class="hud-item">ü•ü 20/20</div>
                <div id="wave" class="hud-item">Oleada 1/5</div>
            </div>
            <div class="hud-right">
                <div id="vidas" class="hud-item" style="color: #FF4444;">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
                <div id="level" class="hud-item">NIVEL 1</div>
                <div id="defenseHP" class="hud-item"></div>
                <button id="soundBtn" onclick="toggleSound();" style="padding: 8px 15px; font-size: 1rem; background: rgba(255,255,255,0.9); border: none; border-radius: 5px; color: #000; cursor: pointer; margin-top: 5px; z-index: 1000; pointer-events: auto;">üîä</button>
                <button id="pauseBtn" onclick="togglePause();" style="padding: 8px 15px; font-size: 1rem; background: rgba(255,255,255,0.9); border: none; border-radius: 5px; color: #000; cursor: pointer; margin-top: 5px; z-index: 1000; pointer-events: auto;">‚è∏Ô∏è</button>
            </div>
        </div>
        
        <!-- CONTROLES M√ìVILES -->
        <div id="mobileControls" class="hidden" style="position: absolute; bottom: 10px; left: 0; right: 0; display: flex; justify-content: space-between; padding: 0 15px; z-index: 500; pointer-events: none;">
            <div style="display: flex; gap: 10px; pointer-events: auto;">
                <button id="btnLeft" style="width: 60px; height: 60px; font-size: 2rem; background: rgba(255,255,255,0.7); border: none; border-radius: 50%; cursor: pointer;">‚¨ÖÔ∏è</button>
                <button id="btnRight" style="width: 60px; height: 60px; font-size: 2rem; background: rgba(255,255,255,0.7); border: none; border-radius: 50%; cursor: pointer;">‚û°Ô∏è</button>
            </div>
            <button id="btnShoot" style="width: 80px; height: 80px; font-size: 2.5rem; background: rgba(255,100,100,0.8); border: none; border-radius: 50%; cursor: pointer; pointer-events: auto;">üéØ</button>
        </div>
        
        <!-- PANTALLA DE PAUSA -->
        <div id="pauseScreen" class="overlay hidden" style="background: rgba(0,0,0,0.85);">
            <h1 style="font-size: 2.5rem;">‚è∏Ô∏è PAUSA</h1>
            <p style="color: #aaa; margin: 20px 0;">Juego pausado</p>
            <button class="btn" onclick="togglePause()" style="margin: 10px;">‚ñ∂Ô∏è CONTINUAR</button>
            <button class="btn" onclick="quitGame()" style="margin: 10px; background: linear-gradient(180deg, #666, #444);">üö™ SALIR</button>
        </div>
        
        <!-- SELECTOR DE PERSONAJE EN JUEGO -->
        <div id="charSelectOverlay" class="overlay hidden" style="background: rgba(0,0,0,0.9);">
            <h2 style="color: #FFD700; margin-bottom: 10px;">üîÑ CAMBIAR H√âROE</h2>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin: 10px auto; max-width: 350px;">
                <div class="char-btn-game" onclick="changeCharacter('kicillof')" style="cursor:pointer; padding: 5px; border-radius: 8px; background: rgba(255,255,255,0.1);">
                    <img src="https://kingmetronome.com/juego/sprites/kicillof.png" style="width: 40px; height: 40px; object-fit: contain;">
                </div>
                <div class="char-btn-game" onclick="changeCharacter('grabois')" style="cursor:pointer; padding: 5px; border-radius: 8px; background: rgba(255,255,255,0.1);">
                    <img src="https://kingmetronome.com/juego/sprites/grabois.png" style="width: 40px; height: 40px; object-fit: contain;">
                </div>
                <div class="char-btn-game" onclick="changeCharacter('moreno')" style="cursor:pointer; padding: 5px; border-radius: 8px; background: rgba(255,255,255,0.1);">
                    <img src="https://kingmetronome.com/juego/sprites/moreno.png" style="width: 40px; height: 40px; object-fit: contain;">
                </div>
                <div class="char-btn-game" onclick="changeCharacter('gato')" style="cursor:pointer; padding: 5px; border-radius: 8px; background: rgba(255,255,255,0.1);">
                    <img src="https://kingmetronome.com/juego/sprites/gato.png" style="width: 40px; height: 40px; object-fit: contain;">
                </div>
                <div class="char-btn-game" onclick="changeCharacter('hebe')" style="cursor:pointer; padding: 5px; border-radius: 8px; background: rgba(255,255,255,0.1);">
                    <img src="https://kingmetronome.com/juego/sprites/hebe.png" style="width: 40px; height: 40px; object-fit: contain;">
                </div>
                <div class="char-btn-game" onclick="changeCharacter('lula')" style="cursor:pointer; padding: 5px; border-radius: 8px; background: rgba(255,255,255,0.1);">
                    <img src="https://kingmetronome.com/juego/sprites/lula.png" style="width: 40px; height: 40px; object-fit: contain;">
                </div>
                <div class="char-btn-game" onclick="changeCharacter('maradona')" style="cursor:pointer; padding: 5px; border-radius: 8px; background: rgba(255,255,255,0.1);">
                    <img src="https://kingmetronome.com/juego/sprites/maradona.png" style="width: 40px; height: 40px; object-fit: contain;">
                </div>
                <div class="char-btn-game" onclick="changeCharacter('papa')" style="cursor:pointer; padding: 5px; border-radius: 8px; background: rgba(255,255,255,0.1);">
                    <img src="https://kingmetronome.com/juego/sprites/papa.png" style="width: 40px; height: 40px; object-fit: contain;">
                </div>
                <div class="char-btn-game" onclick="changeCharacter('nestor')" style="cursor:pointer; padding: 5px; border-radius: 8px; background: rgba(255,255,255,0.1);">
                    <img src="https://kingmetronome.com/juego/sprites/nestor.png" style="width: 40px; height: 40px; object-fit: contain;">
                </div>
                <div class="char-btn-game" onclick="changeCharacter('peron')" style="cursor:pointer; padding: 5px; border-radius: 8px; background: rgba(255,255,255,0.1);">
                    <img src="https://kingmetronome.com/juego/sprites/peron.png" style="width: 40px; height: 40px; object-fit: contain;">
                </div>
            </div>
            <button onclick="hideCharacterSelect()" style="padding: 8px 20px; background: #666; border: none; border-radius: 5px; color: #fff; cursor: pointer; margin-top: 10px;">‚úñ CANCELAR</button>
        </div>
        
        <div id="startScreen" class="overlay">
            <h1 style="font-size: 2.2rem; margin-bottom: 5px;">‚õìÔ∏è ¬°LIBERAR A CRISTINA! ‚õìÔ∏è</h1>
            <h2 style="color: #75AADB; font-size: 1.1rem; margin-bottom: 10px;">¬øQui√©n la liberar√°?</h2>
            
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 10px 0; max-width: 300px;">
                <div class="char-btn" onclick="selectCharacter('kicillof')" id="char-kicillof" style="cursor:pointer; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.1); border: 3px solid transparent; transition: all 0.2s; display: flex; align-items: center; gap: 10px;">
                    <img src="https://kingmetronome.com/juego/sprites/kicillof.png" style="width: 50px; height: 50px; object-fit: contain;">
                    <p style="font-size: 0.9rem; color: #fff; margin: 0;">Kicillof</p>
                </div>
                <div class="char-btn" onclick="selectCharacter('grabois')" id="char-grabois" style="cursor:pointer; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.1); border: 3px solid transparent; display: flex; align-items: center; gap: 10px;">
                    <img src="https://kingmetronome.com/juego/sprites/grabois.png" style="width: 50px; height: 50px; object-fit: contain;">
                    <p style="font-size: 0.9rem; color: #fff; margin: 0;">Grabois</p>
                </div>
                <div class="char-btn" onclick="selectCharacter('moreno')" id="char-moreno" style="cursor:pointer; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.1); border: 3px solid transparent; display: flex; align-items: center; gap: 10px;">
                    <img src="https://kingmetronome.com/juego/sprites/moreno.png" style="width: 50px; height: 50px; object-fit: contain;">
                    <p style="font-size: 0.9rem; color: #fff; margin: 0;">Moreno</p>
                </div>
                <div class="char-btn" onclick="selectCharacter('gato')" id="char-gato" style="cursor:pointer; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.1); border: 3px solid transparent; display: flex; align-items: center; gap: 10px;">
                    <img src="https://kingmetronome.com/juego/sprites/gato.png" style="width: 50px; height: 50px; object-fit: contain;">
                    <p style="font-size: 0.9rem; color: #fff; margin: 0;">Gato</p>
                </div>
                <div class="char-btn" onclick="selectCharacter('hebe')" id="char-hebe" style="cursor:pointer; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.1); border: 3px solid transparent; display: flex; align-items: center; gap: 10px;">
                    <img src="https://kingmetronome.com/juego/sprites/hebe.png" style="width: 50px; height: 50px; object-fit: contain;">
                    <p style="font-size: 0.9rem; color: #fff; margin: 0;">Hebe</p>
                </div>
                <div class="char-btn" onclick="selectCharacter('lula')" id="char-lula" style="cursor:pointer; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.1); border: 3px solid transparent; display: flex; align-items: center; gap: 10px;">
                    <img src="https://kingmetronome.com/juego/sprites/lula.png" style="width: 50px; height: 50px; object-fit: contain;">
                    <p style="font-size: 0.9rem; color: #fff; margin: 0;">Lula</p>
                </div>
                <div class="char-btn" onclick="selectCharacter('maradona')" id="char-maradona" style="cursor:pointer; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.1); border: 3px solid transparent; display: flex; align-items: center; gap: 10px;">
                    <img src="https://kingmetronome.com/juego/sprites/maradona.png" style="width: 50px; height: 50px; object-fit: contain;">
                    <p style="font-size: 0.9rem; color: #fff; margin: 0;">D10S</p>
                </div>
                <div class="char-btn" onclick="selectCharacter('papa')" id="char-papa" style="cursor:pointer; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.1); border: 3px solid transparent; display: flex; align-items: center; gap: 10px;">
                    <img src="https://kingmetronome.com/juego/sprites/papa.png" style="width: 50px; height: 50px; object-fit: contain;">
                    <p style="font-size: 0.9rem; color: #fff; margin: 0;">Papa</p>
                </div>
                <div class="char-btn" onclick="selectCharacter('nestor')" id="char-nestor" style="cursor:pointer; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.1); border: 3px solid transparent; display: flex; align-items: center; gap: 10px;">
                    <img src="https://kingmetronome.com/juego/sprites/nestor.png" style="width: 50px; height: 50px; object-fit: contain;">
                    <p style="font-size: 0.9rem; color: #fff; margin: 0;">N√©stor</p>
                </div>
                <div class="char-btn" onclick="selectCharacter('peron')" id="char-peron" style="cursor:pointer; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.1); border: 3px solid transparent; display: flex; align-items: center; gap: 10px;">
                    <img src="https://kingmetronome.com/juego/sprites/peron.png" style="width: 50px; height: 50px; object-fit: contain;">
                    <p style="font-size: 0.9rem; color: #fff; margin: 0;">Per√≥n</p>
                </div>
            </div>
            
            <p id="selectedCharName" style="color: #FFD700; font-size: 1.2rem; margin: 10px 0;">Seleccion√° tu h√©roe</p>
            
            <!-- SELECTOR DE ARMAS -->
            <h3 style="color: #75AADB; font-size: 1rem; margin: 15px 0 8px 0;">üéØ ¬øCon qu√© les tir√°s?</h3>
            <div style="display: flex; gap: 8px; justify-content: center; flex-wrap: wrap; max-width: 320px;">
                <div class="weapon-btn" onclick="selectWeapon('choripan')" id="weapon-choripan" style="cursor:pointer; padding: 8px 12px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 2px solid #FFD700; transition: all 0.2s;">
                    <span style="font-size: 1.5rem;">ü•ñ</span>
                    <p style="font-size: 0.7rem; color: #fff; margin: 2px 0 0 0;">Chorip√°n</p>
                </div>
                <div class="weapon-btn" onclick="selectWeapon('piedra')" id="weapon-piedra" style="cursor:pointer; padding: 8px 12px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 2px solid transparent; transition: all 0.2s;">
                    <span style="font-size: 1.5rem;">ü™®</span>
                    <p style="font-size: 0.7rem; color: #fff; margin: 2px 0 0 0;">Piedra</p>
                </div>
                <div class="weapon-btn" onclick="selectWeapon('brocoli')" id="weapon-brocoli" style="cursor:pointer; padding: 8px 12px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 2px solid transparent; transition: all 0.2s;">
                    <span style="font-size: 1.5rem;">ü•¶</span>
                    <p style="font-size: 0.7rem; color: #fff; margin: 2px 0 0 0;">Br√≥coli</p>
                </div>
                <div class="weapon-btn" onclick="selectWeapon('fernet')" id="weapon-fernet" style="cursor:pointer; padding: 8px 12px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 2px solid transparent; transition: all 0.2s;">
                    <span style="font-size: 1.5rem;">üçæ</span>
                    <p style="font-size: 0.7rem; color: #fff; margin: 2px 0 0 0;">Fernet</p>
                </div>
                <div class="weapon-btn" onclick="selectWeapon('constitucion')" id="weapon-constitucion" style="cursor:pointer; padding: 8px 12px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 2px solid transparent; transition: all 0.2s;">
                    <span style="font-size: 1.5rem;">üìï</span>
                    <p style="font-size: 0.7rem; color: #fff; margin: 2px 0 0 0;">Constituci√≥n</p>
                </div>
            </div>
            
            <!-- SELECTOR DE DIFICULTAD -->
            <div style="margin-top: 15px; display: flex; gap: 10px; justify-content: center;">
                <button class="difficulty-btn" id="diff-facil" onclick="setDifficulty('facil')" style="padding: 8px 15px; border-radius: 8px; background: #4CAF50; border: 2px solid #4CAF50; color: #fff; cursor: pointer; font-size: 0.85rem;">üòä F√°cil</button>
                <button class="difficulty-btn" id="diff-normal" onclick="setDifficulty('normal')" style="padding: 8px 15px; border-radius: 8px; background: transparent; border: 2px solid #FFC107; color: #FFC107; cursor: pointer; font-size: 0.85rem;">üòê Normal</button>
                <button class="difficulty-btn" id="diff-dificil" onclick="setDifficulty('dificil')" style="padding: 8px 15px; border-radius: 8px; background: transparent; border: 2px solid #F44336; color: #F44336; cursor: pointer; font-size: 0.85rem;">üòà Dif√≠cil</button>
            </div>
            
            <button class="btn" id="playBtn" onclick="startWithCharacter()" style="opacity: 0.5; pointer-events: none; font-size: 1.1rem; padding: 12px 25px; margin-top: 15px;">¬°LIBERAR A CRISTINA!</button>
            
            <button class="btn" style="padding: 10px 20px; font-size: 0.9rem; background: linear-gradient(180deg, #666, #444); margin-top: 10px;" onclick="startGame()">üìñ MODO HISTORIA</button>
        </div>
        
        <div id="levelTransition" class="overlay hidden">
            <h1 id="levelTitle">¬°NIVEL COMPLETADO!</h1>
            <div id="levelIcon" style="font-size:3rem;margin:10px;">ü•ü</div>
            <p id="levelDesc">Siguiente desaf√≠o...</p>
            <div id="peronFrase" style="display:none; background: rgba(255,215,0,0.2); border-radius: 10px; padding: 12px; margin: 10px 0; border: 2px solid #FFD700;">
                <p style="color: #FFD700; font-size: 0.75rem; margin-bottom: 5px;">üá¶üá∑ PER√ìN DICE:</p>
                <p style="color: #fff; font-size: 0.85rem; font-style: italic;"></p>
            </div>
            <div class="level-indicator">
                <div class="level-dot" id="dot1"></div>
                <div class="level-dot" id="dot2"></div>
                <div class="level-dot" id="dot3"></div>
                <div class="level-dot" id="dot4"></div>
                <div class="level-dot" id="dot5"></div>
                <div class="level-dot" id="dot6"></div>
                <div class="level-dot" id="dot7"></div>
                <div class="level-dot" id="dot8"></div>
                <div class="level-dot" id="dot9"></div>
                <div class="level-dot" id="dot10"></div>
            </div>
            <button class="btn" onclick="startNextLevel()">¬°SIGUIENTE!</button>
        </div>
        
        <div id="gameOverScreen" class="overlay hidden">
            <h1>üíÄ GAME OVER üíÄ</h1>
            <p id="gameOverText">¬°Los libertarios llegaron!</p>
            <div id="finalScore">0</div>
            <p id="finalAbatidos" style="color: #FF4444; font-size: 1.2rem;">ü•ü Libervirgos empanadados: 0</p>
            <button class="btn" onclick="retryLevel()" style="background: linear-gradient(180deg, #4CAF50, #388E3C);">üîÑ REINTENTAR NIVEL</button>
            <button class="btn" onclick="startGame()" style="margin-top: 10px; background: linear-gradient(180deg, #666, #444);">üè† EMPEZAR DE NUEVO</button>
        </div>
        
        <div id="victoryScreen" class="overlay hidden">
            <h1 id="victoryTitle" style="font-size: 1.8rem; margin-bottom: 5px;">üéâ ¬°VICTORIA! üéâ</h1>
            <h2 id="victorySubtitle" style="font-size: 1rem; margin-bottom: 10px;">¬°CRISTINA LIBRE!</h2>
            <img src="https://kingmetronome.com/juego/sprites/victoria.png" style="width: 280px; max-width: 90%; height: auto; border-radius: 10px; border: 3px solid #FFD700; margin: 10px 0;">
            <p id="victoryDesc" style="color: #75AADB; font-size: 1.1rem; margin: 5px 0;">¬°TODOS CON CRISTINA!</p>
            <div id="victoryScore" style="font-size: 1.5rem;">0</div>
            <p id="victoryAbatidos" style="color: #00FF00; font-size: 1rem;">ü•ü Libervirgos empanadados: 0</p>
            <button class="btn" onclick="window.location.href='tucumaninfinito.html'" style="margin-top: 10px; background: linear-gradient(180deg, #FF4500, #DC143C); animation: pulse 1s infinite;">üî• MODO INFINITO üî•</button>
            <button class="btn" onclick="startGame()" style="margin-top: 10px; background: linear-gradient(180deg, #666, #444);">üè† JUGAR DE NUEVO</button>
        </div>
        
        <style>
            @keyframes pulse {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.2); }
            }
            @keyframes bailar {
                0%, 100% { transform: rotate(-5deg) translateY(0); }
                25% { transform: rotate(5deg) translateY(-5px); }
                50% { transform: rotate(-5deg) translateY(0); }
                75% { transform: rotate(5deg) translateY(-5px); }
            }
            @keyframes chainBreak {
                0% { opacity: 1; transform: scale(1); }
                50% { opacity: 0.5; transform: scale(1.5) rotate(15deg); }
                100% { opacity: 0; transform: scale(2) rotate(30deg); }
            }
        </style>
    </div>

    <script>
        // SPRITES - Cargar todas las caricaturas
        const SPRITES_URL = 'https://kingmetronome.com/juego/sprites/';
        const sprites = {};
        const SPRITE_LIST = ['milei','milei_hero','majul','feinmann','lanata','gordo_dan','viale','trebuc','cristina','cristina_libre','bullrich','bullrich2','macri','trump','trump_milei','peron','maradona','evita','nestor','karina','caputo','adorni','policia','grabois','moreno','gato','hebe','lula','papa','kicillof','potobellocchia','victoria','motosierra','torta','sturzenegger','espert2'];
        
        // *** SISTEMA DE AUDIO ***
        let audioCtx = null;
        let audioEnabled = true;
        
        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
            
            // En m√≥viles, forzar que la m√∫sica empiece
            if (musicaFondo && musicaFondo.paused) {
                musicaFondo.play().catch(e => {});
            }
        }
        
        // Desbloquear audio en m√≥viles con cualquier toque
        function unlockAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
            
            // Intentar reproducir m√∫sica si existe y est√° pausada
            if (musicaFondo && musicaFondo.paused && gameRunning) {
                musicaFondo.play().catch(e => {});
            }
        }
        
        document.addEventListener('touchstart', unlockAudio, { passive: true });
        document.addEventListener('click', unlockAudio, { passive: true });
        
        function playSound(type) {
            if (!audioEnabled || !audioCtx) return;
            try {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                
                if (type === 'piedra') {
                    // Piedra: fiuuumm - silbido descendente
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(1500, audioCtx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(200, audioCtx.currentTime + 0.25);
                    gain.gain.setValueAtTime(0.25, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.25);
                    osc.start(audioCtx.currentTime);
                    osc.stop(audioCtx.currentTime + 0.25);
                } else if (type === 'fernet') {
                    // Botella: vidrio roto - ruido agudo + crack
                    osc.type = 'sawtooth';
                    osc.frequency.setValueAtTime(3000, audioCtx.currentTime);
                    osc.frequency.setValueAtTime(1500, audioCtx.currentTime + 0.02);
                    osc.frequency.setValueAtTime(4000, audioCtx.currentTime + 0.04);
                    osc.frequency.setValueAtTime(800, audioCtx.currentTime + 0.08);
                    gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.12);
                    osc.start(audioCtx.currentTime);
                    osc.stop(audioCtx.currentTime + 0.12);
                } else if (type === 'brocoli') {
                    // Br√≥coli: ghjuuuu - sonido h√∫medo/splat
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(300, audioCtx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(800, audioCtx.currentTime + 0.05);
                    osc.frequency.exponentialRampToValueAtTime(150, audioCtx.currentTime + 0.15);
                    gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.15);
                    osc.start(audioCtx.currentTime);
                    osc.stop(audioCtx.currentTime + 0.15);
                } else if (type === 'choripan' || type === 'empanada') {
                    // Chorip√°n/Empanada: paf suave
                    osc.type = 'triangle';
                    osc.frequency.setValueAtTime(400, audioCtx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(150, audioCtx.currentTime + 0.1);
                    gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                    osc.start(audioCtx.currentTime);
                    osc.stop(audioCtx.currentTime + 0.1);
                } else if (type === 'constitucion') {
                    // Constituci√≥n: whoosh pesado
                    osc.type = 'sawtooth';
                    osc.frequency.setValueAtTime(200, audioCtx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(80, audioCtx.currentTime + 0.2);
                    gain.gain.setValueAtTime(0.25, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
                    osc.start(audioCtx.currentTime);
                    osc.stop(audioCtx.currentTime + 0.2);
                } else if (type === 'pelota') {
                    // Pelota: kick de f√∫tbol
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.1);
                    gain.gain.setValueAtTime(0.4, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                    osc.start(audioCtx.currentTime);
                    osc.stop(audioCtx.currentTime + 0.1);
                } else if (type === 'panuelo') {
                    // Pa√±uelo: suave y et√©reo
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(600, audioCtx.currentTime);
                    osc.frequency.setValueAtTime(800, audioCtx.currentTime + 0.1);
                    osc.frequency.setValueAtTime(600, audioCtx.currentTime + 0.2);
                    gain.gain.setValueAtTime(0.15, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.25);
                    osc.start(audioCtx.currentTime);
                    osc.stop(audioCtx.currentTime + 0.25);
                } else if (type === 'cruz') {
                    // Cruz: campana celestial
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(1000, audioCtx.currentTime);
                    osc.frequency.setValueAtTime(1200, audioCtx.currentTime + 0.05);
                    gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                    osc.start(audioCtx.currentTime);
                    osc.stop(audioCtx.currentTime + 0.3);
                } else if (type === 'gorila') {
                    // Gorila al impactar: gru√±ido/oook
                    osc.type = 'sawtooth';
                    osc.frequency.setValueAtTime(120, audioCtx.currentTime);
                    osc.frequency.setValueAtTime(80, audioCtx.currentTime + 0.05);
                    osc.frequency.setValueAtTime(150, audioCtx.currentTime + 0.1);
                    osc.frequency.setValueAtTime(60, audioCtx.currentTime + 0.2);
                    gain.gain.setValueAtTime(0.35, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.25);
                    osc.start(audioCtx.currentTime);
                    osc.stop(audioCtx.currentTime + 0.25);
                } else if (type === 'gameover') {
                    // Game over - triste
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(400, audioCtx.currentTime);
                    osc.frequency.setValueAtTime(300, audioCtx.currentTime + 0.2);
                    osc.frequency.setValueAtTime(200, audioCtx.currentTime + 0.4);
                    gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.6);
                    osc.start(audioCtx.currentTime);
                    osc.stop(audioCtx.currentTime + 0.6);
                } else if (type === 'victoria') {
                    // Victoria - fanfarria
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(523, audioCtx.currentTime);
                    osc.frequency.setValueAtTime(659, audioCtx.currentTime + 0.15);
                    osc.frequency.setValueAtTime(784, audioCtx.currentTime + 0.3);
                    osc.frequency.setValueAtTime(1047, audioCtx.currentTime + 0.45);
                    gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.6);
                    osc.start(audioCtx.currentTime);
                    osc.stop(audioCtx.currentTime + 0.6);
                } else if (type === 'dano') {
                    // Da√±o recibido - golpe doloroso
                    osc.type = 'sawtooth';
                    osc.frequency.setValueAtTime(200, audioCtx.currentTime);
                    osc.frequency.setValueAtTime(100, audioCtx.currentTime + 0.05);
                    osc.frequency.setValueAtTime(50, audioCtx.currentTime + 0.1);
                    gain.gain.setValueAtTime(0.4, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.15);
                    osc.start(audioCtx.currentTime);
                    osc.stop(audioCtx.currentTime + 0.15);
                }
            } catch(e) {}
        }
        
        // *** AUDIOS DE ENEMIGOS AL MORIR ***
        const AUDIOS_URL = 'https://kingmetronome.com/juego/audios/';
        const enemyAudios = {};
        const enemyAudioList = [
            'majul', 'majul2', 'majul3', 'feinmann', 'feinmann1', 'feinmann2', 'lanata', 'lanata1', 'lanata2', 'milei_jocker', 'milei1', 'milei2', 'mileitrump', 'karina', 'karina1', 'karina2', 'bullrich', 
            'caputo', 'adorni', 'adorni1', 'policia', 'sturzenegger', 'trump', 
            'macri', 'potobellocchia (1)', 'gordo_dan', 'viale', 'trebuc', 'trebuc1', 'trebuc2', 'espert'
        ];
        
        // Precargar audios de enemigos
        enemyAudioList.forEach(name => {
            const audio = new Audio();
            audio.src = AUDIOS_URL + name + '.mp3';
            audio.volume = 0.45;
            enemyAudios[name] = audio;
        });
        
        // *** AUDIOS DE JUGADORES (inicio y victoria) ***
        const playerAudios = {};
        const playerList = ['maradona', 'moreno', 'papa', 'nestor', 'peron', 'grabois', 'gato', 'hebe', 'lula', 'kicillof'];
        
        // Precargar audios de jugadores
        playerList.forEach(name => {
            playerAudios[name + '_inicio'] = new Audio(AUDIOS_URL + name + '_inicio.mp3');
            playerAudios[name + '_inicio'].volume = 0.55;
            playerAudios[name + '_victoria'] = new Audio(AUDIOS_URL + name + '_victoria.mp3');
            playerAudios[name + '_victoria'].volume = 0.55;
        });
        
        // Reproducir audio de jugador
        function playPlayerAudio(playerName, tipo) {
            if (!audioEnabled) return;
            const key = playerName + '_' + tipo;
            if (playerAudios[key]) {
                try {
                    mainAudioPlaying = true; // Bloquear audios de villanos
                    playerAudios[key].currentTime = 0;
                    playerAudios[key].onended = onMainAudioEnd; // Desbloquear al terminar
                    playerAudios[key].play().catch(e => {
                        mainAudioPlaying = false;
                    });
                } catch(e) {
                    mainAudioPlaying = false;
                }
            }
        }
        
        // *** FRASES DE PER√ìN POR NIVEL ***
        const peronFrases = {};
        // Niveles 1-8 tienen frases, 9 y 10 quedan libres para otras
        const peronFrasesConfig = {
            1: 'peronfrase1',
            2: 'peronfrase2',
            3: 'peronfrase3',
            4: 'peronfrase4',
            5: 'peronfrase5',
            6: 'peronfrase6',
            7: 'peronfrase7',
            8: 'peronfrase8'
            // 9 y 10 libres para futuras frases
        };
        
        // Precargar frases de Per√≥n
        for (let nivel in peronFrasesConfig) {
            const audio = new Audio(AUDIOS_URL + peronFrasesConfig[nivel] + '.mp3');
            audio.volume = 0.6;
            peronFrases[nivel] = audio;
        }
        
        // Reproducir frase de Per√≥n seg√∫n nivel
        function playPeronFrase(nivel) {
            if (!audioEnabled) return;
            if (selectedCharacter !== 'peron') return; // Solo si juega con Per√≥n
            if (peronFrases[nivel]) {
                try {
                    mainAudioPlaying = true; // Bloquear audios de villanos
                    peronFrases[nivel].currentTime = 0;
                    peronFrases[nivel].onended = onMainAudioEnd; // Desbloquear al terminar
                    peronFrases[nivel].play().catch(e => {
                        mainAudioPlaying = false;
                    });
                } catch(e) {
                    mainAudioPlaying = false;
                }
            }
        }
        
        // Control de audios ya reproducidos (solo suenan 1 vez por nivel)
        let enemyAudioPlayed = {};
        let victoriaAudioPlayed = false;
        let inicioAudioPlayed = false;
        let mainAudioPlaying = false; // Bloqueo mientras suena audio principal
        let mileiAudioIndex = 0; // Para alternar entre milei1 y milei2
        
        // Funci√≥n para marcar fin de audio principal
        function onMainAudioEnd() {
            mainAudioPlaying = false;
        }
        
        // Reproducir audio de enemigo (solo la primera vez que muere ese tipo)
        function playEnemyAudio(enemy) {
            if (!audioEnabled) return;
            
            let audioName;
            
            // Periodistas tienen su propio √≠ndice
            if (enemy.type === 1 && enemy.periodistaIdx !== undefined) {
                const periodistas = ['majul', 'feinmann', 'gordo_dan', 'viale', 'trebuc', 'lanata'];
                let baseAudio = periodistas[enemy.periodistaIdx];
                
                // Majul tiene 3 audios aleatorios
                if (baseAudio === 'majul') {
                    const majulAudios = ['majul', 'majul2', 'majul3'];
                    audioName = majulAudios[Math.floor(Math.random() * 3)];
                } else if (baseAudio === 'feinmann') {
                    // Feinmann tiene 3 audios aleatorios
                    const feinmannAudios = ['feinmann', 'feinmann1', 'feinmann2'];
                    audioName = feinmannAudios[Math.floor(Math.random() * 3)];
                } else if (baseAudio === 'lanata') {
                    // Lanata tiene 3 audios aleatorios
                    const lanataAudios = ['lanata', 'lanata1', 'lanata2'];
                    audioName = lanataAudios[Math.floor(Math.random() * 3)];
                } else if (baseAudio === 'trebuc') {
                    // Trebuc tiene 3 audios aleatorios
                    const trebucAudios = ['trebuc', 'trebuc1', 'trebuc2'];
                    audioName = trebucAudios[Math.floor(Math.random() * 3)];
                } else {
                    audioName = baseAudio;
                }
            } else if (enemy.type === 0 || enemy.type === 12) {
                // Milei (type 0) y Milei Gigante (type 12) - alternar entre milei1 y milei2
                const mileiAudios = ['milei1', 'milei2'];
                audioName = mileiAudios[mileiAudioIndex % 2];
                mileiAudioIndex++;
            } else if (enemy.type === 6) {
                // Adorni tiene 2 audios aleatorios
                const adorniAudios = ['adorni', 'adorni1'];
                audioName = adorniAudios[Math.floor(Math.random() * 2)];
            } else if (enemy.type === 2 || enemy.type === 10) {
                // Karina (type 2) y Villarruel (type 10) tienen 3 audios aleatorios
                const karinaAudios = ['karina', 'karina1', 'karina2'];
                audioName = karinaAudios[Math.floor(Math.random() * 3)];
            } else {
                const audioMap = {
                    3: 'bullrich',
                    4: 'caputo',
                    5: 'policia',
                    7: 'sturzenegger',
                    8: 'mileitrump',       // Trump+Milei
                    9: 'macri',
                    11: 'potobellocchia (1)',
                    13: 'trump',      // Trump solo
                    14: 'espert'      // Espert
                };
                audioName = audioMap[enemy.type];
            }
            
            // Solo reproducir si no est√° sonando audio principal Y no se reprodujo en este nivel
            if (audioName && enemyAudios[audioName] && !mainAudioPlaying && !enemyAudioPlayed[audioName]) {
                enemyAudioPlayed[audioName] = true;
                try {
                    enemyAudios[audioName].currentTime = 0;
                    enemyAudios[audioName].play().catch(e => {});
                } catch(e) {}
            }
        }
        
        // *** M√öSICA DE FONDO ***
        const MUSICA_URL = 'https://kingmetronome.com/juego/audios/';
        let musicaFondo = null;
        let musicaActualNivel = 0;
        const musicaPorNivel = {
            1: 'marcha-peronista.mp3',
            2: 'marchasanlorenzo.mp3',
            3: 'nivel_3.mp3',
            4: 'nivel_4.mp3',
            5: 'nivel_5.mp3',
            6: 'nivel_6.mp3',
            7: 'nivel_7.mp3',
            8: 'nivel_8(1).mp3',
            9: 'nivel_9.mp3',
            10: 'nivel_10.mp3'
        };
        
        function playMusicaNivel(nivel) {
            console.log('Intentando reproducir m√∫sica nivel:', nivel);
            if (!audioEnabled) {
                console.log('Audio deshabilitado');
                return;
            }
            
            // Si ya est√° sonando esta m√∫sica, no hacer nada
            if (musicaActualNivel === nivel && musicaFondo && !musicaFondo.paused) {
                console.log('M√∫sica ya sonando');
                return;
            }
            
            // Parar m√∫sica anterior
            if (musicaFondo) {
                musicaFondo.pause();
                musicaFondo = null;
            }
            
            // Crear nueva m√∫sica
            const archivo = musicaPorNivel[nivel];
            if (!archivo) {
                console.log('No hay archivo para nivel:', nivel);
                return;
            }
            
            let url;
            if (archivo === 'marcha-peronista.mp3') {
                url = 'https://kingmetronome.com/juego/' + archivo;
            } else {
                url = MUSICA_URL + archivo;
            }
            
            console.log('URL m√∫sica:', url);
            
            musicaFondo = new Audio(url);
            musicaFondo.loop = true;
            // Nivel 9 tiene volumen m√°s bajo porque el archivo est√° m√°s fuerte
            musicaFondo.volume = (nivel === 9) ? 0.08 : 0.15;
            musicaActualNivel = nivel;
            
            // Reproducir
            musicaFondo.play().then(() => {
                console.log('M√∫sica reproduciendo OK');
            }).catch(e => {
                console.log('Error reproduciendo m√∫sica:', e.message);
            });
        }
        
        function stopMusica() {
            if (musicaFondo) {
                musicaFondo.pause();
                musicaFondo = null;
            }
            musicaActualNivel = 0;
        }
        
        // Reanudar m√∫sica en cualquier toque (para m√≥viles)
        function resumeMusic() {
            if (musicaFondo && musicaFondo.paused && gameRunning && audioEnabled) {
                musicaFondo.play().catch(e => {});
            }
        }
        document.addEventListener('touchstart', resumeMusic, { passive: true });
        document.addEventListener('click', resumeMusic, { passive: true });
        
        // Cargar fondos
        const fondos = {};
        for (let i = 1; i <= 10; i++) {
            fondos[i] = new Image();
            fondos[i].src = 'https://kingmetronome.com/juego/fondos/fondo' + i + '.png';
        }
        SPRITE_LIST.forEach(name => {
            const img = new Image();
            img.src = SPRITES_URL + name + '.png';
            img.onload = () => { sprites[name] = img; };
        });
        
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Detectar si es m√≥vil
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        // *** FRASES DE PER√ìN POR NIVEL ***
        const frasesPeronNivel = [
            "¬°La √∫nica verdad es la realidad!",
            "¬°Mejor que decir es hacer, mejor que prometer es realizar!",
            "¬°Para un argentino no hay nada mejor que otro argentino!",
            "¬°Los pueblos que olvidan su historia est√°n condenados a repetirla!",
            "¬°La Patria dejar√° de ser colonia o la bandera flamear√° sobre sus ruinas!"
        ];
        
        function hablarPeron(frase) {
            // Voz desactivada - solo se muestran las frases escritas
            return;
            
            speechSynthesis.cancel();
            
            const utterance = new SpeechSynthesisUtterance(frase);
            utterance.lang = 'es-MX'; // Espa√±ol M√©xico suele tener voz masculina
            utterance.rate = 0.8;
            utterance.pitch = 0.1; // LO M√ÅS GRAVE POSIBLE
            utterance.volume = 1;
            
            const voices = speechSynthesis.getVoices();
            // Buscar espec√≠ficamente voz masculina
            let maleVoice = voices.find(v => v.name.includes('Google espa√±ol') && !v.name.includes('female'));
            if (!maleVoice) maleVoice = voices.find(v => v.name.includes('Juan') || v.name.includes('Jorge') || v.name.includes('Diego') || v.name.includes('Pablo'));
            if (!maleVoice) maleVoice = voices.find(v => v.name.includes('Male') || v.name.includes('male'));
            if (!maleVoice) maleVoice = voices.find(v => v.lang.includes('es'));
            if (maleVoice) utterance.voice = maleVoice;
            
            speechSynthesis.speak(utterance);
        }
        // *** SISTEMA DE AUDIO POR NIVEL (preparado para agregar audios) ***
        let audioAliadoActual = null;
        let lastAudioAliado = 0;
        
        function playAudioAliado(aliado) {
            // Por ahora comentado - se agregar√° audio por nivel despu√©s
            // const audioUrl = `https://kingmetronome.com/juego/audio/${aliado}.mp3`;
            // if (audioAliadoActual) audioAliadoActual.pause();
            // audioAliadoActual = new Audio(audioUrl);
            // audioAliadoActual.play();
        }
        
        // *** SISTEMA DE M√öSICA ***
        let musicPlaying = false;
        let audioElement = null;
        
        function toggleMusic() {
            if (!audioElement) {
                audioElement = new Audio('https://kingmetronome.com/juego/marcha-peronista.mp3');
                audioElement.loop = true;
                audioElement.volume = 0.15;
            }
            
            if (musicPlaying) {
                audioElement.pause();
                musicPlaying = false;
            } else {
                audioElement.play();
                musicPlaying = true;
            }
        }
        
        // *** MODO DEBUG SECRETO ***
        // C√≥digo secreto: escribir "tucuman" para activar
        let debugCode = '';
        const secretCode = 'tucuman';
        
        document.addEventListener('keypress', (e) => {
            debugCode += e.key.toLowerCase();
            if (debugCode.length > secretCode.length) {
                debugCode = debugCode.slice(-secretCode.length);
            }
            if (debugCode === secretCode) {
                const panel = document.getElementById('debugPanel');
                if (panel) {
                    panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
                    debugCode = '';
                }
            }
        });
        
        // Empezar en nivel espec√≠fico
        function startAtLevel(levelIndex) {
            // Iniciar audio (necesario en m√≥viles)
            initAudio();
            
            score = 0;
            libertariosAbatidos = 0;
            currentLevel = levelIndex;
            ammo = 20 + levelIndex * 5;
            maxAmmo = 20 + levelIndex * 5;
            vidas = 3;
            moveLeft = false;
            moveRight = false;
            victoriaAudioPlayed = false; // Resetear para juego nuevo
            initLevel();
            document.getElementById('hud').classList.remove('hidden');
            // Mostrar controles m√≥viles si es m√≥vil
            if (isMobile) {
                document.getElementById('mobileControls').classList.remove('hidden');
            }
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameOverScreen').classList.add('hidden');
            document.getElementById('victoryScreen').classList.add('hidden');
            document.getElementById('levelTransition').classList.add('hidden');
            document.getElementById('debugPanel').style.display = 'none';
            gameRunning = true;
        }
        
        // Polyfill para roundRect (algunos navegadores no lo tienen)
        if (!CanvasRenderingContext2D.prototype.roundRect) {
            CanvasRenderingContext2D.prototype.roundRect = function(x, y, w, h, r) {
                if (w < 2 * r) r = w / 2;
                if (h < 2 * r) r = h / 2;
                this.beginPath();
                this.moveTo(x + r, y);
                this.arcTo(x + w, y, x + w, y + h, r);
                this.arcTo(x + w, y + h, x, y + h, r);
                this.arcTo(x, y + h, x, y, r);
                this.arcTo(x, y, x + w, y, r);
                this.closePath();
                return this;
            };
        }
        
        // Variables para frases de Maradona
        let maradonaFraseActual = '';
        let maradonaFraseTimer = 0;
        
        // 10 NIVELES - ¬°LIBERAR A CRISTINA!
        const LEVELS = [
            {
                id: 1, name: "Los Periodistas", icon: "üì∫",
                description: "¬°Los medios hegem√≥nicos atacan!",
                waves: 2, background: { sky: '#87CEEB', grass: '#228B22' },
                defenseHP: 250, spawnRateBase: 5000,
                enemyTypes: [1, 1, 1],
                jugador: 'kicillof', proyectil: 'empanada'
            },
            {
                id: 2, name: "La Casta Pol√≠tica", icon: "üé≠",
                description: "¬°Nueva lucha!",
                waves: 2, background: { sky: '#FFE4B5', grass: '#556B2F' },
                defenseHP: 250, spawnRateBase: 4800,
                enemyTypes: [1, 1, 2],
                jugador: 'grabois', proyectil: 'choripan'
            },
            {
                id: 3, name: "El Vocero Miente", icon: "üé§",
                description: "¬°Control√° los precios!",
                waves: 2, background: { sky: '#E0F7FA', grass: '#2E7D32' },
                defenseHP: 250, spawnRateBase: 4600,
                enemyTypes: [1, 1, 2, 6],
                jugador: 'moreno', proyectil: 'choripan'
            },
            {
                id: 4, name: "La Represi√≥n", icon: "üöî",
                description: "¬°Par√° los camiones!",
                waves: 2, background: { sky: '#B0C4DE', grass: '#228B22' },
                defenseHP: 280, spawnRateBase: 4400,
                enemyTypes: [0, 1, 1, 3, 5],
                jugador: 'gato', proyectil: 'choripan'
            },
            {
                id: 5, name: "Las Madres", icon: "üßï",
                description: "¬°Resist√≠!",
                waves: 2, background: { sky: '#87CEEB', grass: '#228B22' },
                defenseHP: 280, spawnRateBase: 4200,
                enemyTypes: [0, 0, 1, 3, 3, 4, 5, 7, 11, 14],
                jugador: 'hebe', proyectil: 'panuelo'
            },
            {
                id: 6, name: "El Hermano Brasile√±o", icon: "üáßüá∑",
                description: "¬°Cruz√° la frontera!",
                waves: 2, background: { sky: '#1E90FF', grass: '#FFD700' },
                defenseHP: 300, spawnRateBase: 4000,
                enemyTypes: [0, 0, 1, 3, 3, 4, 5, 7, 9, 11, 14],
                jugador: 'lula', proyectil: 'choripan'
            },
            {
                id: 7, name: "La Mano de D10S", icon: "‚öΩ",
                description: "¬°Metele gol a los ingleses!",
                waves: 2, background: { sky: '#FFB6C1', grass: '#228B22' },
                defenseHP: 300, spawnRateBase: 3800,
                enemyTypes: [0, 0, 0, 0, 0, 1, 3, 4, 5, 7, 13, 11, 14],
                jugador: 'maradona', proyectil: 'pelota'
            },
            {
                id: 8, name: "La Bendici√≥n", icon: "‚úùÔ∏è",
                description: "¬°El Papa bendice la lucha!",
                waves: 2, background: { sky: '#FFFFFF', grass: '#808080' },
                defenseHP: 320, spawnRateBase: 3600,
                enemyTypes: [0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 5, 7, 9, 13, 11, 14],
                jugador: 'papa', proyectil: 'cruz'
            },
            {
                id: 9, name: "La Batalla Previa", icon: "üî•",
                description: "¬°El √∫ltimo esfuerzo!",
                waves: 2, background: { sky: '#FF6347', grass: '#2F4F4F' },
                defenseHP: 350, spawnRateBase: 3400,
                enemyTypes: [0, 0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 5, 7, 8, 8, 8, 8, 9, 11, 14, 14],
                jugador: 'nestor', proyectil: 'choripan'
            },
            {
                id: 10, name: "¬°LIBERAR A CRISTINA!", icon: "‚õìÔ∏è",
                description: "¬°Derrot√° a Milei y Trump!",
                waves: 2, background: { sky: '#4B0082', grass: '#2F4F4F' },
                defenseHP: 400, spawnRateBase: 3800,
                enemyTypes: [0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 4, 7, 8, 8, 8, 8, 8, 9, 11, 14, 14],
                jugador: 'peron', proyectil: 'choripan', aliado: 'evita'
            }
        ];
        
        // Estado
        let gameRunning = false;
        let gamePaused = false;
        let difficulty = 'facil'; // facil, normal, dificil
        let difficultyMultipliers = {
            facil: { enemySpeed: 0.9, enemyHP: 0.8, spawnRate: 1.2, defenseHP: 1.3 },
            normal: { enemySpeed: 1.1, enemyHP: 1.0, spawnRate: 1.0, defenseHP: 1.0 },
            dificil: { enemySpeed: 1.4, enemyHP: 1.3, spawnRate: 0.7, defenseHP: 0.7 }
        };
        let currentLevel = 0;
        let currentWave = 1;
        let score = 0;
        let libertariosAbatidos = 0; // Contador de enemigos eliminados
        let enemies = [];
        let empanadas = [];
        let pelotas = [];
        let proyectilesEnemigos = []; // Cacas y motosierras
        let particles = [];
        let lastSpawn = 0;
        let spawnRate = 2500;
        let enemiesInWave = 0;
        let defenseHP = 100;
        let maxDefenseHP = 100;
        let ammo = 20;
        let maxAmmo = 20;
        
        // *** ANIMACIONES DE FONDO ***
        let clouds = [
            { x: 50, y: 40, speed: 0.3, scale: 1 },
            { x: 200, y: 60, speed: 0.5, scale: 1.3 },
            { x: 350, y: 30, speed: 0.4, scale: 0.9 },
            { x: 500, y: 70, speed: 0.35, scale: 1.1 }
        ];
        let birds = [
            { x: 100, y: 80, speed: 1.2, wingPhase: 0 },
            { x: 300, y: 50, speed: 1.5, wingPhase: Math.PI },
            { x: 450, y: 90, speed: 1.0, wingPhase: Math.PI/2 }
        ];
        // D√≥lares volando en el cielo
        let dolares = [
            { x: 80, y: 100, speed: 0.8, rotation: 0, wobble: 0 },
            { x: 180, y: 70, speed: 1.1, rotation: 0.5, wobble: Math.PI/3 },
            { x: 320, y: 120, speed: 0.9, rotation: 0.2, wobble: Math.PI/2 },
            { x: 420, y: 60, speed: 1.3, rotation: 0.8, wobble: Math.PI },
            { x: 550, y: 90, speed: 0.7, rotation: 0.3, wobble: Math.PI/4 }
        ];
        // Aviones F-16 de papel (parodia)
        let aviones = [
            { x: -50, y: 45, speed: 2.5, wobble: 0 },
            { x: -150, y: 85, speed: 2.2, wobble: Math.PI/2 },
            { x: -250, y: 55, speed: 2.8, wobble: Math.PI },
            { x: -350, y: 105, speed: 2.0, wobble: Math.PI/3 },
            { x: -450, y: 70, speed: 2.6, wobble: Math.PI/4 }
        ];
        let confetti = [];
        let fireworks = [];
        let showingVictoryEffects = false;
        
        let peronActive = false;
        let maradonaActive = false;
        let nestorActive = false;
        let evitaActive = false;
        let cristinaActive = false;
        let graboisActive = false;
        let morenoActive = false;
        let gatoActive = false;
        let hebeActive = false;
        let lulaActive = false;
        let peronX = 0;
        let maradonaX = 0;
        let nestorX = 0;
        let evitaX = 0;
        let cristinaX = 0;
        let graboisX = 0;
        let morenoX = 0;
        let gatoX = 0;
        let hebeX = 0;
        let lulaX = 0;
        
        // Movimiento de aliados
        let peronDir = 1;
        let maradonaDir = -1;
        let nestorDir = 1;
        let evitaDir = -1;
        let graboisDir = 1;
        let morenoDir = -1;
        let gatoDir = 1;
        let hebeDir = -1;
        let lulaDir = 1;
        let peronBaseX = 0;
        let maradonaBaseX = 0;
        let nestorBaseX = 0;
        let evitaBaseX = 0;
        let graboisBaseX = 0;
        let morenoBaseX = 0;
        let gatoBaseX = 0;
        let hebeBaseX = 0;
        let lulaBaseX = 0;
        const allyMoveRange = 40; // Rango de movimiento
        const allyMoveSpeed = 0.5; // Velocidad
        let lastPeronShot = 0;
        let lastMaradonaShot = 0;
        let lastNestorShot = 0;
        let lastEvitaShot = 0;
        let lastCristinaShot = 0;
        let lastGraboisShot = 0;
        let lastMorenoShot = 0;
        let lastGatoShot = 0;
        let lastHebeShot = 0;
        let lastLulaShot = 0;
        let allyMessage = '';
        let allyMessageTimer = 0;
        let vidas = 3; // Vidas de TUCU-MAN
        
        // Controles de movimiento TUCU-MAN - OPTIMIZADO M√ìVIL
        let moveLeft = false;
        let moveRight = false;
        let tucumanSpeed = 0;
        let tucumanMaxSpeed = 6;
        let targetX = null;
        let lastTouchX = null;
        
        // Tipos de empanadas Y SANGUCHES DE MILANESA
        const empanadasTypes = {
            picante: { damage: 10, color: '#FF4500', effect: 'destroza' },
            humita: { damage: 0, color: '#FFD700', effect: 'paraliza' },
            verdura: { damage: 0, color: '#228B22', effect: null }
        };
        
        const sangucheMilanesa = {
            damage: 20, // M√°s da√±o que la empanada
            color: '#D2691E',
            effect: 'destroza_multiple' // Destruye y hace da√±o en √°rea
        };
        
        function resizeCanvas() {
            const maxW = Math.min(window.innerWidth - 20, 400);
            const maxH = Math.min(window.innerHeight - 20, 650);
            canvas.width = maxW;
            canvas.height = maxH;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        const tucuman = { x: 200, y: 0, width: 50, height: 70 };
        
        // DIBUJAR TUCU-MAN CON CAPA
        function drawTucuman() {
            const x = tucuman.x;
            const y = canvas.height - 120;
            tucuman.y = y;
            
            // Sombra
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.beginPath();
            ctx.ellipse(x, y + 65, 25, 8, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // *** CAPA √âPICA ***
            const capeWave = Math.sin(Date.now() / 200) * 5;
            ctx.fillStyle = '#75AADB'; // Celeste
            ctx.beginPath();
            ctx.moveTo(x - 15, y - 15);
            ctx.quadraticCurveTo(x - 40 + capeWave, y + 20, x - 35 + capeWave, y + 60);
            ctx.lineTo(x - 20, y + 50);
            ctx.lineTo(x - 18, y);
            ctx.closePath();
            ctx.fill();
            
            ctx.beginPath();
            ctx.moveTo(x + 15, y - 15);
            ctx.quadraticCurveTo(x + 40 - capeWave, y + 20, x + 35 - capeWave, y + 60);
            ctx.lineTo(x + 20, y + 50);
            ctx.lineTo(x + 18, y);
            ctx.closePath();
            ctx.fill();
            
            // Borde blanco de la capa
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(x - 35 + capeWave, y + 60);
            ctx.lineTo(x, y + 70);
            ctx.lineTo(x + 35 - capeWave, y + 60);
            ctx.stroke();
            
            // Cuerpo (camiseta celeste y blanca)
            ctx.fillStyle = '#75AADB';
            ctx.fillRect(x - 20, y, 40, 40);
            ctx.fillStyle = '#fff';
            ctx.fillRect(x - 20, y + 10, 40, 8);
            ctx.fillRect(x - 20, y + 26, 40, 8);
            
            // Cabeza
            ctx.fillStyle = '#DEB887';
            ctx.beginPath();
            ctx.arc(x, y - 10, 18, 0, Math.PI * 2);
            ctx.fill();
            
            // Boina tucumana
            ctx.fillStyle = '#8B0000';
            ctx.beginPath();
            ctx.ellipse(x, y - 22, 22, 10, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(x, y - 28, 8, 0, Math.PI * 2);
            ctx.fill();
            
            // Ojos
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(x - 6, y - 12, 3, 0, Math.PI * 2);
            ctx.arc(x + 6, y - 12, 3, 0, Math.PI * 2);
            ctx.fill();
            
            // Sonrisa
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(x, y - 5, 8, 0.1 * Math.PI, 0.9 * Math.PI);
            ctx.stroke();
            
            // Bigote
            ctx.strokeStyle = '#4a3728';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(x - 12, y - 4);
            ctx.quadraticCurveTo(x, y - 2, x + 12, y - 4);
            ctx.stroke();
            
            // Pantal√≥n
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(x - 18, y + 40, 36, 25);
        }
        
        // DIBUJAR JUGADOR SEG√öN NIVEL
        function drawJugador() {
            const level = LEVELS[currentLevel];
            const jugador = level.jugador;
            const x = tucuman.x;
            const y = canvas.height - 120;
            tucuman.y = y;
            
            // Sombra
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.beginPath();
            ctx.ellipse(x, y + 65, 25, 8, 0, 0, Math.PI * 2);
            ctx.fill();
            
            if (jugador === 'tucuman') {
                drawTucuman();
                return;
            }
            
            // Usar sprite del personaje
            var sprite = sprites[jugador];
            if (sprite) {
                var scale = 1.2;
                ctx.drawImage(sprite, x - (sprite.width * scale)/2, y - 40, sprite.width * scale, sprite.height * scale);
            } else {
                // Fallback - dibujar rect√°ngulo
                ctx.fillStyle = '#75AADB';
                ctx.fillRect(x - 25, y - 20, 50, 80);
            }
        }
        
        // DIBUJAR OBJETIVO A DEFENDER
        function drawDefenseTarget() {
            const level = LEVELS[currentLevel];
            const x = canvas.width / 2;
            const y = canvas.height - 45;
            
            // Barra de HP
            const barW = 80, barH = 6;
            ctx.fillStyle = '#333';
            ctx.fillRect(x - barW/2 - 2, y - 40, barW + 4, barH + 4);
            const hpPct = defenseHP / maxDefenseHP;
            ctx.fillStyle = hpPct < 0.3 ? '#f44' : hpPct < 0.6 ? '#f90' : '#4c5';
            ctx.fillRect(x - barW/2, y - 38, barW * hpPct, barH);
            
            // L√≠nea de defensa (roja parpadeante)
            ctx.strokeStyle = Math.sin(Date.now() / 200) > 0 ? '#ff0000' : '#aa0000';
            ctx.lineWidth = 3;
            ctx.setLineDash([10, 5]);
            ctx.beginPath();
            ctx.moveTo(0, canvas.height - 75);
            ctx.lineTo(canvas.width, canvas.height - 75);
            ctx.stroke();
            ctx.setLineDash([]);
            
            if (level.id === 1) drawGiantEmpanada(x, y);
            else if (level.id === 2) drawGoldenLemon(x, y);
            else if (level.id === 3) drawCerroSanJavier(x, y);
            else if (level.id === 4) drawTrenTucumano(x, y);
            else drawCasaHistorica(x, y);
        }
        
        function drawGiantEmpanada(x, y) {
            ctx.fillStyle = '#DAA520';
            ctx.beginPath();
            ctx.ellipse(x, y, 45, 28, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#F4A460';
            ctx.beginPath();
            ctx.ellipse(x, y - 5, 40, 22, 0, Math.PI, 2 * Math.PI);
            ctx.fill();
            ctx.strokeStyle = '#8B4513';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.ellipse(x, y, 45, 28, 0, 0, Math.PI);
            ctx.stroke();
            // Vapor
            ctx.strokeStyle = 'rgba(255,255,255,0.5)';
            ctx.lineWidth = 2;
            for (let i = 0; i < 3; i++) {
                const vx = x - 15 + i * 15;
                const t = Date.now() / 400 + i;
                ctx.beginPath();
                ctx.moveTo(vx, y - 28);
                ctx.quadraticCurveTo(vx + Math.sin(t) * 5, y - 40, vx, y - 50);
                ctx.stroke();
            }
        }
        
        function drawGoldenLemon(x, y) {
            const grad = ctx.createRadialGradient(x - 8, y - 8, 3, x, y, 32);
            grad.addColorStop(0, '#FFE135');
            grad.addColorStop(1, '#DAA520');
            ctx.fillStyle = grad;
            ctx.beginPath();
            ctx.ellipse(x, y, 32, 25, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#9ACD32';
            ctx.beginPath();
            ctx.ellipse(x - 35, y, 6, 4, 0.3, 0, Math.PI * 2);
            ctx.ellipse(x + 35, y, 6, 4, -0.3, 0, Math.PI * 2);
            ctx.fill();
            // Coronita
            for (let i = 0; i < 5; i++) {
                const a = (i / 5) * Math.PI - Math.PI / 2 - 0.3;
                const px = x + Math.cos(a) * 20;
                const py = y - 30 + Math.sin(a) * 8;
                ctx.beginPath();
                ctx.moveTo(px - 4, py + 6);
                ctx.lineTo(px, py - 4);
                ctx.lineTo(px + 4, py + 6);
                ctx.fill();
            }
        }
        
        function drawCerroSanJavier(x, y) {
            // Monta√±a
            ctx.fillStyle = '#5D4E37';
            ctx.beginPath();
            ctx.moveTo(x - 60, y + 20);
            ctx.lineTo(x, y - 40);
            ctx.lineTo(x + 60, y + 20);
            ctx.closePath();
            ctx.fill();
            // Nieve en la cima
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.moveTo(x - 15, y - 25);
            ctx.lineTo(x, y - 40);
            ctx.lineTo(x + 15, y - 25);
            ctx.closePath();
            ctx.fill();
            // Cristo Redentor (simplificado)
            ctx.fillStyle = '#E8E8E8';
            ctx.fillRect(x - 3, y - 55, 6, 20);
            ctx.fillRect(x - 12, y - 50, 24, 5);
            ctx.beginPath();
            ctx.arc(x, y - 58, 5, 0, Math.PI * 2);
            ctx.fill();
        }
        
        function drawTrenTucumano(x, y) {
            // Locomotora
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(x - 40, y - 15, 80, 30);
            ctx.fillStyle = '#8B0000';
            ctx.fillRect(x - 35, y - 10, 30, 20);
            // Chimenea
            ctx.fillStyle = '#333';
            ctx.fillRect(x - 30, y - 30, 10, 15);
            // Ruedas
            ctx.fillStyle = '#1a1a1a';
            ctx.beginPath();
            ctx.arc(x - 25, y + 18, 10, 0, Math.PI * 2);
            ctx.arc(x, y + 18, 10, 0, Math.PI * 2);
            ctx.arc(x + 25, y + 18, 10, 0, Math.PI * 2);
            ctx.fill();
            // Humo
            ctx.fillStyle = 'rgba(100,100,100,0.5)';
            const t = Date.now() / 300;
            ctx.beginPath();
            ctx.arc(x - 25 + Math.sin(t) * 5, y - 45, 8, 0, Math.PI * 2);
            ctx.arc(x - 20 + Math.sin(t + 1) * 5, y - 55, 10, 0, Math.PI * 2);
            ctx.fill();
        }
        
        function drawCasaHistorica(x, y) {
            // Pared
            ctx.fillStyle = '#F5F5DC';
            ctx.fillRect(x - 50, y - 20, 100, 45);
            // Columnas
            ctx.fillStyle = '#E8E8E8';
            for (let i = 0; i < 5; i++) {
                ctx.fillRect(x - 45 + i * 22, y - 15, 6, 38);
            }
            // Techo
            ctx.fillStyle = '#CD853F';
            ctx.beginPath();
            ctx.moveTo(x - 55, y - 20);
            ctx.lineTo(x, y - 45);
            ctx.lineTo(x + 55, y - 20);
            ctx.closePath();
            ctx.fill();
            // Puerta
            ctx.fillStyle = '#654321';
            ctx.fillRect(x - 10, y, 20, 25);
            ctx.beginPath();
            ctx.arc(x, y, 10, Math.PI, 2 * Math.PI);
            ctx.fill();
            // Bandera
            ctx.fillStyle = '#75AADB';
            ctx.fillRect(x - 2, y - 60, 25, 6);
            ctx.fillStyle = '#fff';
            ctx.fillRect(x - 2, y - 54, 25, 6);
            ctx.fillStyle = '#75AADB';
            ctx.fillRect(x - 2, y - 48, 25, 6);
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(x - 4, y - 60, 3, 20);
            // 1816
            ctx.font = 'bold 10px Bangers';
            ctx.fillText('1816', x, y - 28);
        }
        
        // PER√ìN
        function drawPeron() {
            if (!peronActive) return;
            const x = peronX;
            const y = canvas.height - 140;
            
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.beginPath();
            ctx.ellipse(x, y + 85, 22, 7, 0, 0, Math.PI * 2);
            ctx.fill();
            
            if (sprites.peron) {
                var img = sprites.peron;
                var scale = 1.2;
                ctx.drawImage(img, x - (img.width * scale)/2, y - 45, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#4a5d23';
                ctx.fillRect(x - 20, y, 40, 60);
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 15, 20, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        // GRABOIS
        function drawGrabois() {
            if (!graboisActive) return;
            const x = graboisX;
            const y = canvas.height - 130;
            
            if (sprites.grabois) {
                var img = sprites.grabois;
                ctx.drawImage(img, x - img.width/2, y - 40, img.width, img.height);
            }
        }
        
        // MORENO
        function drawMoreno() {
            if (!morenoActive) return;
            const x = morenoX;
            const y = canvas.height - 130;
            
            if (sprites.moreno) {
                var img = sprites.moreno;
                ctx.drawImage(img, x - img.width/2, y - 40, img.width, img.height);
            }
        }
        
        // MOYANO
        function drawGato() {
            if (!gatoActive) return;
            const x = gatoX;
            const y = canvas.height - 130;
            
            if (sprites.gato) {
                var img = sprites.gato;
                ctx.drawImage(img, x - img.width/2, y - 40, img.width, img.height);
            }
        }
        
        // HEBE
        function drawHebe() {
            if (!hebeActive) return;
            const x = hebeX;
            const y = canvas.height - 130;
            
            if (sprites.hebe) {
                var img = sprites.hebe;
                ctx.drawImage(img, x - img.width/2, y - 40, img.width, img.height);
            }
        }
        
        // LULA
        function drawLula() {
            if (!lulaActive) return;
            const x = lulaX;
            const y = canvas.height - 130;
            
            if (sprites.lula) {
                var img = sprites.lula;
                ctx.drawImage(img, x - img.width/2, y - 40, img.width, img.height);
            }
        }
        
        // MARADONA
        function drawMaradona() {
            if (!maradonaActive) return;
            const x = maradonaX;
            const y = canvas.height - 105;
            
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.beginPath();
            ctx.ellipse(x, y + 68, 20, 6, 0, 0, Math.PI * 2);
            ctx.fill();
            
            if (sprites.maradona) {
                var img = sprites.maradona;
                var scale = 1.1;
                ctx.drawImage(img, x - (img.width * scale)/2, y - 30, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#75AADB';
                ctx.fillRect(x - 18, y, 36, 45);
                ctx.fillStyle = '#fff';
                ctx.fillRect(x - 14, y, 8, 45);
                ctx.fillRect(x + 6, y, 8, 45);
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 12, 18, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        // N√âSTOR
        function drawNestor() {
            if (!nestorActive) return;
            const x = nestorX;
            const y = canvas.height - 125;
            
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.beginPath();
            ctx.ellipse(x, y + 75, 18, 6, 0, 0, Math.PI * 2);
            ctx.fill();
            
            if (sprites.nestor) {
                var img = sprites.nestor;
                var scale = 1.1;
                ctx.drawImage(img, x - (img.width * scale)/2, y - 20, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#4a4a4a';
                ctx.fillRect(x - 18, y + 10, 36, 45);
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 8, 16, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        // EVITA (aparece nivel 7)
        function drawEvita() {
            if (!evitaActive) return;
            const x = evitaX;
            const y = canvas.height - 120;
            
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.beginPath();
            ctx.ellipse(x, y + 70, 18, 6, 0, 0, Math.PI * 2);
            ctx.fill();
            
            if (sprites.evita) {
                var img = sprites.evita;
                var scale = 1.1;
                ctx.drawImage(img, x - (img.width * scale)/2, y - 25, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#F5F5DC';
                ctx.fillRect(x - 16, y + 5, 32, 45);
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 8, 14, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#DAA520';
                ctx.beginPath();
                ctx.arc(x, y - 15, 12, Math.PI, 2 * Math.PI);
                ctx.fill();
            }
        }
        
        // CRISTINA
        function drawCristina() {
            if (!cristinaActive) return;
            const x = cristinaX;
            const y = canvas.height - 125;
            
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.beginPath();
            ctx.ellipse(x, y + 75, 18, 6, 0, 0, Math.PI * 2);
            ctx.fill();
            
            if (sprites.cristina) {
                var img = sprites.cristina;
                var scale = 1.2;
                ctx.drawImage(img, x - (img.width * scale)/2, y - 20, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#1a1a1a';
                ctx.fillRect(x - 16, y + 10, 32, 45);
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 5, 16, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#1a1a1a';
                ctx.beginPath();
                ctx.ellipse(x, y - 15, 18, 12, 0, Math.PI, 2 * Math.PI);
                ctx.fill();
            }
        }
        
        // DIBUJAR ENEMIGOS
        function drawEnemy(e) {
            const x = e.x, y = e.y;
            
            // Efecto paralizado
            if (e.paralizado) {
                if (e.congelado) {
                    // Efecto congelado (azul hielo)
                    ctx.fillStyle = 'rgba(135, 206, 235, 0.5)';
                    ctx.beginPath();
                    ctx.ellipse(x, y + 15, 35, 45, 0, 0, Math.PI * 2);
                    ctx.fill();
                    // Copos de nieve
                    ctx.fillStyle = '#fff';
                    ctx.font = '12px Arial';
                    ctx.fillText('‚ùÑÔ∏è', x - 20, y - 10);
                    ctx.fillText('‚ùÑÔ∏è', x + 10, y + 5);
                } else {
                    ctx.fillStyle = 'rgba(255, 215, 0, 0.4)';
                    ctx.beginPath();
                    ctx.ellipse(x, y + 15, 30, 40, 0, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            // Quitar marca de congelado cuando termina
            if (!e.paralizado && e.congelado) {
                e.congelado = false;
            }
            
            if (e.type === 0) drawMilei(x, y, e);
            else if (e.type === 1) drawGordoDan(x, y, e);
            else if (e.type === 2) drawKarina(x, y, e);
            else if (e.type === 3) drawBullrich(x, y);
            else if (e.type === 4) drawCaputo(x, y, e);
            else if (e.type === 5) drawPolicia(x, y, e);
            else if (e.type === 6) drawAdorni(x, y);
            else if (e.type === 7) drawSturzenegger(x, y, e);
            else if (e.type === 8) drawTrumpMileiCasados(x, y, e);
            else if (e.type === 9) drawMacri(x, y, e);
            else if (e.type === 10) drawVillarruel(x, y);
            else if (e.type === 11) drawPotobellocchia(x, y, e);
            else if (e.type === 12) drawMileiGigante(x, y, e);
            else if (e.type === 13) drawTrumpSolo(x, y, e);
            else if (e.type === 14) drawEspert(x, y, e);
        }
        
        // TRUMP SOLO (tipo 13)
        function drawTrumpSolo(x, y, e) {
            if (sprites.trump) {
                var img = sprites.trump;
                var scale = 1.0;
                ctx.drawImage(img, x - (img.width * scale)/2, y - img.height * scale + 50, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#1a1a1a';
                ctx.fillRect(x - 20, y, 40, 50);
                ctx.fillStyle = '#FFB366';
                ctx.beginPath();
                ctx.arc(x, y - 10, 15, 0, Math.PI * 2);
                ctx.fill();
                // Pelo amarillo
                ctx.fillStyle = '#FFD700';
                ctx.fillRect(x - 12, y - 25, 24, 10);
            }
            // Dispara banderas USA
            if (!e.lastShot) e.lastShot = 0;
            if (Date.now() - e.lastShot > 4000 && Math.random() > 0.95) {
                e.lastShot = Date.now();
                proyectilesEnemigos.push({ x: x, y: y - 20, vx: 0, vy: 2.5, type: 'bandera_usa', angle: 0 });
            }
        }
        
        // ESPERT (pelado economista con arma)
        function drawEspert(x, y, e) {
            if (sprites.espert2) {
                var img = sprites.espert2;
                var scale = 0.10; // Imagen m√°s grande
                ctx.drawImage(img, x - (img.width * scale)/2, y - img.height * scale + 60, img.width * scale, img.height * scale);
            } else {
                // Fallback geom√©trico
                ctx.fillStyle = '#9370DB'; // Remera violeta
                ctx.fillRect(x - 18, y, 36, 40);
                ctx.fillStyle = '#DEB887'; // Piel
                ctx.beginPath();
                ctx.arc(x, y - 10, 16, 0, Math.PI * 2);
                ctx.fill();
                // Pelado (sin pelo)
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 15, 12, Math.PI, 0);
                ctx.fill();
            }
            // ¬°DISPARA BALAS! üî´
            if (!e.lastShot) e.lastShot = 0;
            if (Date.now() - e.lastShot > 2500 && Math.random() > 0.85) {
                e.lastShot = Date.now();
                proyectilesEnemigos.push({ x: x, y: y + 20, vx: 0, vy: 5, type: 'bala', angle: 0 });
            }
        }
        
        // MILEI con MOTOSIERRA
        function drawMilei(x, y, e) {
            // Nivel 7+ = Joker (milei.png), niveles 1-6 = Superh√©roe (milei_hero.png)
            var usarJoker = (currentLevel >= 6); // √≠ndice 6 = nivel 7
            var spriteToUse = usarJoker ? sprites.milei : sprites.milei_hero;
            if (spriteToUse) {
                var img = spriteToUse;
                var scale = 1.0;
                ctx.drawImage(img, x - (img.width * scale)/2, y - img.height * scale + 40, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#f5f5f5';
                ctx.fillRect(x - 16, y, 32, 38);
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 8, 14, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(x, y - 12, 15, Math.PI, 2 * Math.PI);
                ctx.fill();
            }
            
            // En niveles altos tira MUCHAS motosierras
            if (!e.lastShot) e.lastShot = 0;
            var cooldown = usarJoker ? 800 : 3000;
            var chance = usarJoker ? 0.5 : 0.95;
            if (Date.now() - e.lastShot > cooldown && Math.random() > chance) {
                e.lastShot = Date.now();
                proyectilesEnemigos.push({ x: x, y: y + 20, vx: 0, vy: 4, type: 'motosierra', angle: 0 });
            }
        }
        
        function drawGordoDan(x, y, e) {
            var periodistas = ['majul', 'feinmann', 'gordo_dan', 'viale', 'trebuc', 'lanata'];
            if (!e) e = {};
            if (e.periodistaIdx === undefined) e.periodistaIdx = Math.floor(Math.abs(x * 7) % 6);
            var nombre = periodistas[e.periodistaIdx];
            if (sprites[nombre]) {
                var img = sprites[nombre];
                ctx.drawImage(img, x - img.width/2, y - img.height + 40, img.width * 1.2, img.height * 1.2);
            } else {
                ctx.fillStyle = '#8B008B';
                ctx.beginPath();
                ctx.ellipse(x, y + 18, 22, 25, 0, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 8, 18, 0, Math.PI * 2);
                ctx.fill();
            }
            // Tirar vasos/cigarrillos
            if (!e.lastShot) e.lastShot = 0;
            if (Date.now() - e.lastShot > 4000 && Math.random() > 0.92) {
                e.lastShot = Date.now();
                proyectilesEnemigos.push({ x: x, y: y + 20, vx: 0, vy: 3, type: Math.random() > 0.5 ? 'vaso' : 'cigarrillo', angle: 0 });
            }
        }
        
        function drawKarina(x, y, e) {
            if (sprites.karina) {
                var img = sprites.karina;
                var scale = 1.0;
                ctx.drawImage(img, x - (img.width * scale)/2, y - img.height * scale + 45, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#1a1a1a';
                ctx.fillRect(x - 14, y, 28, 38);
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 8, 13, 0, Math.PI * 2);
                ctx.fill();
            }
            // Karina tira tortas
            if (!e) e = {};
            if (!e.lastShot) e.lastShot = 0;
            if (Date.now() - e.lastShot > 4000 && Math.random() > 0.92) {
                e.lastShot = Date.now();
                proyectilesEnemigos.push({ x: x, y: y + 20, vx: 0, vy: 3, type: 'torta', angle: 0 });
            }
        }
        
        function drawBullrich(x, y) {
            // Bullrich nazi en niveles 5+ (√≠ndice 4+)
            var spriteToUse = (currentLevel >= 4) ? sprites.bullrich2 : sprites.bullrich;
            if (spriteToUse) {
                var img = spriteToUse;
                var scale = 1.1;
                ctx.drawImage(img, x - (img.width * scale)/2, y - img.height * scale + 45, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#4a4a4a';
                ctx.fillRect(x - 14, y, 28, 36);
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 8, 13, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#C0C0C0';
                ctx.beginPath();
                ctx.arc(x, y - 13, 12, Math.PI, 2 * Math.PI);
                ctx.fill();
            }
        }
        
        // PERRO CLONADO con CACA
        function drawPerroClonado(x, y, e) {
            // Aura
            ctx.strokeStyle = 'rgba(255, 0, 0, 0.4)';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.ellipse(x, y + 8, 30, 22, 0, 0, Math.PI * 2);
            ctx.stroke();
            
            // Cuerpo
            ctx.fillStyle = '#8B7355';
            ctx.beginPath();
            ctx.ellipse(x, y + 10, 22, 14, 0, 0, Math.PI * 2);
            ctx.fill();
            // Cabeza
            ctx.beginPath();
            ctx.ellipse(x + 18, y, 14, 11, 0.2, 0, Math.PI * 2);
            ctx.fill();
            // Hocico
            ctx.fillStyle = '#5C4033';
            ctx.beginPath();
            ctx.ellipse(x + 30, y + 2, 8, 6, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Boca ladrando
            const ladrando = Math.sin(Date.now() / 100) > 0;
            if (ladrando) {
                ctx.fillStyle = '#8B0000';
                ctx.beginPath();
                ctx.ellipse(x + 32, y + 8, 6, 5, 0.2, 0, Math.PI);
                ctx.fill();
                ctx.fillStyle = '#FF6B6B';
                ctx.beginPath();
                ctx.ellipse(x + 34, y + 12, 4, 6, 0.2, 0, Math.PI);
                ctx.fill();
            }
            
            // Ojos rojos
            ctx.fillStyle = '#FF0000';
            ctx.shadowColor = '#FF0000';
            ctx.shadowBlur = 8;
            ctx.beginPath();
            ctx.arc(x + 20, y - 4, 4, 0, Math.PI * 2);
            ctx.arc(x + 12, y - 2, 4, 0, Math.PI * 2);
            ctx.fill();
            ctx.shadowBlur = 0;
            
            // Orejas
            ctx.fillStyle = '#6B5344';
            ctx.beginPath();
            ctx.ellipse(x + 8, y - 8, 6, 10, -0.4, 0, Math.PI * 2);
            ctx.ellipse(x + 25, y - 10, 6, 10, 0.4, 0, Math.PI * 2);
            ctx.fill();
            
            // Patas
            ctx.fillStyle = '#8B7355';
            ctx.fillRect(x - 18, y + 20, 8, 12);
            ctx.fillRect(x - 6, y + 20, 8, 12);
            ctx.fillRect(x + 6, y + 20, 8, 12);
            ctx.fillRect(x + 15, y + 20, 8, 12);
            
            // Cola
            ctx.strokeStyle = '#8B7355';
            ctx.lineWidth = 6;
            ctx.beginPath();
            ctx.moveTo(x - 20, y + 8);
            ctx.quadraticCurveTo(x - 32, y, x - 28, y - 12);
            ctx.stroke();
            
            // ¬°GHUAU!
            if (ladrando) {
                ctx.fillStyle = '#FF0000';
                ctx.font = 'bold 12px Bangers';
                const shake = (Math.random() - 0.5) * 4;
                ctx.fillText('¬°GHUAU!', x + shake, y - 20 + shake);
            }
            
            // Dispara CACA
            if (!e.lastShot) e.lastShot = 0;
            if (Date.now() - e.lastShot > 4000 && Math.random() > 0.957) {
                e.lastShot = Date.now();
                proyectilesEnemigos.push({
                    x: x - 25, y: y + 15,
                    vx: (Math.random() - 0.5) * 2,
                    vy: 3,
                    type: 'caca',
                    angle: 0
                });
            }
        }
        
        function drawPolicia(x, y, e) {
            if (sprites.policia) {
                var img = sprites.policia;
                var scale = 1.0;
                ctx.drawImage(img, x - (img.width * scale)/2, y - img.height * scale + 50, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#1a3a5c';
                ctx.fillRect(x - 14, y, 28, 36);
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 8, 12, 0, Math.PI * 2);
                ctx.fill();
            }
            // Tirar gas lacrim√≥geno
            if (!e) e = {};
            if (!e.lastShot) e.lastShot = 0;
            if (Date.now() - e.lastShot > 4500 && Math.random() > 0.9) {
                e.lastShot = Date.now();
                proyectilesEnemigos.push({ x: x, y: y + 20, vx: 0, vy: 3, type: 'gas', angle: 0 });
            }
        }
        
        // ADORNI (vocero cara de piedra)
        function drawAdorni(x, y) {
            if (sprites.adorni) {
                var img = sprites.adorni;
                var scale = 1.0;
                ctx.drawImage(img, x - (img.width * scale)/2, y - img.height * scale + 45, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#1a1a1a';
                ctx.fillRect(x - 14, y, 28, 38);
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 10, 14, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        // CAPUTO (tipo 4) - Tira d√≥lares
        function drawCaputo(x, y, e) {
            if (sprites.caputo) {
                var img = sprites.caputo;
                var scale = 1.0;
                ctx.drawImage(img, x - (img.width * scale)/2, y - img.height * scale + 45, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#2a2a2a';
                ctx.fillRect(x - 14, y, 28, 38);
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 10, 14, 0, Math.PI * 2);
                ctx.fill();
            }
            // Dispara monedas de oro y d√≥lares
            if (!e.lastShot) e.lastShot = 0;
            if (Date.now() - e.lastShot > 4500 && Math.random() > 0.95) {
                e.lastShot = Date.now();
                // Alterna entre moneda y d√≥lar
                var tipo = Math.random() > 0.5 ? 'moneda' : 'dolar';
                proyectilesEnemigos.push({ x: x - 10, y: y - 20, vx: -1, vy: 2.5, type: tipo, angle: 0 });
                proyectilesEnemigos.push({ x: x + 10, y: y - 20, vx: 1, vy: 2.5, type: tipo === 'moneda' ? 'dolar' : 'moneda', angle: 0 });
            }
        }
        
        // TRUMP Y MILEI RECI√âN CASADOS üíí
        function drawTrumpMileiCasados(x, y, e) {
            // Siempre usa trump_milei (la correa)
            var spriteToUse = sprites.trump_milei;
            
            if (spriteToUse) {
                var img = spriteToUse;
                var scale = 1.0;
                ctx.drawImage(img, x - (img.width * scale)/2, y - img.height * scale + 50, img.width * scale, img.height * scale);
            } else {
                // Fallback geom√©trico simple
                ctx.fillStyle = '#1a1a1a';
                ctx.fillRect(x - 25, y, 50, 50);
                ctx.fillStyle = '#FFB366';
                ctx.beginPath();
                ctx.arc(x, y - 10, 15, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // Corazones
            ctx.fillStyle = '#FF69B4';
            const heartY = y - 45 + Math.sin(Date.now() / 300) * 5;
            ctx.font = '14px Arial';
            ctx.fillText('üíï', x - 5, heartY);
            
            // *** DISPARAN BANDERAS DE EEUU ***
            if (!e.lastShot) e.lastShot = 0;
            var cooldown = (currentLevel === 9) ? 1000 : 2000;
            if (Date.now() - e.lastShot > cooldown && Math.random() > 0.8) {
                e.lastShot = Date.now();
                proyectilesEnemigos.push({
                    x: x + 15,
                    y: y + 20,
                    vx: (Math.random() - 0.5) * 3,
                    vy: 3.5,
                    type: 'bandera_usa',
                    angle: 0
                });
            }
        }
        
        // STURZENEGGER (pelado de desregulaci√≥n)
        // CAPUTO (tipo 7) - Ministro de Econom√≠a - Tira motosierras
        function drawSturzenegger(x, y, e) {
            if (sprites.sturzenegger) {
                var img = sprites.sturzenegger;
                var scale = 1.0;
                ctx.drawImage(img, x - (img.width * scale)/2, y - img.height * scale + 45, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#2a2a2a';
                ctx.fillRect(x - 14, y, 28, 38);
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(x, y - 10, 15, 0, Math.PI * 2);
                ctx.fill();
            }
            // Caputo tira motosierras
            if (!e) e = {};
            if (!e.lastShot) e.lastShot = 0;
            if (Date.now() - e.lastShot > 4500 && Math.random() > 0.93) {
                e.lastShot = Date.now();
                proyectilesEnemigos.push({ x: x, y: y + 20, vx: 0, vy: 4, type: 'motosierra', angle: 0 });
            }
        }
        
        // MACRI (tipo 9) - Tira globos amarillos
        function drawMacri(x, y, e) {
            if (sprites.macri) {
                var img = sprites.macri;
                var scale = 1.1;
                ctx.drawImage(img, x - (img.width * scale)/2, y - img.height * scale + 45, img.width * scale, img.height * scale);
            } else {
                ctx.fillStyle = '#1a3a5c';
                ctx.fillRect(x - 15, y, 30, 40);
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.ellipse(x, y - 12, 15, 17, 0, 0, Math.PI * 2);
                ctx.fill();
            }
            // Dispara globos
            if (!e.lastShot) e.lastShot = 0;
            if (Date.now() - e.lastShot > 4500 && Math.random() > 0.96) {
                e.lastShot = Date.now();
                proyectilesEnemigos.push({ x: x, y: y - 20, vx: 0, vy: 2.5, type: 'globo', angle: 0 });
            }
        }
        
        // POTOBELLOCCHIA SAPO (tipo 11)
        function drawPotobellocchia(x, y, e) {
            if (sprites.potobellocchia) {
                var img = sprites.potobellocchia;
                var scale = 1.1;
                ctx.drawImage(img, x - (img.width * scale)/2, y - img.height * scale + 50, img.width * scale, img.height * scale);
            } else {
                // Fallback sapo
                ctx.fillStyle = '#556B2F';
                ctx.beginPath();
                ctx.ellipse(x, y, 25, 18, 0, 0, Math.PI * 2);
                ctx.fill();
            }
            // Tira comida
            if (!e.lastShot) e.lastShot = 0;
            if (Date.now() - e.lastShot > 4500 && Math.random() > 0.95) {
                e.lastShot = Date.now();
                // Comida random: hamburguesa, pizza, helado
                const comidas = ['hamburguesa', 'pizza', 'helado'];
                const comida = comidas[Math.floor(Math.random() * comidas.length)];
                proyectilesEnemigos.push({ 
                    x: x, 
                    y: y - 20, 
                    vx: (Math.random() - 0.5) * 3, 
                    vy: 2.5, 
                    type: comida, 
                    angle: 0 
                });
            }
        }
        
        // VILLARRUEL (tipo 10)
        function drawVillarruel(x, y) {
            // Cuerpo con traje oscuro
            ctx.fillStyle = '#2a2a2a';
            ctx.fillRect(x - 13, y, 26, 38);
            // Collar de perlas
            ctx.fillStyle = '#fff';
            for (let i = 0; i < 5; i++) {
                ctx.beginPath();
                ctx.arc(x - 6 + i * 3, y + 4, 2, 0, Math.PI * 2);
                ctx.fill();
            }
            // Cabeza
            ctx.fillStyle = '#DEB887';
            ctx.beginPath();
            ctx.ellipse(x, y - 12, 13, 15, 0, 0, Math.PI * 2);
            ctx.fill();
            // Pelo negro largo
            ctx.fillStyle = '#1a1a1a';
            ctx.beginPath();
            ctx.moveTo(x - 15, y - 5);
            ctx.quadraticCurveTo(x - 16, y - 25, x, y - 28);
            ctx.quadraticCurveTo(x + 16, y - 25, x + 15, y - 5);
            ctx.lineTo(x + 13, y + 15);
            ctx.lineTo(x - 13, y + 15);
            ctx.closePath();
            ctx.fill();
            // Cejas finas
            ctx.strokeStyle = '#1a1a1a';
            ctx.lineWidth = 1.5;
            ctx.beginPath();
            ctx.arc(x - 5, y - 18, 4, Math.PI * 1.2, Math.PI * 1.8);
            ctx.stroke();
            ctx.beginPath();
            ctx.arc(x + 5, y - 18, 4, Math.PI * 1.2, Math.PI * 1.8);
            ctx.stroke();
            // Ojos
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.ellipse(x - 5, y - 12, 4, 5, 0, 0, Math.PI * 2);
            ctx.ellipse(x + 5, y - 12, 4, 5, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#3d2314';
            ctx.beginPath();
            ctx.arc(x - 5, y - 12, 2, 0, Math.PI * 2);
            ctx.arc(x + 5, y - 12, 2, 0, Math.PI * 2);
            ctx.fill();
            // Labios
            ctx.fillStyle = '#8B0000';
            ctx.beginPath();
            ctx.ellipse(x, y - 1, 5, 2, 0, 0, Math.PI * 2);
            ctx.fill();
            // Texto
            if (Math.random() > 0.97) {
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 6px Arial';
                ctx.fillText('¬°ZURDOS!', x, y - 35);
            }
        }
        
        // ESPERT (tipo 11) - Con mo√±o
        
        // MILEI GIGANTE (tipo 12) - JEFE FINAL
        function drawMileiGigante(x, y, e) {
            // Cuerpo GIGANTE con campera
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(x - 40, y, 80, 80);
            // Cierre
            ctx.strokeStyle = '#C0C0C0';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x, y + 75);
            ctx.stroke();
            // Cabeza ENORME
            ctx.fillStyle = '#DEB887';
            ctx.beginPath();
            ctx.arc(x, y - 30, 40, 0, Math.PI * 2);
            ctx.fill();
            // Patillas ENORMES
            ctx.fillStyle = '#3a3a3a';
            ctx.fillRect(x - 42, y - 50, 12, 45);
            ctx.fillRect(x + 30, y - 50, 12, 45);
            // Peluca GIGANTE y LOCA
            ctx.fillStyle = '#3a3a3a';
            for (let i = -5; i <= 5; i++) {
                const sway = Math.sin(Date.now() / 150 + i) * 10;
                ctx.beginPath();
                ctx.moveTo(x + i * 7, y - 60);
                ctx.quadraticCurveTo(x + i * 10 + sway, y - 100, x + i * 8 + sway, y - 120);
                ctx.lineWidth = 8;
                ctx.strokeStyle = '#3a3a3a';
                ctx.stroke();
            }
            // Ojos LOCOS
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(x - 15, y - 35, 12, 0, Math.PI * 2);
            ctx.arc(x + 15, y - 35, 12, 0, Math.PI * 2);
            ctx.fill();
            // Pupilas que se mueven
            const eyeX = Math.sin(Date.now() / 100) * 5;
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(x - 15 + eyeX, y - 35, 6, 0, Math.PI * 2);
            ctx.arc(x + 15 + eyeX, y - 35, 6, 0, Math.PI * 2);
            ctx.fill();
            // Boca gritando
            ctx.fillStyle = '#8B0000';
            ctx.beginPath();
            ctx.ellipse(x, y - 10, 20, 12, 0, 0, Math.PI);
            ctx.fill();
            ctx.fillStyle = '#fff';
            ctx.fillRect(x - 15, y - 10, 30, 6);
            // Motosierras en las manos
            ctx.fillStyle = '#FF4500';
            ctx.fillRect(x - 70, y + 30, 25, 45);
            ctx.fillStyle = '#C0C0C0';
            ctx.fillRect(x - 65, y, 15, 35);
            ctx.fillStyle = '#FF4500';
            ctx.fillRect(x + 45, y + 30, 25, 45);
            ctx.fillStyle = '#C0C0C0';
            ctx.fillRect(x + 50, y, 15, 35);
            // Barra de vida
            const maxHP = 50;
            const hpPercent = e.hp / maxHP;
            ctx.fillStyle = '#333';
            ctx.fillRect(x - 50, y - 140, 100, 12);
            ctx.fillStyle = hpPercent > 0.5 ? '#00FF00' : hpPercent > 0.25 ? '#FFD700' : '#FF0000';
            ctx.fillRect(x - 48, y - 138, 96 * hpPercent, 8);
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 10px Arial';
            ctx.fillText('MILEI GIGANTE', x, y - 145);
            // Dispara muchas motosierras
            if (!e.lastShot) e.lastShot = 0;
            if (Date.now() - e.lastShot > 2000) {
                e.lastShot = Date.now();
                for (let i = -1; i <= 1; i++) {
                    proyectilesEnemigos.push({
                        x: x + i * 40,
                        y: y + 70,
                        vx: i * 2,
                        vy: 4,
                        type: 'motosierra',
                        angle: 0
                    });
                }
            }
            // Grita
            if (Math.random() > 0.96) {
                ctx.fillStyle = '#FF0000';
                ctx.font = 'bold 16px Bangers';
                ctx.fillText('¬°¬°VIVA LA LIBERTAD!!', x, y - 160);
            }
        }
        
        // DIBUJAR PROYECTILES ENEMIGOS
        function drawProyectilEnemigo(p) {
            if (p.type === 'caca') {
                // üí© Caca
                ctx.fillStyle = '#8B4513';
                ctx.beginPath();
                ctx.arc(p.x, p.y, 8, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(p.x - 3, p.y - 6, 5, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(p.x + 2, p.y - 10, 4, 0, Math.PI * 2);
                ctx.fill();
                // Moscas
                ctx.fillStyle = '#000';
                const t = Date.now() / 100;
                ctx.beginPath();
                ctx.arc(p.x + Math.cos(t) * 12, p.y + Math.sin(t) * 8, 2, 0, Math.PI * 2);
                ctx.arc(p.x + Math.cos(t + 2) * 10, p.y + Math.sin(t + 2) * 10, 2, 0, Math.PI * 2);
                ctx.fill();
            } else if (p.type === 'motosierra') {
                // ü™ö Motosierra voladora
                p.angle += 0.3;
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.angle);
                if (sprites.motosierra) {
                    ctx.drawImage(sprites.motosierra, -22, -20, 45, 40);
                } else {
                    ctx.fillStyle = '#FF4500';
                    ctx.fillRect(-6, -3, 12, 18);
                    ctx.fillStyle = '#C0C0C0';
                    ctx.fillRect(-3, -18, 6, 18);
                }
                ctx.restore();
            } else if (p.type === 'bandera_usa') {
                // üá∫üá∏ BANDERA DE ESTADOS UNIDOS
                p.angle += 0.15; // Gira mientras vuela
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.angle);
                
                // Asta de la bandera
                ctx.fillStyle = '#8B4513';
                ctx.fillRect(-2, 8, 4, 20);
                
                // Bandera ondeando
                const wave = Math.sin(Date.now() / 100) * 2;
                
                // Fondo rojo y blanco (rayas)
                for (let i = 0; i < 7; i++) {
                    ctx.fillStyle = i % 2 === 0 ? '#B22234' : '#fff';
                    ctx.fillRect(-18 + wave, -12 + i * 3, 36, 3);
                }
                
                // Cuadrado azul con estrellas
                ctx.fillStyle = '#3C3B6E';
                ctx.fillRect(-18 + wave, -12, 14, 12);
                
                // Estrellas (simplificadas)
                ctx.fillStyle = '#fff';
                ctx.font = '4px Arial';
                for (let row = 0; row < 3; row++) {
                    for (let col = 0; col < 3; col++) {
                        ctx.beginPath();
                        ctx.arc(-15 + wave + col * 4, -9 + row * 4, 1.5, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
                
                // Borde
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 1;
                ctx.strokeRect(-18 + wave, -12, 36, 21);
                
                ctx.restore();
                
                // Texto "USA!" ocasional
                if (Math.random() > 0.95) {
                    ctx.fillStyle = '#B22234';
                    ctx.font = 'bold 8px Arial';
                    ctx.fillText('USA!', p.x, p.y - 20);
                }
            } else if (p.type === 'globo') {
                // üéà Globo amarillo de Macri
                ctx.beginPath();
                ctx.ellipse(p.x, p.y, 12, 15, 0, 0, Math.PI * 2);
            } else if (p.type === 'bala') {
                // üî´ Bala de Espert
                ctx.fillStyle = '#FFD700';
                ctx.beginPath();
                ctx.ellipse(p.x, p.y, 4, 8, 0, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#8B4513';
                ctx.fillRect(p.x - 3, p.y + 5, 6, 4);
            } else if (p.type === 'grafico') {
                // üìà Gr√°fico econ√≥mico de Espert
                ctx.save();
                ctx.translate(p.x, p.y);
                p.angle += 0.1;
                ctx.rotate(p.angle);
                
                // Fondo blanco del gr√°fico
                ctx.fillStyle = '#fff';
                ctx.fillRect(-15, -12, 30, 24);
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 1;
                ctx.strokeRect(-15, -12, 30, 24);
                
                // L√≠nea del gr√°fico (bajando - econom√≠a en ca√≠da)
                ctx.strokeStyle = '#F44336';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(-12, -8);
                ctx.lineTo(-4, -2);
                ctx.lineTo(4, 6);
                ctx.lineTo(12, 10);
                ctx.stroke();
                
                // Flecha hacia abajo
                ctx.fillStyle = '#F44336';
                ctx.beginPath();
                ctx.moveTo(12, 10);
                ctx.lineTo(8, 6);
                ctx.lineTo(10, 8);
                ctx.fill();
                
                ctx.restore();
                ctx.fill();
                ctx.fillStyle = 'rgba(255,255,255,0.4)';
                ctx.beginPath();
                ctx.ellipse(p.x - 4, p.y - 5, 4, 6, -0.3, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#B8860B';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(p.x, p.y + 15);
                ctx.quadraticCurveTo(p.x + 3, p.y + 25, p.x, p.y + 30);
                ctx.stroke();
                ctx.fillStyle = '#000';
                ctx.font = 'bold 8px Arial';
                ctx.fillText('PRO', p.x, p.y + 3);
            } else if (p.type === 'vaso') {
                // ü•É Vaso de whisky
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.fillStyle = 'rgba(200, 200, 255, 0.7)';
                ctx.beginPath();
                ctx.moveTo(-8, -10);
                ctx.lineTo(-6, 10);
                ctx.lineTo(6, 10);
                ctx.lineTo(8, -10);
                ctx.closePath();
                ctx.fill();
                ctx.strokeStyle = '#666';
                ctx.lineWidth = 1;
                ctx.stroke();
                ctx.fillStyle = '#D2691E';
                ctx.beginPath();
                ctx.moveTo(-6, 0);
                ctx.lineTo(-5, 8);
                ctx.lineTo(5, 8);
                ctx.lineTo(6, 0);
                ctx.closePath();
                ctx.fill();
                ctx.restore();
            } else if (p.type === 'cigarrillo') {
                // üö¨ Cigarrillo
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.fillStyle = '#D2691E';
                ctx.fillRect(-12, -3, 8, 6);
                ctx.fillStyle = '#F5F5DC';
                ctx.fillRect(-4, -3, 14, 6);
                ctx.fillStyle = '#FF4500';
                ctx.beginPath();
                ctx.arc(10, 0, 3, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = 'rgba(150, 150, 150, 0.5)';
                var t = Date.now() / 200;
                ctx.beginPath();
                ctx.arc(14 + Math.sin(t) * 3, -5 + Math.cos(t) * 2, 4, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            } else if (p.type === 'gas') {
                // üí® Gas lacrim√≥geno
                ctx.save();
                ctx.translate(p.x, p.y);
                // Lata
                ctx.fillStyle = '#444';
                ctx.fillRect(-6, -8, 12, 16);
                // Humo
                ctx.fillStyle = 'rgba(200, 200, 100, 0.6)';
                var t = Date.now() / 150;
                for (var i = 0; i < 3; i++) {
                    ctx.beginPath();
                    ctx.arc(Math.sin(t + i) * 8, -12 - i * 6, 8 + i * 3, 0, Math.PI * 2);
                    ctx.fill();
                }
                ctx.restore();
            } else if (p.type === 'torta') {
                // üéÇ Torta de Karina
                if (sprites.torta) {
                    ctx.drawImage(sprites.torta, p.x - 13, p.y - 17, 26, 35);
                } else {
                    ctx.fillStyle = '#F5DEB3';
                    ctx.fillRect(p.x - 12, p.y - 8, 24, 16);
                    ctx.fillStyle = '#8B4513';
                    ctx.fillRect(p.x - 12, p.y - 12, 24, 4);
                    ctx.fillStyle = '#FF69B4';
                    ctx.beginPath();
                    ctx.arc(p.x, p.y - 14, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
            } else if (p.type === 'moneda') {
                // ü™ô Moneda de oro
                p.angle = (p.angle || 0) + 0.2;
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.angle);
                // Moneda dorada
                ctx.fillStyle = '#FFD700';
                ctx.beginPath();
                ctx.arc(0, 0, 10, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#DAA520';
                ctx.lineWidth = 2;
                ctx.stroke();
                // Signo $
                ctx.fillStyle = '#B8860B';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('$', 0, 4);
                ctx.restore();
            } else if (p.type === 'dolar') {
                // üíµ Billete de d√≥lar
                p.angle = (p.angle || 0) + 0.1;
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(Math.sin(p.angle) * 0.3);
                // Billete verde
                ctx.fillStyle = '#228B22';
                ctx.fillRect(-15, -8, 30, 16);
                ctx.strokeStyle = '#006400';
                ctx.lineWidth = 1;
                ctx.strokeRect(-15, -8, 30, 16);
                // Texto USD
                ctx.fillStyle = '#90EE90';
                ctx.font = 'bold 8px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('USD', 0, 3);
                ctx.restore();
            } else if (p.type === 'hamburguesa') {
                // üçî Hamburguesa
                ctx.save();
                ctx.translate(p.x, p.y);
                // Pan arriba
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(0, -5, 12, Math.PI, 0);
                ctx.fill();
                // Semillas
                ctx.fillStyle = '#FFF8DC';
                ctx.beginPath();
                ctx.arc(-4, -8, 2, 0, Math.PI * 2);
                ctx.arc(4, -9, 2, 0, Math.PI * 2);
                ctx.fill();
                // Lechuga
                ctx.fillStyle = '#32CD32';
                ctx.fillRect(-11, -3, 22, 3);
                // Carne
                ctx.fillStyle = '#8B4513';
                ctx.fillRect(-10, 0, 20, 5);
                // Queso
                ctx.fillStyle = '#FFD700';
                ctx.fillRect(-9, 5, 18, 3);
                // Pan abajo
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.arc(0, 8, 11, 0, Math.PI);
                ctx.fill();
                ctx.restore();
            } else if (p.type === 'pizza') {
                // üçï Pizza
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.angle || 0);
                p.angle = (p.angle || 0) + 0.1;
                // Masa
                ctx.fillStyle = '#F4A460';
                ctx.beginPath();
                ctx.moveTo(0, -12);
                ctx.lineTo(-10, 10);
                ctx.lineTo(10, 10);
                ctx.closePath();
                ctx.fill();
                // Salsa
                ctx.fillStyle = '#FF6347';
                ctx.beginPath();
                ctx.moveTo(0, -8);
                ctx.lineTo(-7, 7);
                ctx.lineTo(7, 7);
                ctx.closePath();
                ctx.fill();
                // Queso
                ctx.fillStyle = '#FFFACD';
                ctx.beginPath();
                ctx.arc(-2, 0, 4, 0, Math.PI * 2);
                ctx.arc(3, 3, 3, 0, Math.PI * 2);
                ctx.fill();
                // Pepperoni
                ctx.fillStyle = '#DC143C';
                ctx.beginPath();
                ctx.arc(0, -2, 3, 0, Math.PI * 2);
                ctx.arc(-3, 4, 2, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            } else if (p.type === 'helado') {
                // üç¶ Helado
                ctx.save();
                ctx.translate(p.x, p.y);
                // Cono
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.moveTo(-8, 0);
                ctx.lineTo(0, 15);
                ctx.lineTo(8, 0);
                ctx.closePath();
                ctx.fill();
                // Patr√≥n del cono
                ctx.strokeStyle = '#D2691E';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(-6, 2);
                ctx.lineTo(2, 12);
                ctx.moveTo(6, 2);
                ctx.lineTo(-2, 12);
                ctx.stroke();
                // Bola rosa
                ctx.fillStyle = '#FFB6C1';
                ctx.beginPath();
                ctx.arc(0, -5, 9, 0, Math.PI * 2);
                ctx.fill();
                // Bola chocolate
                ctx.fillStyle = '#8B4513';
                ctx.beginPath();
                ctx.arc(0, -13, 7, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            }
        }
        
        // DIBUJAR PROYECTILES DE ALIADOS (pa√±uelo, cruz, choripan)
        function drawProyectilAliado(emp) {
            ctx.save();
            ctx.translate(emp.x, emp.y);
            ctx.rotate(emp.angle || 0);
            
            if (emp.type === 'panuelo') {
                // üßï Pa√±uelo blanco de Hebe
                ctx.fillStyle = '#FFFFFF';
                ctx.beginPath();
                ctx.moveTo(0, -12);
                ctx.quadraticCurveTo(15, -5, 12, 8);
                ctx.quadraticCurveTo(0, 15, -12, 8);
                ctx.quadraticCurveTo(-15, -5, 0, -12);
                ctx.fill();
                ctx.strokeStyle = '#ddd';
                ctx.lineWidth = 1;
                ctx.stroke();
            } else if (emp.type === 'cruz') {
                // ‚úùÔ∏è Cruz del Papa
                ctx.fillStyle = '#FFD700';
                ctx.fillRect(-3, -15, 6, 30);
                ctx.fillRect(-10, -8, 20, 6);
                ctx.strokeStyle = '#DAA520';
                ctx.lineWidth = 1;
                ctx.strokeRect(-3, -15, 6, 30);
                ctx.strokeRect(-10, -8, 20, 6);
            } else if (emp.type === 'choripan') {
                // ü•ñ Chorip√°n
                ctx.fillStyle = '#D2691E';
                ctx.beginPath();
                ctx.ellipse(0, 0, 12, 6, 0, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#8B4513';
                ctx.beginPath();
                ctx.ellipse(0, 0, 10, 3, 0, 0, Math.PI * 2);
                ctx.fill();
            }
            
            ctx.restore();
        }
        
        // EMPANADA o SANGUCHE DE MILANESA
        function drawEmpanada(emp) {
            // Proyectiles especiales
            if (emp.type === 'panuelo' || emp.type === 'cruz' || emp.type === 'choripan') {
                drawProyectilAliado(emp);
                return;
            }
            
            // PIEDRA
            if (emp.type === 'piedra') {
                ctx.save();
                ctx.translate(emp.x, emp.y);
                ctx.rotate(emp.angle);
                ctx.fillStyle = '#696969';
                ctx.beginPath();
                ctx.ellipse(0, 0, 10, 8, 0, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#808080';
                ctx.beginPath();
                ctx.ellipse(-3, -2, 4, 3, 0, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
                return;
            }
            
            // CORAZ√ìN DE EVITA (paraliza con efecto hielo)
            if (emp.type === 'corazon' || emp.type === 'corazon_evita') {
                ctx.save();
                ctx.translate(emp.x, emp.y);
                // Coraz√≥n rosa
                ctx.fillStyle = '#FF69B4';
                ctx.beginPath();
                ctx.moveTo(0, 4);
                ctx.bezierCurveTo(-8, -4, -8, -12, 0, -8);
                ctx.bezierCurveTo(8, -12, 8, -4, 0, 4);
                ctx.fill();
                // Brillo
                ctx.fillStyle = 'rgba(255,255,255,0.6)';
                ctx.beginPath();
                ctx.arc(-3, -6, 2, 0, Math.PI * 2);
                ctx.fill();
                // Aura de hielo
                ctx.strokeStyle = 'rgba(135, 206, 235, 0.7)';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(0, -2, 12, 0, Math.PI * 2);
                ctx.stroke();
                ctx.restore();
                return;
            }
            
            // BR√ìCOLI
            if (emp.type === 'brocoli') {
                ctx.save();
                ctx.translate(emp.x, emp.y);
                ctx.rotate(emp.angle);
                // Tallo
                ctx.fillStyle = '#228B22';
                ctx.fillRect(-3, 0, 6, 10);
                // Cabeza
                ctx.fillStyle = '#006400';
                ctx.beginPath();
                ctx.arc(-5, -2, 6, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(5, -2, 6, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(0, -5, 7, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
                return;
            }
            
            // FERNET
            if (emp.type === 'fernet') {
                ctx.save();
                ctx.translate(emp.x, emp.y);
                ctx.rotate(emp.angle);
                // Botella
                ctx.fillStyle = '#1a1a1a';
                ctx.fillRect(-5, -8, 10, 20);
                // Cuello
                ctx.fillRect(-3, -14, 6, 6);
                // Etiqueta
                ctx.fillStyle = '#8B0000';
                ctx.fillRect(-4, -4, 8, 10);
                // Tapa
                ctx.fillStyle = '#FFD700';
                ctx.fillRect(-2, -16, 4, 3);
                ctx.restore();
                return;
            }
            
            // CONSTITUCI√ìN
            if (emp.type === 'constitucion') {
                ctx.save();
                ctx.translate(emp.x, emp.y);
                ctx.rotate(emp.angle);
                // Libro
                ctx.fillStyle = '#8B0000';
                ctx.fillRect(-8, -10, 16, 20);
                // P√°ginas
                ctx.fillStyle = '#FFF8DC';
                ctx.fillRect(-6, -8, 12, 16);
                // Texto
                ctx.fillStyle = '#1a1a1a';
                ctx.font = '6px Arial';
                ctx.fillText('CN', -4, 2);
                // Cinta marcador
                ctx.fillStyle = '#75AADB';
                ctx.fillRect(4, -10, 2, 25);
                ctx.restore();
                return;
            }
            
            if (emp.isSanguche) {
                // === SANGUCHE DE MILANESA ===
                ctx.save();
                ctx.translate(emp.x, emp.y);
                ctx.rotate(emp.angle);
                
                // Pan de abajo
                ctx.fillStyle = '#D2691E';
                ctx.beginPath();
                ctx.ellipse(0, 3, 14, 6, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Milanesa (sobresale)
                ctx.fillStyle = '#8B4513';
                ctx.beginPath();
                ctx.ellipse(0, 0, 16, 5, 0, 0, Math.PI * 2);
                ctx.fill();
                // Borde crocante de la milanesa
                ctx.strokeStyle = '#654321';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // Lechuga que sobresale
                ctx.fillStyle = '#228B22';
                ctx.beginPath();
                ctx.ellipse(-8, -1, 5, 3, 0.3, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.ellipse(8, 0, 5, 3, -0.3, 0, Math.PI * 2);
                ctx.fill();
                
                // Tomate
                ctx.fillStyle = '#DC143C';
                ctx.beginPath();
                ctx.arc(0, -2, 4, 0, Math.PI * 2);
                ctx.fill();
                
                // Pan de arriba
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.ellipse(0, -4, 13, 5, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Semillas de s√©samo
                ctx.fillStyle = '#FFE4B5';
                ctx.beginPath();
                ctx.ellipse(-5, -6, 2, 1, 0.3, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.ellipse(3, -7, 2, 1, -0.2, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.ellipse(0, -8, 2, 1, 0, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.restore();
                
                // Efecto de poder (brillo naranja)
                ctx.fillStyle = 'rgba(255, 165, 0, 0.4)';
                ctx.beginPath();
                ctx.arc(emp.x, emp.y, 18, 0, Math.PI * 2);
                ctx.fill();
                
            } else if (emp.type === 'choripan') {
                // === CHORIPAN ===
                ctx.save();
                ctx.translate(emp.x, emp.y);
                ctx.rotate(emp.angle);
                
                // Pan
                ctx.fillStyle = '#DEB887';
                ctx.beginPath();
                ctx.ellipse(0, 0, 14, 6, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Chorizo
                ctx.fillStyle = '#8B4513';
                ctx.beginPath();
                ctx.ellipse(0, -1, 12, 4, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Marcas del chorizo
                ctx.strokeStyle = '#5D3A1A';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(-8, -1);
                ctx.lineTo(-8, 1);
                ctx.moveTo(-4, -2);
                ctx.lineTo(-4, 0);
                ctx.moveTo(0, -1);
                ctx.lineTo(0, 1);
                ctx.moveTo(4, -2);
                ctx.lineTo(4, 0);
                ctx.moveTo(8, -1);
                ctx.lineTo(8, 1);
                ctx.stroke();
                
                // Chimichurri
                ctx.fillStyle = '#228B22';
                ctx.fillRect(-6, -3, 3, 2);
                ctx.fillRect(2, -3, 3, 2);
                
                ctx.restore();
            } else {
                // === EMPANADA NORMAL ===
                ctx.fillStyle = emp.color || '#DAA520';
                ctx.beginPath();
                ctx.ellipse(emp.x, emp.y, 10, 7, emp.angle, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#654321';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.ellipse(emp.x, emp.y, 10, 7, emp.angle, 0, Math.PI);
                ctx.stroke();
                if (emp.effect === 'destroza') {
                    ctx.fillStyle = 'rgba(255, 100, 0, 0.7)';
                    for (let i = 0; i < 3; i++) {
                        ctx.beginPath();
                        ctx.arc(emp.x + Math.random()*12 - 6, emp.y + Math.random()*12 - 6, 4, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
                if (emp.effect === 'paraliza') {
                    ctx.fillStyle = 'rgba(255, 215, 0, 0.4)';
                    ctx.beginPath();
                    ctx.ellipse(emp.x, emp.y, 14, 10, emp.angle, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
        }
        
        // PELOTA
        function drawPelota(p) {
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(p.x, p.y, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(p.x, p.y, 8, p.angle, p.angle + Math.PI * 0.4);
            ctx.lineTo(p.x, p.y);
            ctx.fill();
        }
        
        // PART√çCULAS
        function drawParticles() {
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.life--;
                
                if (p.type === 'ring') {
                    // Anillo expandi√©ndose
                    p.size += 3;
                    ctx.strokeStyle = p.color;
                    ctx.lineWidth = 3;
                    ctx.globalAlpha = p.life / 12;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    ctx.stroke();
                } else if (p.type === 'spark') {
                    // Chispa con trail
                    p.vy += 0.1;
                    ctx.fillStyle = p.color;
                    ctx.globalAlpha = p.life / 15;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    ctx.fill();
                    // L√≠nea de trail
                    ctx.strokeStyle = p.color;
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(p.x, p.y);
                    ctx.lineTo(p.x - p.vx * 2, p.y - p.vy * 2);
                    ctx.stroke();
                } else {
                    // Part√≠cula normal
                    p.vy += 0.15;
                    ctx.fillStyle = p.color;
                    ctx.globalAlpha = p.life / 25;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                ctx.globalAlpha = 1;
                if (p.life <= 0) particles.splice(i, 1);
            }
        }
        
        function explode(x, y, color, silent) {
            if (!silent) playSound('gorila');
            // Part√≠culas principales
            for (let i = 0; i < 10; i++) {
                const angle = (Math.PI * 2 / 10) * i;
                const speed = 3 + Math.random() * 3;
                particles.push({
                    x, y,
                    vx: Math.cos(angle) * speed,
                    vy: Math.sin(angle) * speed,
                    size: Math.random() * 4 + 3,
                    color,
                    life: 25,
                    type: 'normal'
                });
            }
            // Chispas peque√±as
            for (let i = 0; i < 8; i++) {
                particles.push({
                    x, y,
                    vx: (Math.random() - 0.5) * 8,
                    vy: (Math.random() - 0.5) * 8,
                    size: Math.random() * 2 + 1,
                    color: '#FFD700',
                    life: 15,
                    type: 'spark'
                });
            }
            // Anillo de explosi√≥n
            particles.push({
                x, y,
                vx: 0, vy: 0,
                size: 5,
                color: color,
                life: 12,
                type: 'ring'
            });
        }
        
        // *** CONFETTI PARA VICTORIA ***
        function spawnConfetti() {
            const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD', '#98D8C8', '#F7DC6F'];
            for (let i = 0; i < 50; i++) {
                confetti.push({
                    x: Math.random() * canvas.width,
                    y: -20 - Math.random() * 100,
                    vx: (Math.random() - 0.5) * 3,
                    vy: Math.random() * 2 + 1,
                    size: Math.random() * 8 + 4,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    rotation: Math.random() * Math.PI * 2,
                    rotSpeed: (Math.random() - 0.5) * 0.2
                });
            }
        }
        
        // *** FUEGOS ARTIFICIALES ***
        function spawnFirework() {
            const x = Math.random() * canvas.width;
            const y = Math.random() * (canvas.height * 0.4) + 50;
            const colors = ['#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#FF00FF', '#00FFFF', '#FFD700'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            for (let i = 0; i < 20; i++) {
                const angle = (Math.PI * 2 / 20) * i;
                const speed = 2 + Math.random() * 2;
                fireworks.push({
                    x, y,
                    vx: Math.cos(angle) * speed,
                    vy: Math.sin(angle) * speed,
                    size: 3,
                    color,
                    life: 40,
                    trail: []
                });
            }
            playSound('explosion');
        }
        
        // *** ACTUALIZAR EFECTOS DE VICTORIA ***
        function updateVictoryEffects() {
            // Confetti
            for (let i = confetti.length - 1; i >= 0; i--) {
                const c = confetti[i];
                c.x += c.vx;
                c.y += c.vy;
                c.rotation += c.rotSpeed;
                c.vx += (Math.random() - 0.5) * 0.1; // Movimiento ondulante
                if (c.y > canvas.height + 20) {
                    confetti.splice(i, 1);
                }
            }
            
            // Fireworks
            for (let i = fireworks.length - 1; i >= 0; i--) {
                const f = fireworks[i];
                f.trail.push({ x: f.x, y: f.y });
                if (f.trail.length > 5) f.trail.shift();
                f.x += f.vx;
                f.y += f.vy;
                f.vy += 0.05; // Gravedad
                f.life--;
                f.size *= 0.98;
                if (f.life <= 0) {
                    fireworks.splice(i, 1);
                }
            }
        }
        
        // *** DIBUJAR EFECTOS DE VICTORIA ***
        function drawVictoryEffects() {
            // Dibujar confetti
            confetti.forEach(c => {
                ctx.save();
                ctx.translate(c.x, c.y);
                ctx.rotate(c.rotation);
                ctx.fillStyle = c.color;
                ctx.fillRect(-c.size/2, -c.size/4, c.size, c.size/2);
                ctx.restore();
            });
            
            // Dibujar fireworks con trail
            fireworks.forEach(f => {
                // Trail
                f.trail.forEach((t, i) => {
                    ctx.globalAlpha = i / f.trail.length * 0.5;
                    ctx.fillStyle = f.color;
                    ctx.beginPath();
                    ctx.arc(t.x, t.y, f.size * (i / f.trail.length), 0, Math.PI * 2);
                    ctx.fill();
                });
                ctx.globalAlpha = 1;
                // Part√≠cula principal
                ctx.fillStyle = f.color;
                ctx.beginPath();
                ctx.arc(f.x, f.y, f.size, 0, Math.PI * 2);
                ctx.fill();
                // Brillo
                ctx.fillStyle = '#FFF';
                ctx.beginPath();
                ctx.arc(f.x, f.y, f.size * 0.5, 0, Math.PI * 2);
                ctx.fill();
            });
        }
        
        // SPAWN ENEMIGO
        function spawnEnemy() {
            const level = LEVELS[currentLevel];
            const types = level.enemyTypes;
            const type = types[Math.floor(Math.random() * types.length)];
            const diffMult = difficultyMultipliers[difficulty];
            
            if (type === 3) {
                // Bullrich con polic√≠as
                enemies.push({ x: canvas.width / 2, y: -50, speed: (0.5 + currentWave * 0.05) * diffMult.enemySpeed, type: 3, hp: Math.ceil(3 * diffMult.enemyHP) });
                enemies.push({ x: canvas.width / 2 - 45, y: -60, speed: (0.5 + currentWave * 0.05) * diffMult.enemySpeed, type: 5, hp: Math.ceil(2 * diffMult.enemyHP) });
                enemies.push({ x: canvas.width / 2 + 45, y: -60, speed: (0.5 + currentWave * 0.05) * diffMult.enemySpeed, type: 5, hp: Math.ceil(2 * diffMult.enemyHP) });
                enemiesInWave += 3;
            } else if (type === 4) {
                // Caputo solo (no manada)
                enemies.push({
                    x: Math.random() * (canvas.width - 60) + 30,
                    y: -50,
                    speed: (0.6 + currentWave * 0.05) * diffMult.enemySpeed,
                    type: 4,
                    hp: Math.ceil(2 * diffMult.enemyHP)
                });
                enemiesInWave += 1;
            } else if (type === 8) {
                // Trump y Milei casados
                enemies.push({
                    x: Math.random() * (canvas.width - 100) + 50,
                    y: -70,
                    speed: (0.35 + currentWave * 0.05) * diffMult.enemySpeed,
                    type: 8,
                    hp: Math.ceil(6 * diffMult.enemyHP)
                });
                enemiesInWave += 1;
            } else if (type === 9) {
                // Macri
                enemies.push({
                    x: Math.random() * (canvas.width - 60) + 30,
                    y: -50,
                    speed: (0.6 + currentWave * 0.05) * diffMult.enemySpeed,
                    type: 9,
                    hp: Math.ceil(3 * diffMult.enemyHP)
                });
                enemiesInWave += 1;
            } else if (type === 10) {
                // Villarruel
                enemies.push({
                    x: Math.random() * (canvas.width - 60) + 30,
                    y: -50,
                    speed: 0.6 + currentWave * 0.05,
                    type: 10,
                    hp: 2
                });
                enemiesInWave += 1;
            } else if (type === 11) {
                // Potobellocchia
                enemies.push({
                    x: Math.random() * (canvas.width - 60) + 30,
                    y: -50,
                    speed: 0.7 + currentWave * 0.05,
                    type: 11,
                    hp: 2
                });
                enemiesInWave += 1;
            } else if (type === 12) {
                // MILEI GIGANTE - JEFE FINAL
                enemies.push({
                    x: canvas.width / 2,
                    y: -100,
                    speed: 0.2,
                    type: 12,
                    hp: 40 // Menos vida
                });
                enemiesInWave += 1;
            } else if (type === 13) {
                // Trump solo
                enemies.push({
                    x: Math.random() * (canvas.width - 80) + 40,
                    y: -60,
                    speed: 0.4 + currentWave * 0.05,
                    type: 13,
                    hp: 5
                });
                enemiesInWave += 1;
            } else if (type === 14) {
                // Espert
                enemies.push({
                    x: Math.random() * (canvas.width - 60) + 30,
                    y: -50,
                    speed: (0.55 + currentWave * 0.05) * diffMult.enemySpeed,
                    type: 14,
                    hp: Math.ceil(3 * diffMult.enemyHP)
                });
                enemiesInWave += 1;
            } else {
                enemies.push({
                    x: Math.random() * (canvas.width - 60) + 30,
                    y: -50,
                    speed: (type === 7 ? 0.4 : 0.6) + currentWave * 0.08,
                    type,
                    hp: type === 1 ? 2 : type === 7 ? 3 : 1
                });
                enemiesInWave += 1;
            }
        }
        
        // DISPARAR EMPANADA o SANGUCHE DE MILANESA
        function shootEmpanada(tx, ty) {
            if (ammo <= 0) return;
            ammo--;
            updateUI();
            
            const level = LEVELS[currentLevel];
            const proyectilTipo = level.proyectil;
            
            // Sonido seg√∫n el arma
            playSound(proyectilTipo);
            
            const angle = Math.atan2(ty - tucuman.y, tx - tucuman.x);
            
            // Seg√∫n el tipo de proyectil del nivel
            if (proyectilTipo === 'pelota') {
                // Maradona tira pelotas
                pelotas.push({
                    x: tucuman.x, y: tucuman.y - 20,
                    vx: Math.cos(angle) * 12,
                    vy: Math.sin(angle) * 12,
                    piercing: 2
                });
            } else if (proyectilTipo === 'panuelo') {
                // Hebe tira pa√±uelos
                empanadas.push({
                    x: tucuman.x, y: tucuman.y - 20,
                    vx: Math.cos(angle) * 8,
                    vy: Math.sin(angle) * 8,
                    angle, type: 'panuelo',
                    damage: 10, color: '#FFFFFF', effect: 'destroza'
                });
            } else if (proyectilTipo === 'cruz') {
                // Papa tira cruces
                empanadas.push({
                    x: tucuman.x, y: tucuman.y - 20,
                    vx: Math.cos(angle) * 9,
                    vy: Math.sin(angle) * 9,
                    angle, type: 'cruz',
                    damage: 15, color: '#FFD700', effect: 'destroza'
                });
            } else if (proyectilTipo === 'choripan') {
                // Chorip√°n
                empanadas.push({
                    x: tucuman.x, y: tucuman.y - 20,
                    vx: Math.cos(angle) * 10,
                    vy: Math.sin(angle) * 10,
                    angle, type: 'choripan',
                    damage: 12, color: '#D2691E', effect: 'destroza'
                });
            } else if (proyectilTipo === 'piedra') {
                // Piedra
                empanadas.push({
                    x: tucuman.x, y: tucuman.y - 20,
                    vx: Math.cos(angle) * 11,
                    vy: Math.sin(angle) * 11,
                    angle, type: 'piedra',
                    damage: 15, color: '#696969', effect: 'destroza'
                });
            } else if (proyectilTipo === 'brocoli') {
                // Br√≥coli
                empanadas.push({
                    x: tucuman.x, y: tucuman.y - 20,
                    vx: Math.cos(angle) * 9,
                    vy: Math.sin(angle) * 9,
                    angle, type: 'brocoli',
                    damage: 10, color: '#228B22', effect: 'destroza'
                });
            } else if (proyectilTipo === 'fernet') {
                // Fernet
                empanadas.push({
                    x: tucuman.x, y: tucuman.y - 20,
                    vx: Math.cos(angle) * 10,
                    vy: Math.sin(angle) * 10,
                    angle, type: 'fernet',
                    damage: 14, color: '#1a1a1a', effect: 'destroza'
                });
            } else if (proyectilTipo === 'constitucion') {
                // Constituci√≥n Nacional
                empanadas.push({
                    x: tucuman.x, y: tucuman.y - 20,
                    vx: Math.cos(angle) * 8,
                    vy: Math.sin(angle) * 8,
                    angle, type: 'constitucion',
                    damage: 20, color: '#8B0000', effect: 'destroza'
                });
            } else {
                // Empanada por defecto
                empanadas.push({
                    x: tucuman.x, y: tucuman.y - 20,
                    vx: Math.cos(angle) * 10,
                    vy: Math.sin(angle) * 10,
                    angle, type: 'empanada',
                    damage: 10, color: '#DAA520', effect: 'destroza'
                });
            }
        }
        
        function peronShoot() {
            if (!peronActive || enemies.length === 0) return;
            if (Date.now() - lastPeronShot < 2500) return;
            lastPeronShot = Date.now();
            let closest = enemies[0];
            let minD = Infinity;
            enemies.forEach(e => {
                const d = Math.hypot(e.x - peronX, e.y - (canvas.height - 125));
                if (d < minD) { minD = d; closest = e; }
            });
            const angle = Math.atan2(closest.y - (canvas.height - 125), closest.x - peronX);
            empanadas.push({
                x: peronX, y: canvas.height - 145,
                vx: Math.cos(angle) * 10,
                vy: Math.sin(angle) * 10,
                angle, type: 'choripan',
                damage: 15, color: '#FFD700', effect: 'destroza'
            });
        }
        
        function maradonaShoot() {
            if (!maradonaActive || enemies.length === 0) return;
            if (Date.now() - lastMaradonaShot < 2200) return;
            lastMaradonaShot = Date.now();
            let closest = enemies[0];
            let minD = Infinity;
            enemies.forEach(e => {
                const d = Math.hypot(e.x - maradonaX, e.y - (canvas.height - 120));
                if (d < minD) { minD = d; closest = e; }
            });
            const angle = Math.atan2(closest.y - (canvas.height - 120), closest.x - maradonaX);
            pelotas.push({
                x: maradonaX, y: canvas.height - 140,
                vx: Math.cos(angle) * 11,
                vy: Math.sin(angle) * 11,
                angle: 0, piercing: 4
            });
        }
        
        function nestorShoot() {
            if (!nestorActive || enemies.length === 0) return;
            if (Date.now() - lastNestorShot < 2800) return;
            lastNestorShot = Date.now();
            let closest = enemies[0];
            let minD = Infinity;
            enemies.forEach(e => {
                const d = Math.hypot(e.x - nestorX, e.y - (canvas.height - 125));
                if (d < minD) { minD = d; closest = e; }
            });
            const angle = Math.atan2(closest.y - (canvas.height - 125), closest.x - nestorX);
            // N√©stor tira choripanes dobles
            empanadas.push({
                x: nestorX - 10, y: canvas.height - 145,
                vx: Math.cos(angle - 0.1) * 9,
                vy: Math.sin(angle - 0.1) * 9,
                angle, type: 'choripan',
                damage: 10, color: '#75AADB', effect: 'destroza'
            });
            empanadas.push({
                x: nestorX + 10, y: canvas.height - 145,
                vx: Math.cos(angle + 0.1) * 9,
                vy: Math.sin(angle + 0.1) * 9,
                angle, type: 'choripan',
                damage: 10, color: '#75AADB', effect: 'destroza'
            });
        }
        
        function evitaShoot() {
            if (!evitaActive || enemies.length === 0) return;
            if (Date.now() - lastEvitaShot < 2500) return;
            lastEvitaShot = Date.now();
            let closest = enemies[0];
            let minD = Infinity;
            enemies.forEach(e => {
                const d = Math.hypot(e.x - evitaX, e.y - (canvas.height - 120));
                if (d < minD) { minD = d; closest = e; }
            });
            const angle = Math.atan2(closest.y - (canvas.height - 120), closest.x - evitaX);
            empanadas.push({
                x: evitaX, y: canvas.height - 140,
                vx: Math.cos(angle) * 8,
                vy: Math.sin(angle) * 8,
                angle, type: 'corazon',
                damage: 5, color: '#FF69B4', effect: 'paraliza'
            });
        }
        
        function graboisShoot() {
            if (!graboisActive || enemies.length === 0) return;
            if (Date.now() - lastGraboisShot < 3500) return;
            lastGraboisShot = Date.now();
            let closest = enemies[0];
            enemies.forEach(e => {
                if (Math.hypot(e.x - graboisX, e.y - canvas.height + 130) < Math.hypot(closest.x - graboisX, closest.y - canvas.height + 130)) closest = e;
            });
            const angle = Math.atan2(closest.y - (canvas.height - 130), closest.x - graboisX);
            empanadas.push({ x: graboisX, y: canvas.height - 150, vx: Math.cos(angle) * 7, vy: Math.sin(angle) * 7, angle, type: 'choripan', damage: 5, color: '#FF6B6B', effect: 'destroza' });
        }
        
        function morenoShoot() {
            if (!morenoActive || enemies.length === 0) return;
            if (Date.now() - lastMorenoShot < 3200) return;
            lastMorenoShot = Date.now();
            let closest = enemies[0];
            enemies.forEach(e => {
                if (Math.hypot(e.x - morenoX, e.y - canvas.height + 130) < Math.hypot(closest.x - morenoX, closest.y - canvas.height + 130)) closest = e;
            });
            const angle = Math.atan2(closest.y - (canvas.height - 130), closest.x - morenoX);
            empanadas.push({ x: morenoX, y: canvas.height - 150, vx: Math.cos(angle) * 8, vy: Math.sin(angle) * 8, angle, type: 'choripan', damage: 6, color: '#4169E1', effect: 'destroza' });
        }
        
        function gatoShoot() {
            if (!gatoActive || enemies.length === 0) return;
            if (Date.now() - lastGatoShot < 3000) return;
            lastGatoShot = Date.now();
            let closest = enemies[0];
            enemies.forEach(e => {
                if (Math.hypot(e.x - gatoX, e.y - canvas.height + 130) < Math.hypot(closest.x - gatoX, closest.y - canvas.height + 130)) closest = e;
            });
            const angle = Math.atan2(closest.y - (canvas.height - 130), closest.x - gatoX);
            empanadas.push({ x: gatoX, y: canvas.height - 150, vx: Math.cos(angle) * 9, vy: Math.sin(angle) * 9, angle, type: 'choripan', damage: 7, color: '#228B22', effect: 'destroza' });
        }
        
        function hebeShoot() {
            if (!hebeActive || enemies.length === 0) return;
            if (Date.now() - lastHebeShot < 3800) return;
            lastHebeShot = Date.now();
            let closest = enemies[0];
            enemies.forEach(e => {
                if (Math.hypot(e.x - hebeX, e.y - canvas.height + 130) < Math.hypot(closest.x - hebeX, closest.y - canvas.height + 130)) closest = e;
            });
            const angle = Math.atan2(closest.y - (canvas.height - 130), closest.x - hebeX);
            empanadas.push({ x: hebeX, y: canvas.height - 150, vx: Math.cos(angle) * 6, vy: Math.sin(angle) * 6, angle, type: 'choripan', damage: 5, color: '#FFFFFF', effect: 'destroza' });
        }
        
        function lulaShoot() {
            if (!lulaActive || enemies.length === 0) return;
            if (Date.now() - lastLulaShot < 2800) return;
            lastLulaShot = Date.now();
            let closest = enemies[0];
            enemies.forEach(e => {
                if (Math.hypot(e.x - lulaX, e.y - canvas.height + 130) < Math.hypot(closest.x - lulaX, closest.y - canvas.height + 130)) closest = e;
            });
            const angle = Math.atan2(closest.y - (canvas.height - 130), closest.x - lulaX);
            empanadas.push({ x: lulaX, y: canvas.height - 150, vx: Math.cos(angle) * 8, vy: Math.sin(angle) * 8, angle, type: 'choripan', damage: 8, color: '#009739', effect: 'destroza' });
        }
        
        function cristinaShoot() {
            if (!cristinaActive || enemies.length === 0) return;
            if (Date.now() - lastCristinaShot < 600) return;
            lastCristinaShot = Date.now();
            let closest = enemies[0];
            let minD = Infinity;
            enemies.forEach(e => {
                const d = Math.hypot(e.x - cristinaX, e.y - (canvas.height - 125));
                if (d < minD) { minD = d; closest = e; }
            });
            const angle = Math.atan2(closest.y - (canvas.height - 125), closest.x - cristinaX);
            empanadas.push({
                x: cristinaX, y: canvas.height - 145,
                vx: Math.cos(angle) * 12,
                vy: Math.sin(angle) * 12,
                angle, type: 'picante',
                damage: 10, color: '#75AADB', effect: 'destroza'
            });
        }
        
        function activatePeron() {
            peronActive = true;
            peronX = canvas.width * 0.2;
            allyMessage = '';
            allyMessageTimer = 100;
            ammo += 12;
            maxAmmo = 32;
            updateUI();
        }
        
        function activateMaradona() {
            maradonaActive = true;
            maradonaX = canvas.width * 0.8;
            allyMessage = '';
            allyMessageTimer = 100;
            updateUI();
        }
        
        function activateNestor() {
            nestorActive = true;
            nestorX = canvas.width * 0.35;
            allyMessage = '';
            allyMessageTimer = 100;
            ammo += 15;
            maxAmmo = 45;
            updateUI();
        }
        
        function activateEvita() {
            evitaActive = true;
            evitaX = canvas.width * 0.5;
            allyMessage = '';
            allyMessageTimer = 100;
            vidas = 3; // Evita te cura
            updateUI();
        }
        
        function activateGrabois() {
            graboisActive = true;
            graboisX = canvas.width * 0.25;
            allyMessage = '';
            allyMessageTimer = 100;
            ammo += 8;
            updateUI();
        }
        
        function activateMoreno() {
            morenoActive = true;
            morenoX = canvas.width * 0.3;
            allyMessage = '';
            allyMessageTimer = 100;
            ammo += 10;
            updateUI();
        }
        
        function activateGato() {
            gatoActive = true;
            gatoX = canvas.width * 0.35;
            allyMessage = '';
            allyMessageTimer = 100;
            ammo += 10;
            updateUI();
        }
        
        function activateHebe() {
            hebeActive = true;
            hebeX = canvas.width * 0.4;
            allyMessage = '';
            allyMessageTimer = 100;
            vidas = Math.min(vidas + 1, 5);
            updateUI();
        }
        
        function activateLula() {
            lulaActive = true;
            lulaX = canvas.width * 0.45;
            allyMessage = '';
            allyMessageTimer = 100;
            ammo += 12;
            updateUI();
        }
        
        function activateCristina() {
            cristinaActive = true;
            cristinaX = canvas.width * 0.65;
            allyMessage = '';
            allyMessageTimer = 100;
            ammo += 20;
            maxAmmo = 60;
            updateUI();
        }
        
        // UPDATE
        function update() {
            if (!gameRunning) return;
            
            const now = Date.now();
            const level = LEVELS[currentLevel];
            const enemiesPerWave = 3 + currentWave * 1;
            
            // *** MOVER TUCU-MAN - SIMPLE Y DIRECTO ***
            if (targetX !== null) {
                // M√≥vil: ir directo al dedo
                const diff = targetX - tucuman.x;
                if (Math.abs(diff) > 2) {
                    tucuman.x += diff > 0 ? Math.min(diff, tucumanMaxSpeed) : Math.max(diff, -tucumanMaxSpeed);
                }
            } else if (moveLeft || moveRight) {
                // Teclado: movimiento directo
                if (moveLeft) tucuman.x -= tucumanMaxSpeed;
                if (moveRight) tucuman.x += tucumanMaxSpeed;
            }
            
            // Limitar a los bordes
            if (tucuman.x < 35) tucuman.x = 35;
            if (tucuman.x > canvas.width - 35) tucuman.x = canvas.width - 35;
            
            // Siguiente oleada
            if (enemiesInWave >= enemiesPerWave && enemies.length === 0) {
                if (currentWave >= level.waves) {
                    completeLevel();
                    return;
                } else {
                    currentWave++;
                    enemiesInWave = 0;
                    spawnRate = Math.max(700, level.spawnRateBase - currentWave * 180);
                    updateUI();
                }
            }
            
            // Spawn
            if (now - lastSpawn > spawnRate && enemiesInWave < enemiesPerWave) {
                spawnEnemy();
                lastSpawn = now;
            }
            
            // Ya no usamos aliados autom√°ticos (ahora el jugador ES el personaje)
            // Solo Evita es aliada autom√°tica en nivel 10
            
            if (ammo < maxAmmo && Math.random() > 0.98) { ammo++; updateUI(); }
            
            // *** MOVER ALIADOS ***
            if (graboisActive) {
                graboisX += allyMoveSpeed * graboisDir;
                if (graboisX > graboisBaseX + allyMoveRange || graboisX < graboisBaseX - allyMoveRange) graboisDir *= -1;
            }
            if (morenoActive) {
                morenoX += allyMoveSpeed * morenoDir;
                if (morenoX > morenoBaseX + allyMoveRange || morenoX < morenoBaseX - allyMoveRange) morenoDir *= -1;
            }
            if (gatoActive) {
                gatoX += allyMoveSpeed * gatoDir;
                if (gatoX > gatoBaseX + allyMoveRange || gatoX < gatoBaseX - allyMoveRange) gatoDir *= -1;
            }
            if (hebeActive) {
                hebeX += allyMoveSpeed * hebeDir;
                if (hebeX > hebeBaseX + allyMoveRange || hebeX < hebeBaseX - allyMoveRange) hebeDir *= -1;
            }
            if (lulaActive) {
                lulaX += allyMoveSpeed * lulaDir;
                if (lulaX > lulaBaseX + allyMoveRange || lulaX < lulaBaseX - allyMoveRange) lulaDir *= -1;
            }
            if (peronActive) {
                peronX += allyMoveSpeed * peronDir;
                if (peronX > peronBaseX + allyMoveRange || peronX < peronBaseX - allyMoveRange) {
                    peronDir *= -1;
                }
            }
            if (maradonaActive) {
                maradonaX += allyMoveSpeed * maradonaDir;
                if (maradonaX > maradonaBaseX + allyMoveRange || maradonaX < maradonaBaseX - allyMoveRange) {
                    maradonaDir *= -1;
                }
            }
            if (nestorActive) {
                nestorX += allyMoveSpeed * nestorDir;
                if (nestorX > nestorBaseX + allyMoveRange || nestorX < nestorBaseX - allyMoveRange) {
                    nestorDir *= -1;
                }
            }
            if (evitaActive) {
                evitaX += allyMoveSpeed * evitaDir;
                if (evitaX > evitaBaseX + allyMoveRange || evitaX < evitaBaseX - allyMoveRange) {
                    evitaDir *= -1;
                }
            }
            
            // *** ALIADOS DISPARAN ***
            peronShoot();
            maradonaShoot();
            nestorShoot();
            evitaShoot();
            graboisShoot();
            morenoShoot();
            gatoShoot();
            hebeShoot();
            lulaShoot();
            if (allyMessageTimer > 0) allyMessageTimer--;
            
            // Recarga autom√°tica de munici√≥n (cada 60 frames = 1 segundo)
            if (!window.reloadTimer) window.reloadTimer = 0;
            window.reloadTimer++;
            if (window.reloadTimer >= 60 && ammo < maxAmmo) {
                ammo++;
                updateUI();
                window.reloadTimer = 0;
            }
            
            // Mover enemigos
            enemies.forEach((e, i) => {
                if (e.paralizado) {
                    e.paralizadoTimer--;
                    if (e.paralizadoTimer <= 0) e.paralizado = false;
                }
                if (!e.paralizado) {
                    e.y += e.speed;
                    
                    // Movimiento lateral zigzag
                    if (e.vx === undefined) {
                        e.vx = (Math.random() - 0.5) * 3; // Velocidad lateral inicial
                        e.zigzagTimer = Math.random() * 60 + 30;
                    }
                    e.x += e.vx;
                    e.zigzagTimer--;
                    
                    // Cambiar direcci√≥n cada tanto
                    if (e.zigzagTimer <= 0) {
                        e.vx = (Math.random() - 0.5) * 3;
                        e.zigzagTimer = Math.random() * 60 + 30;
                    }
                    
                    // Mantener dentro de la pantalla
                    if (e.x < 30) { e.x = 30; e.vx = Math.abs(e.vx); }
                    if (e.x > canvas.width - 30) { e.x = canvas.width - 30; e.vx = -Math.abs(e.vx); }
                }
                
                // LLEG√ì A LA L√çNEA = GAME OVER INMEDIATO
                if (e.y > canvas.height - 75) {
                    gameOver();
                    return;
                }
            });
            
            // Mover empanadas
            empanadas.forEach((emp, i) => {
                emp.x += emp.vx;
                emp.y += emp.vy;
                emp.angle += 0.2;
                if (emp.y < -20 || emp.x < -20 || emp.x > canvas.width + 20) {
                    empanadas.splice(i, 1);
                }
            });
            
            // Mover pelotas
            pelotas.forEach((p, i) => {
                p.x += p.vx;
                p.y += p.vy;
                p.angle += 0.3;
                if (p.y < -20 || p.x < -20 || p.x > canvas.width + 20) {
                    pelotas.splice(i, 1);
                }
            });
            
            // Mover proyectiles enemigos y detectar colisi√≥n con TUCU-MAN
            for (let i = proyectilesEnemigos.length - 1; i >= 0; i--) {
                const p = proyectilesEnemigos[i];
                p.x += p.vx;
                p.y += p.vy;
                
                // *** COLISI√ìN CON TUCU-MAN ***
                // tucuman.y se actualiza en drawTucuman(), usar canvas.height - 120 como referencia
                const tucCenterY = canvas.height - 85; // Centro aproximado del personaje
                const hitboxW = 35; // Ancho del hitbox
                const hitboxH = 50; // Alto del hitbox
                
                if (p.x > tucuman.x - hitboxW && 
                    p.x < tucuman.x + hitboxW && 
                    p.y > tucCenterY - hitboxH && 
                    p.y < tucCenterY + hitboxH) {
                    // ¬°TUCU-MAN fue golpeado!
                    playSound('dano');
                    vidas--;
                    explode(tucuman.x, tucCenterY, p.type === 'caca' ? '#8B4513' : '#FF4500');
                    proyectilesEnemigos.splice(i, 1);
                    updateUI();
                    
                    // Efecto visual de da√±o
                    allyMessage = p.type === 'caca' ? '¬°PUAJ! üí©' : '¬°PATRIA O MUERTE! ü™ö';
                    allyMessageTimer = 60;
                    
                    if (vidas <= 0) {
                        gameOver();
                        return;
                    }
                    continue;
                }
                
                // Fuera de pantalla
                if (p.y > canvas.height + 20) {
                    proyectilesEnemigos.splice(i, 1);
                    continue;
                }
                
                // Da√±o al objetivo (empanada/lim√≥n/etc)
                if (p.y > canvas.height - 60 && Math.abs(p.x - canvas.width/2) < 50) {
                    defenseHP -= 5;
                    explode(p.x, p.y, p.type === 'caca' ? '#8B4513' : '#FF4500');
                    proyectilesEnemigos.splice(i, 1);
                    if (defenseHP <= 0) gameOver();
                    updateUI();
                }
            }
            
            // *** COLISI√ìN EMPANADAS vs PROYECTILES ENEMIGOS ***
            // Tus armas pueden destruir las armas enemigas
            for (let i = proyectilesEnemigos.length - 1; i >= 0; i--) {
                const p = proyectilesEnemigos[i];
                for (let j = empanadas.length - 1; j >= 0; j--) {
                    const emp = empanadas[j];
                    if (Math.abs(emp.x - p.x) < 20 && Math.abs(emp.y - p.y) < 20) {
                        // ¬°Destruye ambos!
                        explode(p.x, p.y, '#FFD700');
                        proyectilesEnemigos.splice(i, 1);
                        empanadas.splice(j, 1);
                        score += 5;
                        updateUI();
                        break;
                    }
                }
            }
            
            // Colisiones empanada-enemigo (for inverso para evitar bugs)
            for (let ei = empanadas.length - 1; ei >= 0; ei--) {
                const emp = empanadas[ei];
                for (let eni = enemies.length - 1; eni >= 0; eni--) {
                    const enemy = enemies[eni];
                    if (!enemy) continue;
                    
                    // Hitbox m√°s grande para Trump+Milei (type 8)
                    const hitW = (enemy.type === 8) ? 45 : 22;
                    const hitH = (enemy.type === 8) ? 55 : 28;
                    
                    if (Math.abs(emp.x - enemy.x) < hitW && Math.abs(emp.y - enemy.y) < hitH) {
                        
                        // SANGUCHE DE MILANESA - Da√±o en √°rea
                        if (emp.isSanguche) {
                            empanadas.splice(ei, 1);
                            explode(emp.x, emp.y, '#D2691E');
                            explode(emp.x, emp.y, '#FFD700');
                            
                            // Da√±a a todos los enemigos cercanos
                            for (let i = enemies.length - 1; i >= 0; i--) {
                                if (Math.abs(emp.x - enemies[i].x) < 50 && Math.abs(emp.y - enemies[i].y) < 50) {
                                    score += (enemies[i].type + 1) * 10;
                                    libertariosAbatidos++;
                                    enemies.splice(i, 1);
                                }
                            }
                            updateUI();
                            break;
                        }
                        
                        // Quitar empanada
                        empanadas.splice(ei, 1);
                        
                        // Empanada de verdura solo hace explotar sin da√±o
                        if (emp.effect === null) {
                            explode(emp.x, emp.y, '#228B22');
                            break;
                        }
                        
                        // Humita o Coraz√≥n de Evita PARALIZA
                        if (emp.effect === 'paraliza') {
                            enemy.paralizado = true;
                            enemy.paralizadoTimer = 200;
                            explode(emp.x, emp.y, '#87CEEB');
                            break;
                        }
                        
                        // Picante o Choripan = MATA
                        explode(enemy.x, enemy.y, emp.color || '#FF4500');
                        playEnemyAudio(enemy); // Audio del enemigo
                        score += (enemy.type + 1) * 10;
                        libertariosAbatidos++;
                        enemies.splice(eni, 1);
                        updateUI();
                        break;
                    }
                }
            }
            
            // Colisiones pelota-enemigo
            pelotas.forEach((pel, pi) => {
                enemies.forEach((enemy, eni) => {
                    // Hitbox m√°s grande para Trump+Milei (type 8)
                    const hitW = (enemy.type === 8) ? 45 : 22;
                    const hitH = (enemy.type === 8) ? 55 : 28;
                    
                    if (Math.abs(pel.x - enemy.x) < hitW && Math.abs(pel.y - enemy.y) < hitH) {
                        playEnemyAudio(enemy); // Audio del enemigo
                        enemy.hp = 0;
                        enemies.splice(eni, 1);
                        score += (enemy.type + 1) * 15;
                        libertariosAbatidos++; // Contar libertario abatido
                        explode(enemy.x, enemy.y, '#fff');
                        updateUI();
                        pel.piercing--;
                        if (pel.piercing <= 0) pelotas.splice(pi, 1);
                    }
                });
            });
        }
        
        // DRAW
        // FONDOS ESTILO MARIO BROS
        function drawBackground(levelIdx) {
            const w = canvas.width;
            const h = canvas.height;
            
            // Cielo degradado
            const skyGrad = ctx.createLinearGradient(0, 0, 0, h * 0.7);
            skyGrad.addColorStop(0, '#87CEEB');
            skyGrad.addColorStop(1, '#E0F6FF');
            ctx.fillStyle = skyGrad;
            ctx.fillRect(0, 0, w, h * 0.7);
            
            // *** NUBES ANIMADAS ***
            clouds.forEach(cloud => {
                cloud.x += cloud.speed;
                if (cloud.x > w + 80) cloud.x = -80;
                drawCloud(cloud.x, cloud.y, cloud.scale);
            });
            
            // *** P√ÅJAROS VOLANDO ***
            birds.forEach(bird => {
                bird.x += bird.speed;
                bird.wingPhase += 0.2;
                if (bird.x > w + 20) bird.x = -20;
                drawBird(bird.x, bird.y + Math.sin(bird.x / 30) * 5, bird.wingPhase);
            });
            
            // *** D√ìLARES VOLANDO ***
            dolares.forEach(d => {
                d.x += d.speed;
                d.wobble += 0.05;
                d.rotation += 0.02;
                if (d.x > w + 30) d.x = -30;
                const yOffset = Math.sin(d.wobble) * 8;
                drawDolar(d.x, d.y + yOffset, d.rotation);
            });
            
            // *** AVIONES F-16 DE PAPEL ***
            aviones.forEach(a => {
                a.x += a.speed;
                a.wobble += 0.03;
                if (a.x > w + 50) a.x = -50;
                const yOffset = Math.sin(a.wobble) * 3;
                drawAvionPapel(a.x, a.y + yOffset);
            });
            
            // Piso
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(0, h * 0.85, w, h * 0.15);
            
            // Pasto
            ctx.fillStyle = '#228B22';
            ctx.fillRect(0, h * 0.82, w, h * 0.05);
            
            // Ladrillos del piso estilo Mario
            ctx.fillStyle = '#A0522D';
            for (let x = 0; x < w; x += 30) {
                ctx.fillRect(x, h * 0.87, 28, 12);
                ctx.fillRect(x + 15, h * 0.90, 28, 12);
            }
            
            // Dibujar monumento seg√∫n nivel
            if (levelIdx === 0) {
                drawObelisco(w * 0.5, h * 0.82);
            } else if (levelIdx === 1) {
                drawCasaRosada(w * 0.5, h * 0.82);
            } else if (levelIdx === 2) {
                drawCongreso(w * 0.5, h * 0.82);
            } else if (levelIdx === 3) {
                drawPlazaMayo(w * 0.5, h * 0.82);
            } else if (levelIdx === 4) {
                drawBombonera(w * 0.5, h * 0.82);
            } else if (levelIdx === 5) {
                drawPuente(w * 0.5, h * 0.82);
            } else if (levelIdx === 6) {
                drawCancha(w * 0.5, h * 0.82);
            } else if (levelIdx === 7) {
                drawIglesia(w * 0.5, h * 0.82);
            } else if (levelIdx === 8) {
                drawCGT(w * 0.5, h * 0.82);
            } else if (levelIdx === 9) {
                drawComodoroPy(w * 0.5, h * 0.82);
            }
        }
        
        // *** DIBUJAR P√ÅJARO ***
        function drawBird(x, y, wingPhase) {
            ctx.fillStyle = '#333';
            ctx.beginPath();
            // Cuerpo
            ctx.ellipse(x, y, 6, 4, 0, 0, Math.PI * 2);
            ctx.fill();
            // Alas animadas
            const wingY = Math.sin(wingPhase) * 4;
            ctx.beginPath();
            ctx.moveTo(x - 3, y);
            ctx.quadraticCurveTo(x - 10, y + wingY - 5, x - 8, y + wingY);
            ctx.quadraticCurveTo(x - 10, y + wingY + 3, x - 3, y);
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(x + 3, y);
            ctx.quadraticCurveTo(x + 10, y + wingY - 5, x + 8, y + wingY);
            ctx.quadraticCurveTo(x + 10, y + wingY + 3, x + 3, y);
            ctx.fill();
        }
        
        // *** D√ìLAR VOLANDO ***
        function drawDolar(x, y, rotation) {
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(Math.sin(rotation) * 0.3);
            // Billete verde
            ctx.fillStyle = '#85bb65';
            ctx.fillRect(-12, -6, 24, 12);
            // Borde
            ctx.strokeStyle = '#2e5c1e';
            ctx.lineWidth = 1;
            ctx.strokeRect(-12, -6, 24, 12);
            // S√≠mbolo $
            ctx.fillStyle = '#2e5c1e';
            ctx.font = 'bold 10px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('$', 0, 4);
            ctx.restore();
        }
        
        // *** AVI√ìN F-16 DE PAPEL (parodia) ***
        function drawAvionPapel(x, y) {
            ctx.save();
            ctx.translate(x, y);
            
            // Cuerpo del avi√≥n de papel (blanco con l√≠neas de cuaderno)
            ctx.fillStyle = '#FFFEF0';
            ctx.beginPath();
            ctx.moveTo(20, 0);      // Punta
            ctx.lineTo(-15, -8);    // Ala arriba
            ctx.lineTo(-10, 0);     // Centro
            ctx.lineTo(-15, 8);     // Ala abajo
            ctx.closePath();
            ctx.fill();
            
            // Borde del papel
            ctx.strokeStyle = '#CCCCCC';
            ctx.lineWidth = 1;
            ctx.stroke();
            
            // L√≠neas de cuaderno (es papel de cuaderno!)
            ctx.strokeStyle = '#ADD8E6';
            ctx.lineWidth = 0.5;
            ctx.beginPath();
            ctx.moveTo(-12, -4);
            ctx.lineTo(15, -4);
            ctx.moveTo(-10, 0);
            ctx.lineTo(18, 0);
            ctx.moveTo(-12, 4);
            ctx.lineTo(15, 4);
            ctx.stroke();
            
            // Texto "F-16" escrito a mano con birome
            ctx.fillStyle = '#0000AA';
            ctx.font = 'italic 6px Comic Sans MS, cursive';
            ctx.fillText('F-16', -5, 2);
            
            // Estela de humo (l√≠neas punteadas)
            ctx.strokeStyle = 'rgba(200,200,200,0.5)';
            ctx.setLineDash([2, 3]);
            ctx.beginPath();
            ctx.moveTo(-15, 0);
            ctx.lineTo(-35, 0);
            ctx.stroke();
            ctx.setLineDash([]);
            
            ctx.restore();
        }
        
        function drawCloud(x, y, scale) {
            ctx.fillStyle = '#FFFFFF';
            ctx.beginPath();
            ctx.arc(x, y, 20 * scale, 0, Math.PI * 2);
            ctx.arc(x + 25 * scale, y - 10 * scale, 25 * scale, 0, Math.PI * 2);
            ctx.arc(x + 50 * scale, y, 20 * scale, 0, Math.PI * 2);
            ctx.arc(x + 25 * scale, y + 5 * scale, 18 * scale, 0, Math.PI * 2);
            ctx.fill();
        }
        
        // OBELISCO - Nivel 1
        function drawObelisco(x, baseY) {
            // Base
            ctx.fillStyle = '#D3D3D3';
            ctx.fillRect(x - 40, baseY - 30, 80, 30);
            
            // Cuerpo del obelisco
            ctx.fillStyle = '#F5F5F5';
            ctx.beginPath();
            ctx.moveTo(x - 25, baseY - 30);
            ctx.lineTo(x - 15, baseY - 280);
            ctx.lineTo(x + 15, baseY - 280);
            ctx.lineTo(x + 25, baseY - 30);
            ctx.closePath();
            ctx.fill();
            
            // Punta
            ctx.beginPath();
            ctx.moveTo(x - 15, baseY - 280);
            ctx.lineTo(x, baseY - 320);
            ctx.lineTo(x + 15, baseY - 280);
            ctx.closePath();
            ctx.fill();
            
            // Sombra lateral
            ctx.fillStyle = '#C0C0C0';
            ctx.beginPath();
            ctx.moveTo(x + 5, baseY - 30);
            ctx.lineTo(x + 10, baseY - 280);
            ctx.lineTo(x + 25, baseY - 30);
            ctx.closePath();
            ctx.fill();
            
            // Detalles/ventanas
            ctx.fillStyle = '#A9A9A9';
            for (let i = 0; i < 5; i++) {
                ctx.fillRect(x - 8, baseY - 80 - i * 40, 16, 8);
            }
            
            // Edificios al fondo
            ctx.fillStyle = '#696969';
            ctx.fillRect(x - 120, baseY - 100, 50, 100);
            ctx.fillRect(x + 70, baseY - 120, 60, 120);
            ctx.fillStyle = '#808080';
            ctx.fillRect(x - 150, baseY - 80, 40, 80);
            ctx.fillRect(x + 110, baseY - 90, 45, 90);
            
            // Ventanas en edificios
            ctx.fillStyle = '#FFD700';
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 4; j++) {
                    ctx.fillRect(x - 115 + j * 12, baseY - 90 + i * 25, 8, 15);
                    ctx.fillRect(x + 75 + j * 14, baseY - 110 + i * 30, 10, 18);
                }
            }
        }
        
        // CASA ROSADA - Nivel 2
        function drawCasaRosada(x, baseY) {
            // Edificio principal
            ctx.fillStyle = '#FFB6C1';
            ctx.fillRect(x - 100, baseY - 150, 200, 150);
            
            // Techo
            ctx.fillStyle = '#FF69B4';
            ctx.fillRect(x - 110, baseY - 160, 220, 15);
            
            // C√∫pula central
            ctx.fillStyle = '#FFB6C1';
            ctx.beginPath();
            ctx.arc(x, baseY - 180, 30, Math.PI, 0);
            ctx.fill();
            ctx.fillStyle = '#98FB98';
            ctx.beginPath();
            ctx.arc(x, baseY - 190, 15, Math.PI, 0);
            ctx.fill();
            
            // Bandera
            ctx.fillStyle = '#75AADB';
            ctx.fillRect(x - 2, baseY - 240, 4, 50);
            ctx.fillRect(x + 2, baseY - 240, 25, 15);
            ctx.fillStyle = '#FFF';
            ctx.fillRect(x + 2, baseY - 230, 25, 5);
            
            // Columnas
            ctx.fillStyle = '#FFF';
            for (let i = 0; i < 6; i++) {
                ctx.fillRect(x - 80 + i * 32, baseY - 140, 8, 100);
            }
            
            // Ventanas
            ctx.fillStyle = '#4169E1';
            for (let i = 0; i < 5; i++) {
                ctx.fillRect(x - 75 + i * 35, baseY - 130, 20, 30);
                ctx.fillRect(x - 75 + i * 35, baseY - 80, 20, 30);
            }
            
            // Puerta principal
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(x - 20, baseY - 70, 40, 70);
            ctx.fillStyle = '#FFD700';
            ctx.beginPath();
            ctx.arc(x, baseY - 70, 20, Math.PI, 0);
            ctx.fill();
        }
        
        // CONGRESO - Nivel 3
        function drawCongreso(x, baseY) {
            // Base
            ctx.fillStyle = '#D3D3D3';
            ctx.fillRect(x - 120, baseY - 100, 240, 100);
            
            // Cuerpo central
            ctx.fillStyle = '#E8E8E8';
            ctx.fillRect(x - 60, baseY - 150, 120, 50);
            
            // C√∫pula grande
            ctx.fillStyle = '#2F4F4F';
            ctx.beginPath();
            ctx.arc(x, baseY - 170, 50, Math.PI, 0);
            ctx.fill();
            
            // C√∫pula peque√±a arriba
            ctx.beginPath();
            ctx.arc(x, baseY - 210, 20, Math.PI, 0);
            ctx.fill();
            
            // Aguja
            ctx.fillStyle = '#FFD700';
            ctx.fillRect(x - 3, baseY - 260, 6, 40);
            
            // Columnas
            ctx.fillStyle = '#FFF';
            for (let i = 0; i < 8; i++) {
                ctx.fillRect(x - 100 + i * 28, baseY - 90, 6, 70);
            }
            
            // Escaleras
            ctx.fillStyle = '#C0C0C0';
            for (let i = 0; i < 5; i++) {
                ctx.fillRect(x - 80 + i * 10, baseY - 5 - i * 5, 160 - i * 20, 8);
            }
        }
        
        // PLAZA DE MAYO - Nivel 4
        function drawPlazaMayo(x, baseY) {
            // Pir√°mide de Mayo
            ctx.fillStyle = '#F5F5F5';
            ctx.beginPath();
            ctx.moveTo(x - 30, baseY);
            ctx.lineTo(x, baseY - 120);
            ctx.lineTo(x + 30, baseY);
            ctx.closePath();
            ctx.fill();
            
            // Estatua arriba
            ctx.fillStyle = '#FFD700';
            ctx.beginPath();
            ctx.arc(x, baseY - 130, 10, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillRect(x - 3, baseY - 150, 6, 20);
            
            // Pa√±uelos blancos (Madres)
            ctx.fillStyle = '#FFF';
            for (let i = 0; i < 5; i++) {
                const px = x - 80 + i * 40;
                ctx.beginPath();
                ctx.arc(px, baseY - 20, 8, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // √Årboles
            ctx.fillStyle = '#228B22';
            ctx.beginPath();
            ctx.arc(x - 100, baseY - 50, 35, 0, Math.PI * 2);
            ctx.fill();
            ctx.arc(x + 100, baseY - 50, 35, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(x - 105, baseY - 20, 10, 20);
            ctx.fillRect(x + 95, baseY - 20, 10, 20);
        }
        
        // BOMBONERA - Nivel 5
        function drawBombonera(x, baseY) {
            // Estructura del estadio
            ctx.fillStyle = '#0000CD';
            ctx.fillRect(x - 100, baseY - 120, 200, 120);
            
            // Franjas amarillas
            ctx.fillStyle = '#FFD700';
            ctx.fillRect(x - 100, baseY - 100, 200, 20);
            ctx.fillRect(x - 100, baseY - 60, 200, 20);
            
            // Arco
            ctx.fillStyle = '#1E1E1E';
            ctx.beginPath();
            ctx.arc(x, baseY - 120, 60, Math.PI, 0);
            ctx.fill();
            
            // Cancha verde adentro
            ctx.fillStyle = '#228B22';
            ctx.beginPath();
            ctx.arc(x, baseY - 120, 50, Math.PI, 0);
            ctx.fill();
            
            // Texto BOCA
            ctx.fillStyle = '#FFD700';
            ctx.font = 'bold 20px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('BOCA', x, baseY - 70);
        }
        
        // PUENTE - Nivel 6
        function drawPuente(x, baseY) {
            // Agua
            ctx.fillStyle = '#4169E1';
            ctx.fillRect(0, baseY - 30, canvas.width, 30);
            
            // Puente
            ctx.fillStyle = '#808080';
            ctx.fillRect(x - 120, baseY - 60, 240, 15);
            
            // Pilares
            ctx.fillStyle = '#696969';
            ctx.fillRect(x - 100, baseY - 100, 20, 100);
            ctx.fillRect(x + 80, baseY - 100, 20, 100);
            
            // Cables
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(x - 90, baseY - 100);
            ctx.quadraticCurveTo(x, baseY - 40, x + 90, baseY - 100);
            ctx.stroke();
            
            // Banderas
            ctx.fillStyle = '#009739';
            ctx.fillRect(x - 110, baseY - 140, 25, 15);
            ctx.fillStyle = '#75AADB';
            ctx.fillRect(x + 85, baseY - 140, 25, 15);
            
            // Astas
            ctx.fillStyle = '#333';
            ctx.fillRect(x - 112, baseY - 140, 3, 40);
            ctx.fillRect(x + 83, baseY - 140, 3, 40);
        }
        
        // CANCHA DE F√öTBOL - Nivel 7
        function drawCancha(x, baseY) {
            // Cancha
            ctx.fillStyle = '#228B22';
            ctx.fillRect(x - 120, baseY - 100, 240, 100);
            
            // L√≠neas
            ctx.strokeStyle = '#FFF';
            ctx.lineWidth = 2;
            ctx.strokeRect(x - 115, baseY - 95, 230, 90);
            ctx.beginPath();
            ctx.moveTo(x, baseY - 95);
            ctx.lineTo(x, baseY - 5);
            ctx.stroke();
            ctx.beginPath();
            ctx.arc(x, baseY - 50, 25, 0, Math.PI * 2);
            ctx.stroke();
            
            // Arcos
            ctx.strokeStyle = '#FFF';
            ctx.strokeRect(x - 115, baseY - 70, 20, 40);
            ctx.strokeRect(x + 95, baseY - 70, 20, 40);
            
            // Pelota
            ctx.fillStyle = '#FFF';
            ctx.beginPath();
            ctx.arc(x, baseY - 50, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(x, baseY - 50, 4, 0, Math.PI * 2);
            ctx.fill();
            
            // 10 de Maradona flotando
            ctx.fillStyle = '#75AADB';
            ctx.font = 'bold 40px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('10', x, baseY - 120);
        }
        
        // IGLESIA/VATICANO - Nivel 8
        function drawIglesia(x, baseY) {
            // Cuerpo
            ctx.fillStyle = '#F5DEB3';
            ctx.fillRect(x - 80, baseY - 120, 160, 120);
            
            // Torres laterales
            ctx.fillRect(x - 90, baseY - 160, 30, 160);
            ctx.fillRect(x + 60, baseY - 160, 30, 160);
            
            // Cruces en torres
            ctx.fillStyle = '#FFD700';
            ctx.fillRect(x - 78, baseY - 180, 6, 25);
            ctx.fillRect(x - 85, baseY - 175, 20, 6);
            ctx.fillRect(x + 72, baseY - 180, 6, 25);
            ctx.fillRect(x + 65, baseY - 175, 20, 6);
            
            // C√∫pula central
            ctx.fillStyle = '#87CEEB';
            ctx.beginPath();
            ctx.arc(x, baseY - 140, 40, Math.PI, 0);
            ctx.fill();
            
            // Cruz central grande
            ctx.fillStyle = '#FFD700';
            ctx.fillRect(x - 4, baseY - 200, 8, 50);
            ctx.fillRect(x - 15, baseY - 190, 30, 8);
            
            // Puerta
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(x - 25, baseY - 80, 50, 80);
            ctx.beginPath();
            ctx.arc(x, baseY - 80, 25, Math.PI, 0);
            ctx.fill();
            
            // Vitrales
            ctx.fillStyle = '#FF6347';
            ctx.beginPath();
            ctx.arc(x, baseY - 100, 15, 0, Math.PI * 2);
            ctx.fill();
        }
        
        // CGT - Nivel 9
        function drawCGT(x, baseY) {
            // Edificio
            ctx.fillStyle = '#A9A9A9';
            ctx.fillRect(x - 90, baseY - 140, 180, 140);
            
            // Cartel CGT
            ctx.fillStyle = '#1E90FF';
            ctx.fillRect(x - 60, baseY - 130, 120, 40);
            ctx.fillStyle = '#FFF';
            ctx.font = 'bold 28px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('CGT', x, baseY - 100);
            
            // Ventanas
            ctx.fillStyle = '#4682B4';
            for (let row = 0; row < 3; row++) {
                for (let col = 0; col < 5; col++) {
                    ctx.fillRect(x - 70 + col * 30, baseY - 80 + row * 25, 20, 18);
                }
            }
            
            // Bandera sindical
            ctx.fillStyle = '#FF0000';
            ctx.fillRect(x - 95, baseY - 180, 30, 20);
            ctx.fillStyle = '#333';
            ctx.fillRect(x - 97, baseY - 180, 4, 50);
            
            // Pu√±os arriba (s√≠mbolo)
            ctx.fillStyle = '#FFD700';
            ctx.font = '30px Arial';
            ctx.fillText('‚úä', x - 30, baseY - 145);
            ctx.fillText('‚úä', x + 30, baseY - 145);
        }
        
        // COMODORO PY / C√ÅRCEL - Nivel 10
        function drawComodoroPy(x, baseY) {
            // Edificio tribunal
            ctx.fillStyle = '#696969';
            ctx.fillRect(x - 100, baseY - 150, 200, 150);
            
            // Rejas
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 4;
            for (let i = 0; i < 10; i++) {
                ctx.beginPath();
                ctx.moveTo(x - 90 + i * 20, baseY - 140);
                ctx.lineTo(x - 90 + i * 20, baseY - 10);
                ctx.stroke();
            }
            
            // Cartel LIBERTAD
            ctx.fillStyle = '#FF0000';
            ctx.fillRect(x - 70, baseY - 180, 140, 35);
            ctx.fillStyle = '#FFF';
            ctx.font = 'bold 18px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('LIBERTAD', x, baseY - 158);
            
            // Cadenas rotas
            ctx.fillStyle = '#FFD700';
            ctx.font = '35px Arial';
            ctx.fillText('‚õìÔ∏èüí•', x - 50, baseY - 100);
            ctx.fillText('üí•‚õìÔ∏è', x + 50, baseY - 100);
            
            // Silueta de Cristina
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(x, baseY - 80, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillRect(x - 12, baseY - 65, 24, 40);
            
            // Luz de esperanza
            ctx.fillStyle = 'rgba(255, 215, 0, 0.3)';
            ctx.beginPath();
            ctx.arc(x, baseY - 80, 50, 0, Math.PI * 2);
            ctx.fill();
        }

        function draw() {
            const level = LEVELS[currentLevel];
            
            // Limpiar canvas completamente
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Fondo estilo Mario Bros seg√∫n nivel
            drawBackground(currentLevel);
            
            
            drawDefenseTarget();
            drawJugador();
            drawPeron();
            drawMaradona();
            drawNestor();
            drawEvita();
            drawGrabois();
            drawMoreno();
            drawGato();
            drawHebe();
            drawLula();
            
            enemies.forEach(e => drawEnemy(e));
            empanadas.forEach(e => drawEmpanada(e));
            pelotas.forEach(p => drawPelota(p));
            proyectilesEnemigos.forEach(p => drawProyectilEnemigo(p));
            drawParticles();
            
            // *** EFECTOS DE VICTORIA ***
            if (showingVictoryEffects) {
                updateVictoryEffects();
                drawVictoryEffects();
            }
            
            if (allyMessageTimer > 0) {
                ctx.font = 'bold 18px Bangers';
                ctx.fillText(allyMessage, canvas.width / 2, canvas.height / 2);
            }
        }
        
        // GAME LOOP OPTIMIZADO
        let lastFrameTime = 0;
        
        function gameLoop(timestamp) {
            requestAnimationFrame(gameLoop);
            
            // Si est√° el modo infinito activo, no hacer nada
            if (infiniteModeActive) return;
            
            // Dibujar efectos de victoria aunque no est√© corriendo
            if (showingVictoryEffects) {
                updateVictoryEffects();
                draw();
            }
            
            // Solo actualizar si est√° corriendo y no pausado
            if (!gameRunning || gamePaused) return;
            
            // Limitar a ~60fps para consistencia
            if (timestamp - lastFrameTime < 14) return;
            lastFrameTime = timestamp;
            
            update();
            draw();
        }
        
        function updateUI() {
            const level = LEVELS[currentLevel];
            document.getElementById('score').textContent = 'üèÜ ' + score;
            document.getElementById('libertariosAbatidos').textContent = 'ü•ü Libervirgos empanadados: ' + libertariosAbatidos;
            document.getElementById('ammo').textContent = 'ü•ü ' + ammo + '/' + maxAmmo;
            document.getElementById('wave').textContent = 'Oleada ' + currentWave + '/' + level.waves;
            document.getElementById('level').textContent = 'NIVEL ' + (currentLevel + 1) + ': ' + level.icon;
            document.getElementById('vidas').textContent = '‚ù§Ô∏è'.repeat(Math.max(0, vidas));
            const hpPct = Math.round((defenseHP / maxDefenseHP) * 100);
            document.getElementById('defenseHP').textContent = 'üõ°Ô∏è ' + hpPct + '%';
        }
        
        function completeLevel() {
            gameRunning = false;
            
            // Audio del jugador al ganar (solo una vez, no repetir)
            if (!victoriaAudioPlayed) {
                victoriaAudioPlayed = true;
                playSound('victoria');
                const jugador = selectedCharacter || LEVELS[currentLevel].jugador;
                setTimeout(() => playPlayerAudio(jugador, 'victoria'), 300);
            }
            
            // Frase de Per√≥n para este nivel
            const fraseDelNivel = frasesPeronNivel[Math.min(currentLevel, frasesPeronNivel.length - 1)];
            
            if (currentLevel >= LEVELS.length - 1) {
                // ¬°VICTORIA FINAL - CRISTINA LIBRE!
                // La m√∫sica del nivel 10 sigue sonando
                document.getElementById('victoryTitle').textContent = '‚õìÔ∏èüí• ¬°CRISTINA LIBRE! üí•‚õìÔ∏è';
                document.getElementById('victorySubtitle').textContent = '¬°Derrotaste a Milei y Trump!';
                document.getElementById('victoryDesc').textContent = '¬°TODOS CON CRISTINA!';
                document.getElementById('victoryScore').textContent = 'üèÜ ' + score;
                document.getElementById('victoryAbatidos').textContent = 'üíÄ Libertarios abatidos: ' + libertariosAbatidos;
                document.getElementById('victoryScreen').classList.remove('hidden');
                
                // *** EFECTOS DE VICTORIA ***
                showingVictoryEffects = true;
                spawnConfetti();
                // Fuegos artificiales cada 500ms
                let fireworkCount = 0;
                const fireworkInterval = setInterval(() => {
                    spawnFirework();
                    fireworkCount++;
                    if (fireworkCount > 10) clearInterval(fireworkInterval);
                }, 500);
                
                // Frase final
                setTimeout(() => hablarPeron("¬°Volveremos y seremos millones!"), 500);
            } else {
                const next = LEVELS[currentLevel + 1];
                document.getElementById('levelTitle').textContent = '¬°NIVEL ' + (currentLevel + 1) + ' COMPLETADO!';
                document.getElementById('levelIcon').textContent = next.icon;
                document.getElementById('levelDesc').textContent = next.description;
                
                // Mostrar frase de Per√≥n
                document.getElementById('peronFrase').textContent = '"' + fraseDelNivel + '"';
                document.getElementById('peronFrase').style.display = 'block';
                
                // Actualizar dots para 10 niveles
                for (let i = 0; i < 10; i++) {
                    const dot = document.getElementById('dot' + (i + 1));
                    if (dot) {
                        dot.className = 'level-dot';
                        if (i < currentLevel + 1) dot.classList.add('completed');
                        else if (i === currentLevel + 1) dot.classList.add('current');
                    }
                }
                document.getElementById('levelTransition').classList.remove('hidden');
                
                // Per√≥n habla la frase
                setTimeout(() => hablarPeron(fraseDelNivel), 500);
            }
        }
        
        function startNextLevel() {
            currentLevel++;
            vidas = 3; // Reiniciar vidas al pasar de nivel
            initLevel();
            document.getElementById('levelTransition').classList.add('hidden');
            gameRunning = true;
        }
        
        function gameOver() {
            gameRunning = false;
            stopMusica(); // Parar m√∫sica
            playSound('gameover');
            const level = LEVELS[currentLevel];
            document.getElementById('gameOverText').textContent = '¬°Los libertarios llegaron a ' + level.name + '!';
            document.getElementById('finalScore').textContent = 'üèÜ ' + score;
            document.getElementById('finalAbatidos').textContent = 'ü•ü Libervirgos empanadados: ' + libertariosAbatidos;
            document.getElementById('gameOverScreen').classList.remove('hidden');
        }
        
        function initLevel() {
            const level = LEVELS[currentLevel];
            const diffMult = difficultyMultipliers[difficulty];
            
            currentWave = 1;
            enemies = [];
            empanadas = [];
            pelotas = [];
            proyectilesEnemigos = [];
            particles = [];
            
            // Aplicar dificultad
            spawnRate = level.spawnRateBase * diffMult.spawnRate;
            lastSpawn = Date.now();
            enemiesInWave = 0;
            defenseHP = Math.floor(level.defenseHP * diffMult.defenseHP);
            maxDefenseHP = defenseHP;
            
            // Resetear audios de enemigos (para que suenen 1 vez por nivel)
            enemyAudioPlayed = {};
            // victoriaAudioPlayed NO se resetea - solo suena 1 vez en todo el juego
            
            // M√∫sica de fondo del nivel
            playMusicaNivel(currentLevel + 1);
            
            // Audio del jugador al inicio - SOLO al comenzar el juego (nivel 1 o nuevo juego)
            const jugador = selectedCharacter || level.jugador;
            if (!inicioAudioPlayed) {
                inicioAudioPlayed = true;
                setTimeout(() => playPlayerAudio(jugador, 'inicio'), 500);
            }
            
            // Frase de Per√≥n si juega con √©l (despu√©s del audio de inicio)
            setTimeout(() => playPeronFrase(currentLevel + 1), 2000);
            
            // Resetear TODOS los aliados
            peronActive = false;
            maradonaActive = false;
            nestorActive = false;
            evitaActive = false;
            cristinaActive = false;
            graboisActive = false;
            morenoActive = false;
            gatoActive = false;
            hebeActive = false;
            lulaActive = false;
            
            // Activar aliado autom√°tico si existe (solo en nivel 10 - Evita)
            if (level.aliado === 'evita') {
                evitaActive = true;
                evitaBaseX = canvas.width * 0.75;
                evitaX = evitaBaseX;
            }
            
            // Munici√≥n seg√∫n nivel
            if (currentLevel === 0) {
                ammo = 20;
                maxAmmo = 20;
                vidas = 3;
            } else {
                ammo = Math.min(ammo + 10, maxAmmo);
            }
            
            // Mantener el personaje y arma seleccionados por el jugador
            if (selectedCharacter) {
                LEVELS[currentLevel].jugador = selectedCharacter;
            }
            if (selectedWeapon) {
                LEVELS[currentLevel].proyectil = selectedWeapon;
            }
            
            // Mostrar mensaje de aliado (desactivado - ya no usamos allies)
            allyMessage = '';
            allyMessageTimer = 0;
            
            tucuman.x = canvas.width / 2;
            tucumanSpeed = 0;
            targetX = null;
            moveLeft = false;
            moveRight = false;
            updateUI();
        }
        
        let selectedCharacter = null;
        let selectedWeapon = 'choripan'; // Arma por defecto
        
        function selectWeapon(weapon) {
            selectedWeapon = weapon;
            // Quitar selecci√≥n anterior
            document.querySelectorAll('.weapon-btn').forEach(btn => {
                btn.style.border = '2px solid transparent';
            });
            // Marcar seleccionado
            const btn = document.getElementById('weapon-' + weapon);
            if (btn) {
                btn.style.border = '2px solid #FFD700';
            }
        }
        
        function setDifficulty(diff) {
            difficulty = diff;
            // Actualizar botones
            document.getElementById('diff-facil').style.background = diff === 'facil' ? '#4CAF50' : 'transparent';
            document.getElementById('diff-facil').style.color = diff === 'facil' ? '#fff' : '#4CAF50';
            document.getElementById('diff-normal').style.background = diff === 'normal' ? '#FFC107' : 'transparent';
            document.getElementById('diff-normal').style.color = diff === 'normal' ? '#000' : '#FFC107';
            document.getElementById('diff-dificil').style.background = diff === 'dificil' ? '#F44336' : 'transparent';
            document.getElementById('diff-dificil').style.color = diff === 'dificil' ? '#fff' : '#F44336';
        }
        
        function showCharacterSelect() {
            gamePaused = true;
            document.getElementById('charSelectOverlay').classList.remove('hidden');
        }
        
        function hideCharacterSelect() {
            gamePaused = false;
            document.getElementById('charSelectOverlay').classList.add('hidden');
        }
        
        function changeCharacter(char) {
            // Cambiar personaje del nivel actual
            LEVELS[currentLevel].jugador = char;
            
            // Ajustar proyectil seg√∫n personaje
            if (char === 'maradona') {
                LEVELS[currentLevel].proyectil = 'pelota';
            } else if (char === 'hebe') {
                LEVELS[currentLevel].proyectil = 'panuelo';
            } else if (char === 'papa') {
                LEVELS[currentLevel].proyectil = 'cruz';
            } else if (char === 'kicillof') {
                LEVELS[currentLevel].proyectil = 'empanada';
            } else {
                LEVELS[currentLevel].proyectil = 'choripan';
            }
            
            hideCharacterSelect();
        }
        
        function selectCharacter(char) {
            selectedCharacter = char;
            // Quitar selecci√≥n anterior
            document.querySelectorAll('.char-btn').forEach(btn => {
                btn.style.border = '2px solid transparent';
                btn.style.background = 'rgba(255,255,255,0.1)';
            });
            // Marcar seleccionado
            const btn = document.getElementById('char-' + char);
            if (btn) {
                btn.style.border = '2px solid #FFD700';
                btn.style.background = 'rgba(255,215,0,0.3)';
            }
            // Mostrar nombre
            const names = {
                'kicillof': '¬°KICILLOF al ataque!',
                'grabois': '¬°GRABOIS lucha!',
                'moreno': '¬°MORENO controla!',
                'gato': '¬°El GATO Sylvestre!',
                'hebe': '¬°HEBE por la memoria!',
                'lula': '¬°LULA hermano!',
                'maradona': '¬°D10S Maradona!',
                'papa': '¬°El PAPA bendice!',
                'nestor': '¬°N√âSTOR vuelve!',
                'peron': '¬°PER√ìN conduce!'
            };
            document.getElementById('selectedCharName').textContent = names[char] || char;
            // Habilitar bot√≥n
            document.getElementById('playBtn').style.opacity = '1';
            document.getElementById('playBtn').style.pointerEvents = 'auto';
        }
        
        function startWithCharacter() {
            if (!selectedCharacter) return;
            initAudio(); // Inicializar audio
            score = 0;
            libertariosAbatidos = 0;
            currentLevel = 0;
            ammo = 25;
            maxAmmo = 25;
            vidas = 3;
            moveLeft = false;
            moveRight = false;
            victoriaAudioPlayed = false; // Resetear para juego nuevo
            inicioAudioPlayed = false; // Resetear para que suene audio de inicio
            
            // Resetear efectos de victoria
            showingVictoryEffects = false;
            confetti = [];
            fireworks = [];
            
            // Sobreescribir jugador y arma del nivel con los seleccionados
            LEVELS[0].jugador = selectedCharacter;
            LEVELS[0].proyectil = selectedWeapon;
            
            initLevel();
            document.getElementById('hud').classList.remove('hidden');
            // Mostrar controles m√≥viles si es m√≥vil
            if (isMobile) {
                document.getElementById('mobileControls').classList.remove('hidden');
            }
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameOverScreen').classList.add('hidden');
            document.getElementById('victoryScreen').classList.add('hidden');
            document.getElementById('levelTransition').classList.add('hidden');
            gameRunning = true;
            gamePaused = false;
        }
        
        function togglePause() {
            if (!gameRunning) return;
            gamePaused = !gamePaused;
            if (gamePaused) {
                document.getElementById('pauseScreen').classList.remove('hidden');
                document.getElementById('pauseBtn').textContent = '‚ñ∂Ô∏è';
            } else {
                document.getElementById('pauseScreen').classList.add('hidden');
                document.getElementById('pauseBtn').textContent = '‚è∏Ô∏è';
            }
        }
        
        function toggleSound() {
            audioEnabled = !audioEnabled;
            document.getElementById('soundBtn').textContent = audioEnabled ? 'üîä' : 'üîá';
        }
        
        function quitGame() {
            gameRunning = false;
            gamePaused = false;
            document.getElementById('pauseScreen').classList.add('hidden');
            document.getElementById('hud').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
        }
        
        function startGame() {
            // Iniciar audio (necesario en m√≥viles)
            initAudio();
            
            score = 0;
            libertariosAbatidos = 0;
            currentLevel = 0;
            ammo = 20;
            maxAmmo = 20;
            vidas = 3;
            moveLeft = false;
            moveRight = false;
            gamePaused = false;
            victoriaAudioPlayed = false;
            inicioAudioPlayed = false; // Resetear para que suene audio de inicio
            
            // Resetear jugador nivel 1 a Kicillof (modo historia)
            LEVELS[0].jugador = 'kicillof';
            LEVELS[0].proyectil = 'empanada';
            
            // Resetear pantalla de victoria
            document.getElementById('victoryTitle').textContent = 'üéâ ¬°VICTORIA! üéâ';
            document.getElementById('victorySubtitle').textContent = '¬°Salvaste la Patria!';
            document.getElementById('cristinaLibre').style.display = 'none';
            document.getElementById('victoryDesc').textContent = 'La Casa Hist√≥rica est√° a salvo';
            
            initLevel();
            document.getElementById('hud').classList.remove('hidden');
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameOverScreen').classList.add('hidden');
            document.getElementById('victoryScreen').classList.add('hidden');
            document.getElementById('levelTransition').classList.add('hidden');
            document.getElementById('pauseScreen').classList.add('hidden');
            gameRunning = true;
        }
        
        // Reintentar el nivel actual (despu√©s de morir)
        function retryLevel() {
            initAudio();
            vidas = 3;
            ammo = 20;
            maxAmmo = 20;
            // NO resetear score ni libertariosAbatidos para mantener progreso
            // NO resetear currentLevel para quedarse en el mismo nivel
            // NO resetear inicioAudioPlayed para que no vuelva a sonar
            
            initLevel();
            document.getElementById('hud').classList.remove('hidden');
            document.getElementById('gameOverScreen').classList.add('hidden');
            if (isMobile) {
                document.getElementById('mobileControls').classList.remove('hidden');
            }
            gameRunning = true;
        }
        
        // *** MODO INFINITO - PLATAFORMAS ***
        let infiniteModeActive = false;
        let infiniteWave = 0;
        let infiniteHighScore = 0;
        
        // Jugador en modo infinito
        let infPlayer = {
            x: 200,
            y: 400,
            vx: 0,
            vy: 0,
            width: 40,
            height: 50,
            onGround: false,
            jumping: false
        };
        
        // F√≠sica
        const GRAVITY = 0.6;
        const JUMP_FORCE = -14;
        const MOVE_SPEED = 5;
        const BOUNCE_FORCE = -10;
        
        // Plataformas
        let platforms = [];
        let infEnemies = [];
        let stones = []; // Piedras que tira el jugador
        let floorY = 500; // El piso que sube
        let infScore = 0;
        
        // Controles modo infinito
        let infMoveLeft = false;
        let infMoveRight = false;
        
        function startInfiniteMode() {
            console.log('Iniciando modo infinito...');
            initAudio();
            infiniteModeActive = true;
            gameRunning = false; // Parar juego principal primero
            showingVictoryEffects = false; // Desactivar efectos de victoria
            infiniteWave = 1;
            vidas = 5;
            infScore = 0;
            floorY = 500;
            
            // Reset jugador
            infPlayer.x = canvas.width / 2;
            infPlayer.y = 350;
            infPlayer.vx = 0;
            infPlayer.vy = 0;
            infPlayer.onGround = false;
            
            // Crear plataformas iniciales
            platforms = [];
            infEnemies = [];
            stones = [];
            
            // Plataforma base
            platforms.push({ x: 0, y: 450, width: canvas.width, height: 20 });
            
            // Plataformas iniciales
            for (let i = 0; i < 6; i++) {
                platforms.push({
                    x: Math.random() * (canvas.width - 100),
                    y: 350 - i * 80,
                    width: 80 + Math.random() * 60,
                    height: 15
                });
            }
            
            // M√∫sica aleatoria
            const randomLevel = Math.floor(Math.random() * 10) + 1;
            playMusicaNivel(randomLevel);
            
            // Ocultar pantallas
            document.getElementById('victoryScreen').classList.add('hidden');
            document.getElementById('hud').classList.add('hidden');
            document.getElementById('mobileControls').classList.add('hidden');
            
            gameRunning = true;
            gamePaused = false;
            
            console.log('Modo infinito activo, iniciando loop...');
            // Loop del modo infinito
            requestAnimationFrame(infiniteGameLoop);
        }
        
        function infiniteGameLoop() {
            if (!infiniteModeActive) {
                console.log('Modo infinito desactivado');
                return;
            }
            
            try {
                updateInfinite();
                drawInfinite();
            } catch(e) {
                console.error('Error en modo infinito:', e);
                return;
            }
            
            if (infiniteModeActive && gameRunning) {
                requestAnimationFrame(infiniteGameLoop);
            }
        }
        
        function updateInfinite() {
            if (!gameRunning || gamePaused) return;
            
            // Movimiento horizontal
            if (infMoveLeft) infPlayer.vx = -MOVE_SPEED;
            else if (infMoveRight) infPlayer.vx = MOVE_SPEED;
            else infPlayer.vx *= 0.8; // Fricci√≥n
            
            // Gravedad
            infPlayer.vy += GRAVITY;
            
            // Mover jugador
            infPlayer.x += infPlayer.vx;
            infPlayer.y += infPlayer.vy;
            
            // L√≠mites horizontales
            if (infPlayer.x < 0) infPlayer.x = 0;
            if (infPlayer.x > canvas.width - infPlayer.width) infPlayer.x = canvas.width - infPlayer.width;
            
            // Colisi√≥n con plataformas
            infPlayer.onGround = false;
            for (let plat of platforms) {
                if (infPlayer.vy > 0 && // Cayendo
                    infPlayer.x + infPlayer.width > plat.x &&
                    infPlayer.x < plat.x + plat.width &&
                    infPlayer.y + infPlayer.height > plat.y &&
                    infPlayer.y + infPlayer.height < plat.y + plat.height + 15) {
                    
                    infPlayer.y = plat.y - infPlayer.height;
                    infPlayer.vy = 0;
                    infPlayer.onGround = true;
                    infPlayer.jumping = false;
                }
            }
            
            // Colisi√≥n con enemigos
            for (let i = infEnemies.length - 1; i >= 0; i--) {
                let e = infEnemies[i];
                
                // Mover enemigo
                e.x += e.vx;
                if (e.x < e.minX || e.x > e.maxX) e.vx *= -1;
                
                // Colisi√≥n con jugador
                if (infPlayer.x + infPlayer.width > e.x &&
                    infPlayer.x < e.x + e.width &&
                    infPlayer.y + infPlayer.height > e.y &&
                    infPlayer.y < e.y + e.height) {
                    
                    // ¬øCayendo sobre el enemigo?
                    if (infPlayer.vy > 0 && infPlayer.y + infPlayer.height < e.y + e.height / 2) {
                        // Matar enemigo
                        infEnemies.splice(i, 1);
                        infPlayer.vy = BOUNCE_FORCE;
                        infScore += 100;
                        playEnemyAudio(e);
                        
                        // Part√≠culas
                        for (let p = 0; p < 10; p++) {
                            particles.push({
                                x: e.x + e.width/2,
                                y: e.y,
                                vx: (Math.random() - 0.5) * 8,
                                vy: -Math.random() * 5,
                                life: 30,
                                color: '#FFD700'
                            });
                        }
                    } else {
                        // Da√±o al jugador
                        vidas--;
                        playSound('dano');
                        infPlayer.vy = -8;
                        infPlayer.x += (infPlayer.x < e.x) ? -50 : 50;
                        
                        if (vidas <= 0) {
                            infiniteGameOver();
                            return;
                        }
                    }
                }
            }
            
            // Colisi√≥n piedras con enemigos
            for (let i = stones.length - 1; i >= 0; i--) {
                let s = stones[i];
                s.x += s.vx;
                s.y += s.vy;
                s.vy += 0.3; // Gravedad piedra
                
                // Fuera de pantalla
                if (s.y > canvas.height || s.x < 0 || s.x > canvas.width) {
                    stones.splice(i, 1);
                    continue;
                }
                
                // Colisi√≥n con enemigos
                for (let j = infEnemies.length - 1; j >= 0; j--) {
                    let e = infEnemies[j];
                    if (s.x > e.x && s.x < e.x + e.width &&
                        s.y > e.y && s.y < e.y + e.height) {
                        
                        e.hp--;
                        stones.splice(i, 1);
                        
                        if (e.hp <= 0) {
                            infEnemies.splice(j, 1);
                            infScore += 50;
                            playEnemyAudio(e);
                        }
                        break;
                    }
                }
            }
            
            // El piso sube gradualmente
            floorY -= 0.02 + (infiniteWave * 0.005);
            
            // Si el jugador cae al piso que sube o abajo de pantalla
            if (infPlayer.y > floorY || infPlayer.y > canvas.height) {
                vidas--;
                playSound('dano');
                if (vidas <= 0) {
                    infiniteGameOver();
                    return;
                }
                // Respawn en plataforma m√°s alta visible
                let highestPlat = platforms.reduce((a, b) => a.y < b.y ? a : b);
                infPlayer.x = highestPlat.x + highestPlat.width / 2;
                infPlayer.y = highestPlat.y - infPlayer.height - 10;
                infPlayer.vy = 0;
            }
            
            // Scroll de c√°mara - subir plataformas si jugador sube mucho
            if (infPlayer.y < 200) {
                let diff = 200 - infPlayer.y;
                infPlayer.y = 200;
                
                for (let plat of platforms) {
                    plat.y += diff;
                }
                for (let e of infEnemies) {
                    e.y += diff;
                }
                floorY += diff;
                
                infScore += Math.floor(diff);
            }
            
            // Eliminar plataformas que salieron de pantalla
            platforms = platforms.filter(p => p.y < canvas.height + 50);
            infEnemies = infEnemies.filter(e => e.y < canvas.height + 50);
            
            // Generar nuevas plataformas arriba
            let topPlat = Math.min(...platforms.map(p => p.y));
            while (topPlat > -50) {
                let newPlat = {
                    x: Math.random() * (canvas.width - 100),
                    y: topPlat - 70 - Math.random() * 40,
                    width: 70 + Math.random() * 50,
                    height: 15
                };
                platforms.push(newPlat);
                topPlat = newPlat.y;
                
                // Posibilidad de enemigo en la plataforma
                if (Math.random() > 0.5) {
                    spawnInfiniteEnemy(newPlat);
                }
                
                // Nueva oleada cada cierta altura
                if (platforms.length % 15 === 0) {
                    infiniteWave++;
                    if (infiniteWave % 5 === 0) {
                        vidas = Math.min(vidas + 1, 10);
                        const randomLevel = Math.floor(Math.random() * 10) + 1;
                        playMusicaNivel(randomLevel);
                    }
                }
            }
            
            // Actualizar part√≠culas
            for (let i = particles.length - 1; i >= 0; i--) {
                let p = particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.vy += 0.2;
                p.life--;
                if (p.life <= 0) particles.splice(i, 1);
            }
        }
        
        function spawnInfiniteEnemy(platform) {
            const allTypes = [0, 1, 2, 3, 4, 5, 6, 7, 9, 11, 13, 14];
            const type = allTypes[Math.floor(Math.random() * allTypes.length)];
            
            let enemy = {
                x: platform.x + 10,
                y: platform.y - 45,
                width: 35,
                height: 45,
                vx: (Math.random() > 0.5 ? 1 : -1) * (1 + infiniteWave * 0.1),
                minX: platform.x,
                maxX: platform.x + platform.width - 35,
                type: type,
                hp: 1 + Math.floor(infiniteWave / 5)
            };
            
            if (type === 1) {
                enemy.periodistaIdx = Math.floor(Math.random() * 6);
            }
            
            infEnemies.push(enemy);
        }
        
        function drawInfinite() {
            console.log('Dibujando modo infinito...');
            
            // Fondo degradado
            let gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#1a0033');
            gradient.addColorStop(1, '#4a0066');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Piso que sube (lava/peligro)
            ctx.fillStyle = '#FF4500';
            ctx.fillRect(0, floorY, canvas.width, canvas.height - floorY + 100);
            ctx.fillStyle = '#FF6600';
            for (let i = 0; i < canvas.width; i += 20) {
                ctx.beginPath();
                ctx.arc(i + 10, floorY, 8 + Math.sin(Date.now()/200 + i) * 3, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // Plataformas
            for (let plat of platforms) {
                ctx.fillStyle = '#8B4513';
                ctx.fillRect(plat.x, plat.y, plat.width, plat.height);
                ctx.fillStyle = '#A0522D';
                ctx.fillRect(plat.x, plat.y, plat.width, 5);
            }
            
            // Enemigos
            for (let e of infEnemies) {
                drawEnemyByType(e.x + e.width/2, e.y + e.height, e);
            }
            
            // Piedras
            ctx.fillStyle = '#888';
            for (let s of stones) {
                ctx.beginPath();
                ctx.arc(s.x, s.y, 8, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#666';
                ctx.beginPath();
                ctx.arc(s.x - 2, s.y - 2, 3, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#888';
            }
            
            // Jugador
            drawInfinitePlayer();
            
            // Part√≠culas
            for (let p of particles) {
                ctx.fillStyle = p.color;
                ctx.globalAlpha = p.life / 30;
                ctx.beginPath();
                ctx.arc(p.x, p.y, 4, 0, Math.PI * 2);
                ctx.fill();
            }
            ctx.globalAlpha = 1;
            
            // HUD
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 20px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('üî• OLEADA: ' + infiniteWave, 10, 30);
            ctx.fillText('üèÜ ' + infScore, 10, 55);
            ctx.fillText('‚ù§Ô∏è'.repeat(Math.max(0, vidas)), 10, 80);
            
            ctx.textAlign = 'right';
            ctx.fillText('R√©cord: ' + infiniteHighScore, canvas.width - 10, 30);
            
            // Instrucciones
            ctx.textAlign = 'center';
            ctx.font = '12px Arial';
            ctx.fillStyle = 'rgba(255,255,255,0.5)';
            ctx.fillText('‚Üê ‚Üí Mover | ESPACIO Saltar | CLICK Tirar piedra', canvas.width/2, canvas.height - 10);
        }
        
        function drawInfinitePlayer() {
            const x = infPlayer.x + infPlayer.width / 2;
            const y = infPlayer.y + infPlayer.height;
            
            // Usar sprite del personaje seleccionado
            const character = selectedCharacter || 'peron';
            if (sprites[character]) {
                const img = sprites[character];
                const scale = 0.8;
                ctx.drawImage(img, x - (img.width * scale)/2, y - img.height * scale, img.width * scale, img.height * scale);
            } else {
                // Fallback
                ctx.fillStyle = '#75AADB';
                ctx.fillRect(infPlayer.x, infPlayer.y, infPlayer.width, infPlayer.height);
            }
        }
        
        function drawEnemyByType(x, y, e) {
            // Reutilizar funciones de dibujo existentes
            if (e.type === 0) drawMilei(x, y, e);
            else if (e.type === 1) drawPeriodista(x, y, e);
            else if (e.type === 2) drawKarina(x, y, e);
            else if (e.type === 3) drawBullrich(x, y, e);
            else if (e.type === 4) drawCaputo(x, y, e);
            else if (e.type === 5) drawPolicia(x, y, e);
            else if (e.type === 6) drawAdorni(x, y, e);
            else if (e.type === 7) drawSturzenegger(x, y, e);
            else if (e.type === 9) drawMacri(x, y, e);
            else if (e.type === 11) drawPotobellocchia(x, y, e);
            else if (e.type === 13) drawTrumpSolo(x, y, e);
            else if (e.type === 14) drawEspert(x, y, e);
            else {
                // Fallback
                ctx.fillStyle = '#f00';
                ctx.fillRect(x - 15, y - 40, 30, 40);
            }
        }
        
        function infiniteJump() {
            if (infPlayer.onGround && !infPlayer.jumping) {
                infPlayer.vy = JUMP_FORCE;
                infPlayer.jumping = true;
                infPlayer.onGround = false;
                playSound('disparo');
            }
        }
        
        function throwStone(targetX, targetY) {
            const dx = targetX - (infPlayer.x + infPlayer.width/2);
            const dy = targetY - (infPlayer.y + infPlayer.height/2);
            const dist = Math.sqrt(dx*dx + dy*dy);
            
            stones.push({
                x: infPlayer.x + infPlayer.width/2,
                y: infPlayer.y + infPlayer.height/2,
                vx: (dx / dist) * 10,
                vy: (dy / dist) * 8
            });
            
            playSound('disparo');
        }
        
        function infiniteGameOver() {
            gameRunning = false;
            infiniteModeActive = false;
            stopMusica();
            playSound('gameover');
            
            if (infScore > infiniteHighScore) {
                infiniteHighScore = infScore;
            }
            
            document.getElementById('gameOverText').textContent = 'üî• MODO INFINITO - Oleada ' + infiniteWave;
            document.getElementById('finalScore').textContent = 'üèÜ ' + infScore + (infScore >= infiniteHighScore ? ' ¬°NUEVO R√âCORD!' : '');
            document.getElementById('finalAbatidos').textContent = 'R√©cord: ' + infiniteHighScore;
            document.getElementById('gameOverScreen').classList.remove('hidden');
        }
        
        // Controles modo infinito
        document.addEventListener('keydown', (e) => {
            if (!infiniteModeActive) return;
            if (e.key === 'ArrowLeft' || e.key === 'a') infMoveLeft = true;
            if (e.key === 'ArrowRight' || e.key === 'd') infMoveRight = true;
            if (e.key === ' ' || e.key === 'ArrowUp' || e.key === 'w') {
                e.preventDefault();
                infiniteJump();
            }
        });
        
        document.addEventListener('keyup', (e) => {
            if (!infiniteModeActive) return;
            if (e.key === 'ArrowLeft' || e.key === 'a') infMoveLeft = false;
            if (e.key === 'ArrowRight' || e.key === 'd') infMoveRight = false;
        });
        
        // Touch/click para modo infinito
        canvas.addEventListener('click', (e) => {
            if (!infiniteModeActive || !gameRunning) return;
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            throwStone(x, y);
        });
        
        canvas.addEventListener('touchstart', (e) => {
            if (!infiniteModeActive || !gameRunning) return;
            e.preventDefault();
            const rect = canvas.getBoundingClientRect();
            const touch = e.touches[0];
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;
            
            // Si toca abajo, saltar. Si toca arriba, tirar piedra
            if (y > canvas.height * 0.7) {
                // Mover hacia donde toca
                if (x < canvas.width / 3) {
                    infMoveLeft = true;
                    infMoveRight = false;
                } else if (x > canvas.width * 2/3) {
                    infMoveRight = true;
                    infMoveLeft = false;
                } else {
                    infiniteJump();
                }
            } else {
                throwStone(x, y);
            }
        }, { passive: false });
        
        canvas.addEventListener('touchend', (e) => {
            if (!infiniteModeActive) return;
            infMoveLeft = false;
            infMoveRight = false;
        });
        
        // *** CONTROLES T√ÅCTILES - OPTIMIZADO ***
        let isTouching = false;
        
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (!gameRunning || gamePaused) return;
            isTouching = true;
            const rect = canvas.getBoundingClientRect();
            const touchX = e.touches[0].clientX - rect.left;
            const touchY = e.touches[0].clientY - rect.top;
            
            if (touchY < canvas.height * 0.5) {
                // Mitad superior: disparar
                shootEmpanada(touchX, touchY);
            } else {
                // Mitad inferior: mover
                targetX = touchX;
                lastTouchX = touchX;
            }
        }, { passive: false });
        
        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            if (!gameRunning || !isTouching || gamePaused) return;
            const rect = canvas.getBoundingClientRect();
            const touchX = e.touches[0].clientX - rect.left;
            targetX = touchX;
            lastTouchX = touchX;
        }, { passive: false });
        
        canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            isTouching = false;
            targetX = null;
        }, { passive: false });
        
        canvas.addEventListener('touchcancel', (e) => {
            isTouching = false;
            targetX = null;
        }, { passive: false });
        
        // *** CONTROLES M√ìVILES (BOTONES) ***
        let mobileLeft = false;
        let mobileRight = false;
        
        if (isMobile) {
            const btnLeft = document.getElementById('btnLeft');
            const btnRight = document.getElementById('btnRight');
            const btnShoot = document.getElementById('btnShoot');
            
            btnLeft.addEventListener('touchstart', (e) => {
                e.preventDefault();
                mobileLeft = true;
                moveLeft = true;
            }, { passive: false });
            
            btnLeft.addEventListener('touchend', (e) => {
                e.preventDefault();
                mobileLeft = false;
                moveLeft = false;
            }, { passive: false });
            
            btnRight.addEventListener('touchstart', (e) => {
                e.preventDefault();
                mobileRight = true;
                moveRight = true;
            }, { passive: false });
            
            btnRight.addEventListener('touchend', (e) => {
                e.preventDefault();
                mobileRight = false;
                moveRight = false;
            }, { passive: false });
            
            btnShoot.addEventListener('touchstart', (e) => {
                e.preventDefault();
                if (gameRunning && !gamePaused) {
                    // Disparar hacia arriba al centro
                    shootEmpanada(tucuman.x, 0);
                }
            }, { passive: false });
        }
        
        // *** CONTROLES DE TECLADO ***
        document.addEventListener('keydown', (e) => {
            if (!gameRunning) return;
            if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
                moveLeft = true;
                targetX = null;
            }
            if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
                moveRight = true;
                targetX = null;
            }
            if (e.key === ' ' || e.key === 'ArrowUp' || e.key === 'w' || e.key === 'W') {
                e.preventDefault();
                shootEmpanada(tucuman.x, 0);
            }
        });
        
        document.addEventListener('keyup', (e) => {
            if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') moveLeft = false;
            if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') moveRight = false;
        });
        
        // Click para disparar (PC)
        canvas.addEventListener('click', (e) => {
            if (!gameRunning || gamePaused) return;
            const rect = canvas.getBoundingClientRect();
            shootEmpanada(e.clientX - rect.left, e.clientY - rect.top);
        });
        
        gameLoop();
        
        // ============================================
        // INTRO CINEM√ÅTICA
        // ============================================
        const introCanvas = document.getElementById('introCanvas');
        const ictx = introCanvas.getContext('2d');
        let introPhase = 0;
        let introTimer = 0;
        let introRunning = true;
        let bikeX = -100;
        let sunY = 300;
        let textOpacity = 0;
        let libertariosX = [];
        let tucumanBajado = false;
        let tucumanMirandoArriba = false;
        let cristinaVisible = 0;
        
        function initIntro() {
            introCanvas.width = canvas.width;
            introCanvas.height = canvas.height;
            introPhase = 0;
            introTimer = 0;
            introRunning = true;
            bikeX = -100;
            sunY = introCanvas.height * 0.6;
            textOpacity = 0;
            tucumanBajado = false;
            tucumanMirandoArriba = false;
            cristinaVisible = 0;
            // Generar posiciones de libertarios con velocidad
            libertariosX = [];
            for (let i = 0; i < 12; i++) {
                libertariosX.push({
                    x: introCanvas.width * 0.4 + i * 25 + Math.random() * 20,
                    y: introCanvas.height * 0.55 + Math.random() * 30,
                    vx: (Math.random() - 0.5) * 1.5,
                    armUp: Math.random() > 0.5,
                    chocando: 0
                });
            }
            requestAnimationFrame(runIntro);
        }
        
        function drawIntroMountains() {
            // Monta√±as de fondo
            ictx.fillStyle = '#2d4a3e';
            ictx.beginPath();
            ictx.moveTo(0, introCanvas.height * 0.5);
            ictx.lineTo(introCanvas.width * 0.2, introCanvas.height * 0.25);
            ictx.lineTo(introCanvas.width * 0.4, introCanvas.height * 0.45);
            ictx.lineTo(introCanvas.width * 0.6, introCanvas.height * 0.2);
            ictx.lineTo(introCanvas.width * 0.8, introCanvas.height * 0.4);
            ictx.lineTo(introCanvas.width, introCanvas.height * 0.3);
            ictx.lineTo(introCanvas.width, introCanvas.height);
            ictx.lineTo(0, introCanvas.height);
            ictx.fill();
            
            // Monta√±as m√°s claras
            ictx.fillStyle = '#3d5a4e';
            ictx.beginPath();
            ictx.moveTo(0, introCanvas.height * 0.55);
            ictx.lineTo(introCanvas.width * 0.3, introCanvas.height * 0.35);
            ictx.lineTo(introCanvas.width * 0.5, introCanvas.height * 0.5);
            ictx.lineTo(introCanvas.width * 0.7, introCanvas.height * 0.38);
            ictx.lineTo(introCanvas.width, introCanvas.height * 0.45);
            ictx.lineTo(introCanvas.width, introCanvas.height);
            ictx.lineTo(0, introCanvas.height);
            ictx.fill();
        }
        
        function drawIntroSun() {
            // Rayos de sol
            const sunCenterX = introCanvas.width * 0.7;
            const sunCenterY = sunY;
            
            for (let i = 0; i < 12; i++) {
                const angle = (i / 12) * Math.PI * 2 + introTimer * 0.01;
                ictx.beginPath();
                ictx.moveTo(sunCenterX, sunCenterY);
                ictx.lineTo(
                    sunCenterX + Math.cos(angle) * 150,
                    sunCenterY + Math.sin(angle) * 150
                );
                ictx.lineTo(
                    sunCenterX + Math.cos(angle + 0.2) * 150,
                    sunCenterY + Math.sin(angle + 0.2) * 150
                );
                ictx.fill();
            }
            
            // Sol
            const gradient = ictx.createRadialGradient(sunCenterX, sunCenterY, 0, sunCenterX, sunCenterY, 60);
            gradient.addColorStop(0, '#FFF700');
            gradient.addColorStop(0.5, '#FFD700');
            gradient.addColorStop(1, '#FFA500');
            ictx.fillStyle = gradient;
            ictx.beginPath();
            ictx.arc(sunCenterX, sunCenterY, 50, 0, Math.PI * 2);
            ictx.fill();
        }
        
        function drawIntroTucuman() {
            const x = bikeX;
            const baseY = introCanvas.height * 0.65;
            
            if (!tucumanBajado) {
                // EN LA BICI
                const y = baseY;
                
                // Bicicleta
                ictx.strokeStyle = '#333';
                ictx.lineWidth = 3;
                // Ruedas
                ictx.beginPath();
                ictx.arc(x - 20, y + 25, 15, 0, Math.PI * 2);
                ictx.stroke();
                ictx.beginPath();
                ictx.arc(x + 25, y + 25, 15, 0, Math.PI * 2);
                ictx.stroke();
                // Cuadro
                ictx.beginPath();
                ictx.moveTo(x - 20, y + 25);
                ictx.lineTo(x, y);
                ictx.lineTo(x + 25, y + 25);
                ictx.lineTo(x, y + 10);
                ictx.lineTo(x - 20, y + 25);
                ictx.stroke();
                // Manubrio
                ictx.beginPath();
                ictx.moveTo(x + 25, y + 25);
                ictx.lineTo(x + 25, y + 5);
                ictx.lineTo(x + 35, y + 5);
                ictx.stroke();
                
                // TUCU-MAN en la bici
                // Cuerpo
                ictx.fillStyle = '#75AADB';
                ictx.fillRect(x - 5, y - 35, 20, 30);
                // Cabeza
                ictx.fillStyle = '#DEB887';
                ictx.beginPath();
                ictx.arc(x + 5, y - 45, 12, 0, Math.PI * 2);
                ictx.fill();
                // M√°scara
                ictx.fillStyle = '#75AADB';
                ictx.fillRect(x - 5, y - 50, 20, 8);
                // Ojos
                ictx.fillStyle = '#fff';
                ictx.beginPath();
                ictx.arc(x + 1, y - 47, 3, 0, Math.PI * 2);
                ictx.arc(x + 9, y - 47, 3, 0, Math.PI * 2);
                ictx.fill();
                
                // CAPA = BANDERA ARGENTINA FLAMEANDO
                const waveOffset = Math.sin(introTimer * 0.15) * 8;
                const waveOffset2 = Math.sin(introTimer * 0.15 + 1) * 6;
                const waveOffset3 = Math.sin(introTimer * 0.15 + 2) * 7;
                
                // Franja celeste superior
                ictx.fillStyle = '#75AADB';
                ictx.beginPath();
                ictx.moveTo(x - 5, y - 32);
                ictx.quadraticCurveTo(x - 35 + waveOffset, y - 28, x - 55 + waveOffset2, y - 25);
                ictx.quadraticCurveTo(x - 50 + waveOffset, y - 20, x - 55 + waveOffset3, y - 15);
                ictx.lineTo(x - 5, y - 18);
                ictx.closePath();
                ictx.fill();
                
                // Franja blanca central
                ictx.fillStyle = '#FFFFFF';
                ictx.beginPath();
                ictx.moveTo(x - 5, y - 18);
                ictx.quadraticCurveTo(x - 40 + waveOffset2, y - 12, x - 55 + waveOffset3, y - 15);
                ictx.quadraticCurveTo(x - 50 + waveOffset3, y - 5, x - 55 + waveOffset, y);
                ictx.lineTo(x - 5, y - 5);
                ictx.closePath();
                ictx.fill();
                
                // Sol de Mayo en la franja blanca
                const solX = x - 40 + waveOffset2 * 0.5;
                const solY = y - 10;
                ictx.fillStyle = '#F9A825';
                ictx.beginPath();
                ictx.arc(solX, solY, 5, 0, Math.PI * 2);
                ictx.fill();
                for (let i = 0; i < 8; i++) {
                    const rayAngle = (i / 8) * Math.PI * 2;
                    ictx.beginPath();
                    ictx.moveTo(solX + Math.cos(rayAngle) * 5, solY + Math.sin(rayAngle) * 5);
                    ictx.lineTo(solX + Math.cos(rayAngle) * 9, solY + Math.sin(rayAngle) * 9);
                    ictx.strokeStyle = '#F9A825';
                    ictx.lineWidth = 1.5;
                    ictx.stroke();
                }
                
                // Franja celeste inferior
                ictx.fillStyle = '#75AADB';
                ictx.beginPath();
                ictx.moveTo(x - 5, y - 5);
                ictx.quadraticCurveTo(x - 40 + waveOffset3, y + 2, x - 55 + waveOffset, y);
                ictx.quadraticCurveTo(x - 45 + waveOffset2, y + 10, x - 50 + waveOffset, y + 12);
                ictx.lineTo(x - 5, y + 5);
                ictx.closePath();
                ictx.fill();
                
                // Piernas pedaleando
                const pedalAngle = introTimer * 0.3;
                ictx.fillStyle = '#1a1a1a';
                ictx.beginPath();
                ictx.arc(x + Math.cos(pedalAngle) * 10, y + 10 + Math.sin(pedalAngle) * 8, 5, 0, Math.PI * 2);
                ictx.arc(x + Math.cos(pedalAngle + Math.PI) * 10, y + 10 + Math.sin(pedalAngle + Math.PI) * 8, 5, 0, Math.PI * 2);
                ictx.fill();
            } else {
                // BAJADO DE LA BICI
                const y = baseY + 10;
                
                // Bicicleta estacionada al costado
                ictx.strokeStyle = '#333';
                ictx.lineWidth = 3;
                ictx.beginPath();
                ictx.arc(x - 40, y + 25, 12, 0, Math.PI * 2);
                ictx.stroke();
                ictx.beginPath();
                ictx.arc(x - 10, y + 25, 12, 0, Math.PI * 2);
                ictx.stroke();
                
                // TUCU-MAN parado
                // Piernas
                ictx.fillStyle = '#1a1a1a';
                ictx.fillRect(x + 15, y + 5, 10, 30);
                ictx.fillRect(x + 30, y + 5, 10, 30);
                
                // Cuerpo
                ictx.fillStyle = '#75AADB';
                ictx.fillRect(x + 10, y - 35, 30, 42);
                
                // Cabeza
                ictx.fillStyle = '#DEB887';
                ictx.beginPath();
                if (tucumanMirandoArriba) {
                    // Mirando arriba
                    ictx.arc(x + 25, y - 48, 14, 0, Math.PI * 2);
                } else {
                    ictx.arc(x + 25, y - 45, 14, 0, Math.PI * 2);
                }
                ictx.fill();
                
                // M√°scara
                ictx.fillStyle = '#75AADB';
                if (tucumanMirandoArriba) {
                    ictx.fillRect(x + 13, y - 58, 24, 10);
                } else {
                    ictx.fillRect(x + 13, y - 53, 24, 10);
                }
                
                // Ojos
                ictx.fillStyle = '#fff';
                ictx.beginPath();
                if (tucumanMirandoArriba) {
                    // Ojos mirando arriba
                    ictx.arc(x + 20, y - 54, 4, 0, Math.PI * 2);
                    ictx.arc(x + 30, y - 54, 4, 0, Math.PI * 2);
                } else {
                    ictx.arc(x + 20, y - 48, 4, 0, Math.PI * 2);
                    ictx.arc(x + 30, y - 48, 4, 0, Math.PI * 2);
                }
                ictx.fill();
                
                // Pupilas mirando arriba
                ictx.fillStyle = '#000';
                ictx.beginPath();
                if (tucumanMirandoArriba) {
                    ictx.arc(x + 20, y - 56, 2, 0, Math.PI * 2);
                    ictx.arc(x + 30, y - 56, 2, 0, Math.PI * 2);
                } else {
                    ictx.arc(x + 20, y - 48, 2, 0, Math.PI * 2);
                    ictx.arc(x + 30, y - 48, 2, 0, Math.PI * 2);
                }
                ictx.fill();
                
                // CAPA = BANDERA ARGENTINA colgando
                const waveOffset = Math.sin(introTimer * 0.1) * 3;
                
                // Franja celeste superior
                ictx.fillStyle = '#75AADB';
                ictx.beginPath();
                ictx.moveTo(x + 10, y - 30);
                ictx.lineTo(x - 15 + waveOffset, y - 25);
                ictx.lineTo(x - 18 + waveOffset, y - 15);
                ictx.lineTo(x + 10, y - 20);
                ictx.closePath();
                ictx.fill();
                
                // Franja blanca
                ictx.fillStyle = '#FFFFFF';
                ictx.beginPath();
                ictx.moveTo(x + 10, y - 20);
                ictx.lineTo(x - 18 + waveOffset, y - 15);
                ictx.lineTo(x - 20 + waveOffset, y);
                ictx.lineTo(x + 10, y - 5);
                ictx.closePath();
                ictx.fill();
                
                // Sol peque√±o
                ictx.fillStyle = '#F9A825';
                ictx.beginPath();
                ictx.arc(x - 5, y - 12, 4, 0, Math.PI * 2);
                ictx.fill();
                
                // Franja celeste inferior
                ictx.fillStyle = '#75AADB';
                ictx.beginPath();
                ictx.moveTo(x + 10, y - 5);
                ictx.lineTo(x - 20 + waveOffset, y);
                ictx.lineTo(x - 22 + waveOffset, y + 15);
                ictx.lineTo(x + 10, y + 8);
                ictx.closePath();
                ictx.fill();
            }
        }
        
        function drawIntroLibertarios() {
            // Cuando aparece Cristina, HUYEN
            const huyendo = cristinaVisible > 0.3;
            
            // Actualizar posiciones - SE CHOCAN ENTRE S√ç o HUYEN
            libertariosX.forEach((lib, i) => {
                if (huyendo) {
                    // HUYEN hacia la derecha - ESCALONADO (los de adelante primero)
                    const delay = i * 0.05; // Cada uno espera un poco m√°s
                    if (cristinaVisible > 0.3 + delay) {
                        lib.vx = 1.2 + (i * 0.1);
                        lib.x += lib.vx;
                        lib.huyendo = true;
                    }
                } else {
                    // Movimiento err√°tico normal
                    lib.vx = lib.vx || (Math.random() - 0.5) * 2;
                    lib.x += lib.vx;
                    
                    // Rebotan en los bordes
                    if (lib.x < introCanvas.width * 0.35 || lib.x > introCanvas.width * 0.9) {
                        lib.vx *= -1;
                        lib.chocando = 10;
                    }
                    
                    // Chocan entre s√≠
                    libertariosX.forEach((other, j) => {
                        if (i !== j) {
                            const dist = Math.abs(lib.x - other.x);
                            if (dist < 25 && Math.abs(lib.y - other.y) < 20) {
                                lib.vx *= -1;
                                other.vx *= -1;
                                lib.chocando = 15;
                                other.chocando = 15;
                            }
                        }
                    });
                }
                
                if (lib.chocando > 0) lib.chocando--;
            });
            
            // Solo dibujar si no se fueron de la pantalla
            libertariosX.forEach((lib, i) => {
                if (lib.x > introCanvas.width + 50) return; // Ya se fue
                
                const x = lib.x;
                const y = lib.y;
                const armWave = Math.sin(introTimer * 0.1 + i) * 5;
                const isChocando = lib.chocando > 0;
                const isHuyendo = lib.huyendo;
                
                // Si est√° chocando o huyendo, se tambalea
                const tambaleo = isChocando ? Math.sin(introTimer * 0.5) * 8 : 0;
                
                ictx.save();
                ictx.translate(x, y);
                ictx.rotate(tambaleo * 0.05);
                
                // Si huye, inclinado hacia adelante
                if (isHuyendo) {
                    ictx.rotate(0.2);
                }
                
                // Cuerpo violeta
                ictx.fillStyle = '#8B008B';
                ictx.fillRect(-8, 0, 16, 25);
                
                // Cabeza
                ictx.fillStyle = '#DEB887';
                ictx.beginPath();
                ictx.arc(0, -8, 8, 0, Math.PI * 2);
                ictx.fill();
                
                // Cara de tonto o de miedo
                // Ojos
                ictx.fillStyle = '#fff';
                ictx.beginPath();
                if (isHuyendo) {
                    // Ojos de p√°nico - m√°s grandes
                    ictx.arc(-3, -10, 4, 0, Math.PI * 2);
                    ictx.arc(3, -10, 4, 0, Math.PI * 2);
                } else {
                    // Ojos bizcos normales
                    ictx.arc(-3, -10, 3, 0, Math.PI * 2);
                    ictx.arc(3, -10, 3, 0, Math.PI * 2);
                }
                ictx.fill();
                
                // Pupilas
                ictx.fillStyle = '#000';
                const eyeDir = isHuyendo ? 1 : (i % 3) - 1;
                ictx.beginPath();
                ictx.arc(-3 + eyeDir, -10, 1.5, 0, Math.PI * 2);
                ictx.arc(3 + eyeDir, -10, 1.5, 0, Math.PI * 2);
                ictx.fill();
                
                // Boca
                ictx.strokeStyle = '#000';
                ictx.lineWidth = 1;
                ictx.beginPath();
                if (isHuyendo) {
                    // Boca gritando de miedo
                    ictx.arc(0, -3, 4, 0, Math.PI * 2);
                    ictx.fillStyle = '#000';
                    ictx.fill();
                } else if (isChocando) {
                    // Boca de sorpresa
                    ictx.arc(0, -3, 3, 0, Math.PI * 2);
                    ictx.stroke();
                } else {
                    // Sonrisa boba
                    ictx.arc(0, -5, 4, 0, Math.PI);
                    ictx.stroke();
                }
                
                // Pelo loco (algunos)
                if (i % 3 === 0) {
                    ictx.fillStyle = '#333';
                    for (let j = 0; j < 5; j++) {
                        ictx.beginPath();
                        ictx.moveTo(-4 + j * 2, -14);
                        ictx.lineTo(-4 + j * 2 + Math.sin(introTimer * 0.2 + j) * 3, -25);
                        ictx.lineWidth = 2;
                        ictx.strokeStyle = '#333';
                        ictx.stroke();
                    }
                }
                
                // Brazos - si huye, brazos para atr√°s
                ictx.fillStyle = '#DEB887';
                if (isHuyendo) {
                    // Brazos para atr√°s corriendo
                    ictx.fillRect(-15, 8, 5, 12);
                    ictx.fillRect(10, 10, 5, 12);
                } else {
                    ictx.fillRect(-12 + armWave, 5, 5, 15);
                    ictx.fillRect(7 - armWave, 5, 5, 15);
                }
                
                // Piernas corriendo si huye
                if (isHuyendo) {
                    const runCycle = Math.sin(introTimer * 0.4 + i) * 8;
                    ictx.fillStyle = '#8B008B';
                    ictx.fillRect(-5 + runCycle, 25, 5, 12);
                    ictx.fillRect(0 - runCycle, 25, 5, 12);
                }
                
                // Estrellitas si est√° chocando
                if (isChocando) {
                    ictx.font = 'bold 10px Arial';
                    ictx.fillText('‚òÖ', -10, -20);
                    ictx.fillText('‚òÖ', 8, -18);
                }
                
                // Gotitas de sudor si huye
                if (isHuyendo) {
                    ictx.fillStyle = '#87CEEB';
                    ictx.beginPath();
                    ictx.arc(-10, -5 + Math.sin(introTimer * 0.3) * 3, 2, 0, Math.PI * 2);
                    ictx.fill();
                }
                
                ictx.restore();
                
                // Cartel torcido (M√ÅS CARTELES) - se caen si huyen
                if (i % 2 === 0 && !isHuyendo) {
                    ictx.save();
                    ictx.translate(x, y - 40);
                    ictx.rotate(Math.sin(introTimer * 0.1 + i) * 0.2);
                    ictx.fillRect(-18, 0, 36, 18);
                    ictx.fillStyle = '#000';
                    ictx.font = 'bold 6px Arial';
                    const textos = ['LIBERTAD', 'AFUERA', 'VLLC', 'NO ZURDOS', 'MOTOSIERRA', 'DOLARIZAR'];
                    ictx.fillText(textos[i % textos.length], 0, 12);
                    ictx.restore();
                }
                
                // Carteles cayendo al piso si huyen
                if (isHuyendo && i % 2 === 0) {
                    ictx.save();
                    ictx.translate(x - 30, y + 20);
                    ictx.rotate(0.5 + i * 0.1);
                    ictx.fillRect(-15, 0, 30, 15);
                    ictx.restore();
                }
            });
            
            // CRISTINA EN EL BALC√ìN - APARECE CON FADE IN
            if (cristinaVisible > 0) {
                ictx.globalAlpha = cristinaVisible;
                
                const balconX = introCanvas.width * 0.85;
                const balconY = introCanvas.height * 0.22;
            
            // Edificio/balc√≥n m√°s grande
            ictx.fillStyle = '#8B7355';
            ictx.fillRect(balconX - 50, balconY - 30, 100, 130);
            
            // Ventana/balc√≥n
            ictx.fillStyle = '#4a4a4a';
            ictx.fillRect(balconX - 40, balconY, 80, 70);
            
            // Fondo interior m√°s claro
            ictx.fillStyle = '#5a5a5a';
            ictx.fillRect(balconX - 38, balconY + 2, 76, 50);
            
            // Barandilla
            ictx.fillStyle = '#222';
            ictx.fillRect(balconX - 42, balconY + 55, 84, 6);
            for (let i = 0; i < 7; i++) {
                ictx.fillRect(balconX - 38 + i * 12, balconY + 35, 4, 25);
            }
            
            // Cadenas gruesas
            ictx.strokeStyle = '#555';
            ictx.lineWidth = 5;
            for (let c = 0; c < 3; c++) {
                ictx.beginPath();
                ictx.moveTo(balconX - 35 + c * 5, balconY + 15);
                ictx.quadraticCurveTo(balconX - 45, balconY + 35, balconX - 40, balconY + 50);
                ictx.stroke();
                ictx.beginPath();
                ictx.moveTo(balconX + 35 - c * 5, balconY + 15);
                ictx.quadraticCurveTo(balconX + 45, balconY + 35, balconX + 40, balconY + 50);
                ictx.stroke();
            }
            
            // CRISTINA - M√ÅS GRANDE
            // Cuerpo con traje negro
            ictx.fillStyle = '#1a1a1a';
            ictx.fillRect(balconX - 15, balconY + 20, 30, 35);
            
            // Collar dorado
            ictx.beginPath();
            ictx.ellipse(balconX, balconY + 25, 12, 5, 0, 0, Math.PI);
            ictx.fill();
            
            // Cabeza m√°s grande
            ictx.fillStyle = '#DEB887';
            ictx.beginPath();
            ictx.arc(balconX, balconY + 8, 15, 0, Math.PI * 2);
            ictx.fill();
            
            // Pelo negro LARGO caracter√≠stico
            ictx.fillStyle = '#1a1a1a';
            // Parte de arriba
            ictx.beginPath();
            ictx.ellipse(balconX, balconY - 5, 16, 12, 0, Math.PI, 2 * Math.PI);
            ictx.fill();
            // Pelo a los costados largo
            ictx.beginPath();
            ictx.moveTo(balconX - 16, balconY);
            ictx.quadraticCurveTo(balconX - 20, balconY + 15, balconX - 18, balconY + 30);
            ictx.lineTo(balconX - 14, balconY + 28);
            ictx.quadraticCurveTo(balconX - 15, balconY + 10, balconX - 14, balconY + 5);
            ictx.fill();
            ictx.beginPath();
            ictx.moveTo(balconX + 16, balconY);
            ictx.quadraticCurveTo(balconX + 20, balconY + 15, balconX + 18, balconY + 30);
            ictx.lineTo(balconX + 14, balconY + 28);
            ictx.quadraticCurveTo(balconX + 15, balconY + 10, balconX + 14, balconY + 5);
            ictx.fill();
            
            // MECH√ìN BLANCO CARACTER√çSTICO
            ictx.fillStyle = '#FFFFFF';
            ictx.beginPath();
            ictx.moveTo(balconX - 8, balconY - 8);
            ictx.quadraticCurveTo(balconX - 14, balconY - 15, balconX - 6, balconY - 12);
            ictx.quadraticCurveTo(balconX - 4, balconY - 5, balconX - 8, balconY - 8);
            ictx.fill();
            // M√°s mech√≥n
            ictx.beginPath();
            ictx.moveTo(balconX - 5, balconY - 6);
            ictx.quadraticCurveTo(balconX - 10, balconY - 12, balconX - 3, balconY - 10);
            ictx.fill();
            
            // Cejas
            ictx.fillStyle = '#1a1a1a';
            ictx.beginPath();
            ictx.ellipse(balconX - 6, balconY + 2, 5, 2, -0.1, 0, Math.PI * 2);
            ictx.ellipse(balconX + 6, balconY + 2, 5, 2, 0.1, 0, Math.PI * 2);
            ictx.fill();
            
            // Ojos
            ictx.fillStyle = '#fff';
            ictx.beginPath();
            ictx.ellipse(balconX - 6, balconY + 7, 4, 5, 0, 0, Math.PI * 2);
            ictx.ellipse(balconX + 6, balconY + 7, 4, 5, 0, 0, Math.PI * 2);
            ictx.fill();
            ictx.fillStyle = '#3d2314';
            ictx.beginPath();
            ictx.arc(balconX - 6, balconY + 7, 2.5, 0, Math.PI * 2);
            ictx.arc(balconX + 6, balconY + 7, 2.5, 0, Math.PI * 2);
            ictx.fill();
            
            // Labios rojos
            ictx.fillStyle = '#C71585';
            ictx.beginPath();
            ictx.ellipse(balconX, balconY + 15, 5, 2.5, 0, 0, Math.PI * 2);
            ictx.fill();
            
            // Mano haciendo V pidiendo ayuda - M√ÅS VISIBLE
            ictx.fillStyle = '#DEB887';
            const handWave = Math.sin(introTimer * 0.1) * 4;
            // Brazo
            ictx.fillRect(balconX + 15, balconY + 10, 8, 20);
            // Mano
            ictx.beginPath();
            ictx.arc(balconX + 25, balconY + 5 + handWave, 7, 0, Math.PI * 2);
            ictx.fill();
            // Dedos en V grandes
            ictx.fillRect(balconX + 20, balconY - 15 + handWave, 5, 18);
            ictx.fillRect(balconX + 27, balconY - 15 + handWave, 5, 18);
            
            // Texto "¬°AYUDA!" m√°s grande
            if (introPhase >= 4) {
                ictx.fillStyle = '#FF0000';
                ictx.font = 'bold 14px Bangers';
                ictx.textAlign = 'center';
                const helpOpacity = (Math.sin(introTimer * 0.08) + 1) / 2;
                ictx.globalAlpha = cristinaVisible * helpOpacity;
                ictx.fillText('¬°AYUDA!', balconX, balconY - 35);
            }
            
            ictx.globalAlpha = 1;
            } // Fin del bloque cristinaVisible
            
            // MILEI CON PA√ëAL - SIEMPRE VISIBLE, HUYE √öLTIMO
            const mileiHuyendo = cristinaVisible > 0.6; // Empieza a huir DESPU√âS que los dem√°s
            let mileiX = introCanvas.width * 0.6;
            const mileiY = introCanvas.height * 0.58;
            
            // Si huye, se mueve MUY LENTO (le cuesta por los pa√±ales)
            if (mileiHuyendo) {
                // Movimiento trabado, como arrastr√°ndose
                const avance = (cristinaVisible - 0.6) * 150; // Mucho m√°s lento
                const tambaleo = Math.sin(introTimer * 0.3) * 3; // Se tambalea
                mileiX = introCanvas.width * 0.6 + avance + tambaleo;
            }
            
            // No dibujar si se fue de la pantalla
            if (mileiX < introCanvas.width + 50) {
            
            ictx.save();
            if (mileiHuyendo) {
                ictx.translate(mileiX, mileiY);
                // Se tambalea de lado a lado
                const wobble = Math.sin(introTimer * 0.2) * 0.1;
                ictx.rotate(wobble);
                ictx.translate(-mileiX, -mileiY);
            }
            
            // PA√ëAL GIGANTE Y CARGADO (m√°s grande si huye)
            ictx.fillStyle = '#FFFFFF';
            ictx.beginPath();
            const panalSize = mileiHuyendo ? 1.3 : 1; // Pa√±al m√°s grande/cargado si huye
            ictx.moveTo(mileiX - 15 * panalSize, mileiY + 18);
            ictx.quadraticCurveTo(mileiX, mileiY + 50 * panalSize, mileiX + 15 * panalSize, mileiY + 18);
            ictx.lineTo(mileiX + 12, mileiY + 10);
            ictx.lineTo(mileiX - 12, mileiY + 10);
            ictx.closePath();
            ictx.fill();
            // Borde del pa√±al
            ictx.strokeStyle = '#DDD';
            ictx.lineWidth = 2;
            ictx.stroke();
            // Cintitas celestes del pa√±al
            ictx.fillStyle = '#87CEEB';
            ictx.fillRect(mileiX - 14, mileiY + 12, 8, 4);
            ictx.fillRect(mileiX + 6, mileiY + 12, 8, 4);
            
            // Manchita marr√≥n si huye (se cag√≥)
            if (mileiHuyendo) {
                ictx.fillStyle = '#8B4513';
                ictx.beginPath();
                ictx.ellipse(mileiX, mileiY + 38, 8, 5, 0, 0, Math.PI * 2);
                ictx.fill();
            }
            
            // Cuerpo (campera negra, m√°s corta para mostrar pa√±al)
            ictx.fillStyle = '#1a1a1a';
            ictx.fillRect(mileiX - 12, mileiY - 5, 24, 20);
            
            // Piernas (caminando trabado si huye - el pa√±al le molesta)
            if (mileiHuyendo) {
                // Piernas separadas y movimiento torpe
                const runCycle = Math.sin(introTimer * 0.25) * 5; // M√°s lento
                ictx.fillStyle = '#DEB887';
                // Piernas muy separadas por el pa√±al
                ictx.fillRect(mileiX - 12 + runCycle, mileiY + 40, 6, 12);
                ictx.fillRect(mileiX + 6 - runCycle, mileiY + 40, 6, 12);
            } else {
                ictx.fillStyle = '#1a1a1a';
                ictx.fillRect(mileiX - 8, mileiY + 35, 6, 15);
                ictx.fillRect(mileiX + 2, mileiY + 35, 6, 15);
            }
            
            // Cabeza
            ictx.fillStyle = '#DEB887';
            ictx.beginPath();
            ictx.arc(mileiX, mileiY - 12, 14, 0, Math.PI * 2);
            ictx.fill();
            
            // Peluca loca (m√°s loca si huye)
            ictx.fillStyle = '#333';
            for (let i = -4; i <= 4; i++) {
                const sway = Math.sin(introTimer * 0.15 + i) * (mileiHuyendo ? 10 : 5);
                ictx.beginPath();
                ictx.moveTo(mileiX + i * 3, mileiY - 22);
                ictx.lineTo(mileiX + i * 4 + sway, mileiY - 40);
                ictx.lineWidth = 3;
                ictx.strokeStyle = '#333';
                ictx.stroke();
            }
            
            // Patillas
            ictx.fillStyle = '#333';
            ictx.fillRect(mileiX - 16, mileiY - 18, 5, 15);
            ictx.fillRect(mileiX + 11, mileiY - 18, 5, 15);
            
            // Ojos (de p√°nico si huye)
            ictx.fillStyle = '#fff';
            ictx.beginPath();
            if (mileiHuyendo) {
                // Ojos enormes de p√°nico
                ictx.arc(mileiX - 5, mileiY - 14, 6, 0, Math.PI * 2);
                ictx.arc(mileiX + 5, mileiY - 14, 6, 0, Math.PI * 2);
            } else {
                ictx.arc(mileiX - 5, mileiY - 14, 4, 0, Math.PI * 2);
                ictx.arc(mileiX + 5, mileiY - 14, 4, 0, Math.PI * 2);
            }
            ictx.fill();
            ictx.fillStyle = '#000';
            ictx.beginPath();
            if (mileiHuyendo) {
                // Pupilas chiquitas de miedo
                ictx.arc(mileiX - 5, mileiY - 14, 2, 0, Math.PI * 2);
                ictx.arc(mileiX + 5, mileiY - 14, 2, 0, Math.PI * 2);
            } else {
                ictx.arc(mileiX - 5 + Math.sin(introTimer * 0.2) * 2, mileiY - 14, 2, 0, Math.PI * 2);
                ictx.arc(mileiX + 5 + Math.sin(introTimer * 0.2) * 2, mileiY - 14, 2, 0, Math.PI * 2);
            }
            ictx.fill();
            
            // Boca (gritando de miedo si huye)
            ictx.fillStyle = '#8B0000';
            ictx.beginPath();
            if (mileiHuyendo) {
                // Boca abierta gritando
                ictx.ellipse(mileiX, mileiY - 2, 8, 6, 0, 0, Math.PI * 2);
            } else {
                ictx.ellipse(mileiX, mileiY - 3, 6, 4, 0, 0, Math.PI);
            }
            ictx.fill();
            
            // L√°grimas si huye
            if (mileiHuyendo) {
                ictx.fillStyle = '#87CEEB';
                ictx.beginPath();
                ictx.ellipse(mileiX - 12, mileiY - 8 + Math.sin(introTimer * 0.3) * 3, 3, 5, 0.3, 0, Math.PI * 2);
                ictx.ellipse(mileiX + 12, mileiY - 10 + Math.sin(introTimer * 0.3 + 1) * 3, 3, 5, -0.3, 0, Math.PI * 2);
                ictx.fill();
            }
            
            // Motosierra (se le cae si huye)
            if (!mileiHuyendo) {
                const sawAngle = Math.sin(introTimer * 0.3) * 0.2;
                ictx.save();
                ictx.translate(mileiX + 25, mileiY + 10);
                ictx.rotate(sawAngle);
                ictx.fillStyle = '#FF4500';
                ictx.fillRect(-5, -8, 10, 25);
                ictx.fillStyle = '#C0C0C0';
                ictx.fillRect(-3, -25, 6, 20);
                ictx.restore();
            } else {
                // Motosierra tirada en el piso
                ictx.save();
                ictx.translate(introCanvas.width * 0.55, mileiY + 45);
                ictx.rotate(0.8);
                ictx.fillStyle = '#FF4500';
                ictx.fillRect(-5, -8, 10, 25);
                ictx.fillStyle = '#C0C0C0';
                ictx.fillRect(-3, -25, 6, 20);
                ictx.restore();
            }
            
            // Gotitas de sudor si huye
            if (mileiHuyendo) {
                ictx.fillStyle = '#87CEEB';
                for (let g = 0; g < 3; g++) {
                    ictx.beginPath();
                    ictx.arc(mileiX - 20 - g * 8, mileiY - 5 + Math.sin(introTimer * 0.2 + g) * 5, 3, 0, Math.PI * 2);
                    ictx.fill();
                }
            }
            
            // Texto "MAM√Å!" si huye
            if (mileiHuyendo) {
                ictx.fillStyle = '#FF0000';
                ictx.font = 'bold 12px Arial';
                ictx.textAlign = 'center';
                ictx.fillText('¬°MAM√Å!', mileiX, mileiY - 50);
            }
            
            ictx.restore();
            } // Fin del if mileiX < introCanvas.width
        }
        
        function drawIntroText(text, y, size, color) {
            ictx.font = `bold ${size}px Bangers`;
            ictx.textAlign = 'center';
            ictx.globalAlpha = textOpacity;
            // Sombra negra para mejor legibilidad
            ictx.fillStyle = '#000';
            ictx.fillText(text, introCanvas.width / 2 + 2, y + 2);
            ictx.fillText(text, introCanvas.width / 2 - 2, y + 2);
            ictx.fillText(text, introCanvas.width / 2 + 2, y - 2);
            ictx.fillText(text, introCanvas.width / 2 - 2, y - 2);
            // Texto principal
            ictx.fillStyle = color || '#FFD700';
            ictx.fillText(text, introCanvas.width / 2, y);
            ictx.globalAlpha = 1;
        }
        
        function runIntro() {
            if (!introRunning) return;
            
            introTimer++;
            
            // Limpiar
            ictx.fillStyle = '#1a1a2e';
            ictx.fillRect(0, 0, introCanvas.width, introCanvas.height);
            
            // Cielo degradado
            const skyGradient = ictx.createLinearGradient(0, 0, 0, introCanvas.height * 0.6);
            
            if (introPhase === 0) {
                // Fase 1: Amanecer - BIEN LARGO
                skyGradient.addColorStop(0, '#1a1a2e');
                skyGradient.addColorStop(0.5, '#FF6B35');
                skyGradient.addColorStop(1, '#FFD700');
                sunY = Math.max(sunY - 0.15, introCanvas.height * 0.25);
                textOpacity = Math.min(textOpacity + 0.008, 1);
                
                if (introTimer > 350) {
                    introPhase = 1;
                    textOpacity = 0;
                }
            } else if (introPhase === 1) {
                // Fase 2: TUCU-MAN llega en bici
                skyGradient.addColorStop(0, '#87CEEB');
                skyGradient.addColorStop(1, '#FFD700');
                bikeX = Math.min(bikeX + 0.8, introCanvas.width * 0.25);
                textOpacity = Math.min(textOpacity + 0.008, 1);
                
                if (introTimer > 750) {
                    introPhase = 2;
                    textOpacity = 0;
                }
            } else if (introPhase === 2) {
                // Fase 3: Ve a los libertarios manifestando (SIN CRISTINA A√öN)
                skyGradient.addColorStop(0, '#87CEEB');
                skyGradient.addColorStop(1, '#FFD700');
                textOpacity = Math.min(textOpacity + 0.008, 1);
                
                if (introTimer > 1200) {
                    introPhase = 3;
                    textOpacity = 0;
                }
            } else if (introPhase === 3) {
                // Fase 4: TUCU-MAN baja de la bici
                skyGradient.addColorStop(0, '#87CEEB');
                skyGradient.addColorStop(1, '#FFD700');
                textOpacity = Math.min(textOpacity + 0.01, 1);
                tucumanBajado = true;
                
                if (introTimer > 1550) {
                    introPhase = 4;
                    textOpacity = 0;
                }
            } else if (introPhase === 4) {
                // Fase 5: Mira al cielo - APARECE CRISTINA
                skyGradient.addColorStop(0, '#87CEEB');
                skyGradient.addColorStop(1, '#FFD700');
                textOpacity = Math.min(textOpacity + 0.01, 1);
                tucumanMirandoArriba = true;
                cristinaVisible = Math.min((cristinaVisible || 0) + 0.02, 1);
                
                if (introTimer > 2000) {
                    introPhase = 5;
                    textOpacity = 0;
                }
            } else if (introPhase === 5) {
                // Fase 6: T√≠tulo final
                skyGradient.addColorStop(0, '#1a1a2e');
                skyGradient.addColorStop(1, '#4B0082');
                textOpacity = Math.min(textOpacity + 0.006, 1);
                cristinaVisible = 1;
                
                if (introTimer > 2500) {
                    skipIntro();
                    return;
                }
            }
            
            ictx.fillStyle = skyGradient;
            ictx.fillRect(0, 0, introCanvas.width, introCanvas.height * 0.6);
            
            // Piso
            ictx.fillStyle = '#228B22';
            ictx.fillRect(0, introCanvas.height * 0.6, introCanvas.width, introCanvas.height * 0.4);
            
            // Camino
            ictx.fillStyle = '#8B4513';
            ictx.fillRect(0, introCanvas.height * 0.7, introCanvas.width, 30);
            
            // Dibujar elementos seg√∫n fase
            drawIntroMountains();
            drawIntroSun();
            
            if (introPhase >= 1) {
                drawIntroTucuman();
            }
            
            if (introPhase >= 2) {
                drawIntroLibertarios();
            }
            
            // Textos seg√∫n fase
            if (introPhase === 0) {
                drawIntroText('Tucum√°n, 2026...', introCanvas.height * 0.15, 28, '#FFD700');
            } else if (introPhase === 1) {
                drawIntroText('Un h√©roe se acerca...', introCanvas.height * 0.12, 24, '#fff');
            } else if (introPhase === 2) {
                drawIntroText('Un grupo de hijos de primos', introCanvas.height * 0.10, 20, '#FF4444');
                drawIntroText('y hermanos manifiestan...', introCanvas.height * 0.15, 20, '#FF4444');
                drawIntroText('"¬°VIVA LA LIBERTAD!"', introCanvas.height * 0.88, 16, '#8B008B');
            } else if (introPhase === 3) {
                drawIntroText('TUCU-MAN baja de su bici...', introCanvas.height * 0.12, 22, '#fff');
            } else if (introPhase === 4) {
                drawIntroText('Mira al cielo y ve...', introCanvas.height * 0.10, 26, '#FFFFFF');
                drawIntroText('¬°CRISTINA PRESA!', introCanvas.height * 0.17, 32, '#FF4444');
                drawIntroText('"La liberaci√≥n se acerca,', introCanvas.height * 0.80, 22, '#FFD700');
                drawIntroText('mi querida Jefa"', introCanvas.height * 0.86, 22, '#FFD700');
            } else if (introPhase === 5) {
                drawIntroText('ü¶∏ TUCU-MAN ü¶∏', introCanvas.height * 0.35, 48, '#FFD700');
                drawIntroText('¬°LIBERAR A CRISTINA!', introCanvas.height * 0.5, 28, '#75AADB');
                drawIntroText('‚õìÔ∏è ‚úåÔ∏è ‚õìÔ∏è', introCanvas.height * 0.62, 36, '#fff');
            }
            
            requestAnimationFrame(runIntro);
        }
        
        function skipIntro() {
            introRunning = false;
            document.getElementById('introScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
        }
        
        // Mostrar men√∫ directo (intro desactivada)
        document.getElementById('introScreen').classList.add('hidden');
        document.getElementById('startScreen').classList.remove('hidden');
    </script>
</body>
</html>
